(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{1017:function(e,t,a){},1018:function(e,t,a){},1025:function(e,t,a){},1029:function(e,t){},1031:function(e,t){},1032:function(e,t){},1033:function(e,t){},1034:function(e,t){},1062:function(e,t,a){},1076:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(49),i=a.n(s),o=(a(655),a(45)),c=a(43),l=a(70),u=a(69),d=(a(435),a(245)),h=(a(436),a(341)),m=(a(437),a(128)),p=(a(361),a(164)),f=(a(660),a(188)),v=(a(438),a(347)),g=(a(664),a(143)),y=(a(440),a(101)),b=(a(441),a(348)),k=(a(439),a(239)),D=a(163),E=a(94),S=a(139),w=a(44),C=(a(547),a(206)),O=a(73),_=a(327),M=a(140),j=a.n(M),V=a(203),A=a.n(V),I=a(50);var x,N,T=function(e){var t=e.series,a=e.lineGenerator,n=e.xScale,s=e.yScale;return t.map((function(e){var t=e.id,i=e.data,o=e.color,c=e.predicted,l=e.distancing,u={strokeWidth:3};return c&&(u.strokeDasharray=l?"6, 4":"2, 6"),r.a.createElement("path",{key:t,d:a(i.map((function(e){return{x:n(e.data.x),y:s(e.data.y)}}))),fill:"none",stroke:o,style:u})}))},R={axis:{ticks:{text:{fontSize:16}},legend:{text:{fontSize:16}}},legends:{text:{fontSize:14}}},P=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={width:0,height:0},n.updateWindowDimensions=n.updateWindowDimensions.bind(Object(w.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"updateWindowDimensions",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"parseDate",value:function(e){var t=e.split("-").map(Number),a=Object(O.a)(t,3),n=a[0],r=a[1],s=a[2];return new Date(n,r-=1,s)}},{key:"getCumulativeData",value:function(e){var t=this;return e.map((function(e){return{x:t.parseDate(e.date),y:e.value}}))}},{key:"getDeltaData",value:function(e,t){var a=this;return e.map((function(n,r){return 0===r?{x:a.parseDate(n.date),y:n.value-t}:{x:a.parseDate(n.date),y:n.value-e[r-1].value}}))}},{key:"processData",value:function(e,t){var a=t.statistic,n=t.yScale,r=t.initialVal,s="delta"===a?this.getDeltaData(e,r):this.getCumulativeData(e);return"log"===n&&(s=s.filter((function(e){e.x;return e.y>0}))),s}},{key:"getDataMax",value:function(){var e=this.props.data,t=0;return Object.keys(e).forEach((function(a){var n=e[a],r=n.observed,s=n.predictions;t=Math.max(t,Math.max.apply(Math,Object(S.a)(r.map((function(e){return e.value}))))),s.forEach((function(e){var a=e.time_series;t=Math.max(t,Math.max.apply(Math,Object(S.a)(a.map((function(e){return e.value})))))}))})),t}},{key:"getYAxisProps",value:function(){for(var e=this.props,t=e.statistic,a=e.yScale,n={format:function(e){return A()(e).format("0.[0]a")},orient:"left",tickSize:5,tickPadding:5,tickRotation:0,legend:"delta"===t?"New Cases":"Cumulative Cases",legendOffset:-60,legendPosition:"middle"},r=[],s=0;s<=Math.ceil(Math.log10(this.getDataMax()));s++)r.push(Math.pow(10,s));var i=Object(E.a)(Object(E.a)({},n),{},{tickValues:r});return"log"===a?{axisLeft:i,gridYValues:r,yScale:{type:"log",base:10,min:Math.min.apply(Math,r),max:Math.max.apply(Math,r)}}:{axisLeft:n,yScale:{type:"linear",min:"auto",max:"auto"}}}},{key:"render",value:function(){var e=this,t=this.props.data,a=this.props,n=a.statistic,s=a.yScale,i=a.dataType,o=[],c=[];Object.keys(t).sort().forEach((function(a,r){var l=function(e){var t=[I.red,I.gold,I.green,I.blue,I.volcano,I.yellow,I.cyan,I.purple,I.orange,I.lime,I.geekblue,I.magenta];return t[e%t.length]}(r),u=t[a].observed,d=t[a].observed_deaths;i.includes("confirmed")&&(o.push({id:a,data:e.processData(u,{statistic:n,yScale:s,initialVal:0}),predicted:!1}),c.push(l[4])),i.includes("death")&&(o.push({id:"".concat(a," death"),data:e.processData(d,{statistic:n,yScale:s,initialVal:0}),predicted:!1}),c.push(l[6])),t[a].predictions.filter((function(e){return e.time_series.length>0})).forEach((function(t,r){var h=t.model.name,m="SI-kJalpha"!==h.substring(0,10)||h.includes("death prediction"),p=t.distancing,f=t.time_series,v=[];if(i.includes("death")&&m)v=[d[d.length-1]].concat(f);else{if(!i.includes("confirmed")||m)return;v=[u[u.length-1]].concat(f)}o.push({id:"".concat(a," (").concat(h,", ").concat(p,")"),data:e.processData(v,{statistic:n,yScale:s,initialVal:m?d[d.length-2].value:u[u.length-2].value}),predicted:!0,distancing:p}),r<=4?c.push(l[4+r]):r<=8?c.push(l[8-r]):c.push(l[r%10])}))}));if(o.length>0){var l=o[0].data[0].x,u=o[0].data[0].x;o.forEach((function(e){e.data.forEach((function(e){var t=e.x;l=Math.min(l,t),u=Math.max(u,t)}))})),l=j()(l),(u=j()(u)).diff(l,"days")>15&&"every month"}var d=1+this.state.width/300;return r.a.createElement(_.a,Object.assign({data:o,colors:c,margin:{top:10,right:50,bottom:70,left:100},xScale:{type:"time",format:"native",precision:"day"},axisBottom:{tickValues:d,format:function(e){return j()(e).format("M/D")},orient:"bottom",tickSize:5,tickPadding:5,tickRotation:0,legend:"Date",legendOffset:36,legendPosition:"middle"}},this.getYAxisProps(),{enableSlices:"x",sliceTooltip:function(e){var t=e.slice;return r.a.createElement("div",{style:{background:"white",padding:"9px 12px",border:"1px solid #ccc"}},r.a.createElement("div",null,j()(t.points[0].data.x).format("MMM Do YYYY")),t.points.map((function(e){return r.a.createElement("div",{key:e.id,style:{color:e.serieColor,padding:"3px 0"}},r.a.createElement("strong",null,e.serieId),"[",A()(e.data.yFormatted).format("0.[0]a"),"]")})))},pointSize:0,pointLabel:"y",pointLabelYOffset:-12,legends:[{anchor:"top-left",direction:"column",justify:!1,translateX:0,translateY:0,itemsSpacing:0,itemDirection:"left-to-right",itemWidth:80,itemHeight:20,itemOpacity:.75,symbolSize:12,symbolShape:"circle",symbolBorderColor:"rgba(0, 0, 0, .5)",effects:[{on:"hover",style:{itemBackground:"rgba(0, 0, 0, .03)",itemOpacity:1}}]}],layers:["grid","markers","areas","crosshair",T,"slices","points","axes","legends"],theme:R}))}}]),a}(n.Component),W=a(1127),L=a(1128),B=a(1129),F=a(1130),G=a(1131),z=a(1123),H=a(84),U=a.n(H),K="https://dslab-covid19-backend.herokuapp.com/api",Y=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,[{key:"affected_by",value:function(e){}},{key:"areas",value:function(e){var t="".concat(K,"/areas");U.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"models",value:function(e){var t="".concat(K,"/models");U.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"infection_models",value:function(e){var t="".concat(K,"/infection_models");U.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"death_models",value:function(e){var t="".concat(K,"/death_models");U.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"cumulative_infections",value:function(e){var t="".concat(K,"/cumulative_infections");U.a.get(t).then((function(t){return e(t.data)}))}},{key:"predict_all",value:function(e,t){var a="".concat(K,"/predict_all");U.a.get(a,{params:e}).then((function(e){return t(e.data)}))}},{key:"predict",value:function(e,t){var a="".concat(K,"/predict");U.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"getCurrentDate",value:function(e){var t="".concat(K,"/current_date");U.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"checkHistory",value:function(e,t){var a="".concat(K,"/check_history");U.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"history_cumulative",value:function(e,t){var a="".concat(K,"/history_cumulative");U.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"scores_all",value:function(e,t){var a="".concat(K,"/scores_all");U.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"scores",value:function(e,t){var a="".concat(K,"/scores");U.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"latest_score_date",value:function(e){var t="".concat(K,"/latest_score_date");U.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"cumulative_death",value:function(e,t){var a="".concat(K,"/cumulative_death");U.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"all_mrf_scores",value:function(e,t){var a="".concat(K,"/all_mrf_scores");U.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"real_time",value:function(e){U.a.get("https://api.covid19api.com/summary").then((function(t){var a=t.data.Global.TotalConfirmed,n=t.data.Global.TotalDeaths;e({totalConfirmed:a,totalDeaths:n})}))}}]),e}(),J=(a(808),a(554)),X=a.n(J),q=a(555),Q=a.n(q),Z=a(556),$=a.n(Z);function ee(e,t){$.a.parse(e,{download:!0,dynamicTyping:!0,complete:function(e){t(e.data)}})}function te(e,t){return t=e/t,Math.round(t)}function ae(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}ee(X.a,(function(e){x=e})),ee(Q.a,(function(e){N=e}));var ne=function(e){var t=e.caseKey,a=e.deathKey,n=e.data,s=e.center,i=e.caseRadius,o=e.deathRadius,c=e.caseValue,l=e.deathValue,u=e.population,d=e.color,h=e.caseOpacity,m=e.deathOpacity,p=(e.stroke,e.onClick);return r.a.createElement(W.a,{key:a,data:n,center:s,radius:o,fillColor:"black",fillOpacity:m,stroke:!1,onClick:p},r.a.createElement(W.a,{key:t,data:n,center:s,radius:i,color:"white",weight:1.5,fillColor:d,fillOpacity:h,stroke:!0,onClick:p},r.a.createElement(L.a,{direction:"right",opacity:1,sticky:!0},r.a.createElement("b",null,r.a.createElement("span",null,n)),r.a.createElement("br",null),r.a.createElement("span",null,"Cases: "+ae(c)+" (1 in "+ae(te(u,c))+")"),r.a.createElement("br",null),r.a.createElement("span",null,"Deaths: "+ae(l)+" (1 in "+ae(te(u,l))+")"),r.a.createElement("br",null))),r.a.createElement(L.a,{direction:"right",opacity:1,sticky:!0},r.a.createElement("b",null,r.a.createElement("span",null,n)),r.a.createElement("br",null),r.a.createElement("span",null,"Cases: "+ae(c)+" (1 in "+ae(te(u,c))+")"),r.a.createElement("br",null),r.a.createElement("span",null,"Deaths: "+ae(l)+" (1 in "+ae(te(u,l))+")"),r.a.createElement("br",null)))},re=function(e){var t=e.markers.map((function(e){var t=Object.assign({},e);return r.a.createElement(ne,t)}));return r.a.createElement(n.Fragment,null,t)},se=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).modelAPI=new Y,e.state={areasList:[],worldCases:[],worldDeaths:[],markers:[],stateMarkers:[],countyMarkers:[],renderStateCountyMarkers:[],us:[],renderUS:[],callbackCounter:0,mapInitialized:!1},e.modelAPI.areas((function(t){return e.setState({areasList:t})})),e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.triggerRef(this),this.fetchData(this.props.dynamicMapOn)}},{key:"setCaseDeathData",value:function(){var e=this;if(this.state.callbackCounter>1){if(this.setState({callbackCounter:0}),this.state.mapInitialized){var t=!1,a=0,n=this.state.markers,r=this.state.stateMarkers,s=this.state.us;for(u=0;u<x.length;u++){var i=this.state.caseData[u].caseValueTrue,o=this.state.deathData[u].deathValueTrue,c=.5;0===i&&(c=0);var l=1;0===o&&(l=0),u<184?155===u?(t=!0,s[0].caseRadius=3*this.getRadius(i),s[0].caseValue=i,s[0].color=this.getColor(i),s[0].caseOpacity=c,s[0].deathRadius=.75*this.getRadius(o),s[0].deathValue=o,s[0].deathOpacity=l):t?(n[u-1].caseRadius=3*this.getRadius(i),n[u-1].caseValue=i,n[u-1].color=this.getColor(i),n[u-1].caseOpacity=c,n[u-1].deathRadius=.75*this.getRadius(o),n[u-1].deathValue=o,n[u-1].deathOpacity=l):(n[u].caseRadius=3*this.getRadius(i),n[u].caseValue=i,n[u].color=this.getColor(i),n[u].caseOpacity=c,n[u].deathRadius=.75*this.getRadius(o),n[u].deathValue=o,n[u].deathOpacity=l):(r[a].caseRadius=3*this.getRadius(i),r[a].caseValue=i,r[a].color=this.getColor(i),r[a].caseOpacity=c,r[a].deathRadius=.75*this.getRadius(o),r[a].deathValue=o,r[a].deathOpacity=l,a++)}this.setState({markers:n,stateMarkers:r,us:s})}else{if(this.setState({mapInitialized:!0}),"undefined"!=typeof this.state.caseData&&"undefined"!=typeof this.state.deathData){for(var u=0;u<x.length;u++){var d=this.state.caseData[u],h=this.state.deathData[u],m=.5;0===d.valueTrue&&(m=0);var p=1;if(0===h.valueTrue&&(p=0),u<184)"US "===this.state.areasList[u].country+" "?(this.state.us.push({key:d.name,caseKey:d.name+"-cases",deathKey:d.name+"-deaths",data:d.name,center:[x[u][1],x[u][2]],caseRadius:3*this.getRadius(d.caseValueTrue),deathRadius:.75*this.getRadius(h.deathValueTrue),caseValue:d.caseValueTrue,deathValue:h.deathValueTrue,population:N[u][0],color:this.getColor(d.caseValueTrue),caseOpacity:m,deathOpacity:p,stroke:!0,onClick:function(t){return e.handleMapClick(t)}}),this.state.renderUS.push(this.state.us[0])):this.state.markers.push({key:d.name,caseKey:d.name+"-cases",deathKey:d.name+"-deaths",data:d.name,center:[x[u][1],x[u][2]],caseRadius:3*this.getRadius(d.caseValueTrue),deathRadius:.75*this.getRadius(h.deathValueTrue),caseValue:d.caseValueTrue,deathValue:h.deathValueTrue,population:N[u][0],color:this.getColor(d.caseValueTrue),caseOpacity:m,deathOpacity:p,stroke:!0,onClick:function(t){return e.handleMapClick(t)}});else this.state.stateMarkers.push({key:d.id,caseKey:d.state+"-cases",deathKey:d.state+"-deaths",data:d.name+" / "+d.state,center:[x[u][1],x[u][2]],caseRadius:3*this.getRadius(d.caseValueTrue),deathRadius:.75*this.getRadius(h.deathValueTrue),caseValue:d.caseValueTrue,deathValue:h.deathValueTrue,population:N[u][0],color:this.getColor(d.caseValueTrue),display:"none",caseOpacity:m,deathOpacity:p,stroke:!0,onClick:function(t){return e.handleMapClick(t)}})}var f=this.state.markers,v=this.state.stateMarkers,g=this.state.us;this.setState({markers:f,stateMarkers:v,us:g})}}}}},{key:"getCaseDeathData",value:function(){var e=this;this.modelAPI.cumulative_infections((function(t){var a=t.map((function(e){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,area:e.area,caseValue:Math.log(e.max_percentage),caseValueTrue:e.value}})),n=e.state.callbackCounter;n++,e.setState({caseData:a,callbackCounter:n},e.setCaseDeathData)})),this.modelAPI.cumulative_death({days:0},(function(t){var a=t.map((function(e){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,area:e.area,deathValue:Math.log(e.max_percentage),deathValueTrue:e.value}})),n=e.state.callbackCounter;n++,e.setState({deathData:a,callbackCounter:n},e.setCaseDeathData)}))}},{key:"predictCaseDeathData",value:function(){var e=this;this.modelAPI.predict_all({days:this.props.days,model:this.props.confirmed_model},(function(t){var a=t.map((function(e){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,area:e.area,caseValue:Math.log(e.max_val_percentage),caseValueTrue:e.value}})),n=e.state.callbackCounter;n++,e.setState({caseData:a,callbackCounter:n},e.setCaseDeathData)})),this.modelAPI.predict_all({days:this.props.days,model:this.props.death_model},(function(t){var a=t.map((function(e){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,area:e.area,deathValue:Math.log(e.max_death_percentage),deathValueTrue:e.value}})),n=e.state.callbackCounter;n++,e.setState({deathData:a,callbackCounter:n},e.setCaseDeathData)}))}},{key:"getHistoryCumulative",value:function(){var e=this;this.modelAPI.history_cumulative({days:this.props.days},(function(t){var a=t.map((function(e){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,area:e.area,caseValue:Math.log(e.max_val_percentage),caseValueTrue:e.value,deathValue:Math.log(e.max_death_percentage),deathValueTrue:e.deathValue}})),n=a,r=e.state.callbackCounter;r+=2,e.setState({caseData:a,deathData:n,callbackCounter:r},e.setCaseDeathData)}))}},{key:"newCases",value:function(){var e=this;this.props.days>0?(this.modelAPI.predict_all({days:this.props.days,model:this.props.confirmed_model},(function(t){e.props.days>7?e.modelAPI.predict_all({days:e.props.days-7,model:e.props.confirmed_model},(function(a){var n=t.map((function(e,t){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,area:e.area,caseValue:e.value-a[t].value>0?Math.log(e.value-a[t].value):0,caseValueTrue:e.value-a[t].value>0?e.value-a[t].value:0}})),r=e.state.callbackCounter;r++,e.setState({caseData:n,callbackCounter:r},e.setCaseDeathData)})):e.modelAPI.history_cumulative({days:e.props.days-7},(function(a){var n=t.map((function(e,t){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,area:e.area,caseValue:e.value-a.find((function(t){return t.area.iso_2===e.area.iso_2})).value>0?Math.log(e.value-a.find((function(t){return t.area.iso_2===e.area.iso_2})).value):0,caseValueTrue:e.value-a.find((function(t){return t.area.iso_2===e.area.iso_2})).value>0?e.value-a.find((function(t){return t.area.iso_2===e.area.iso_2})).value:0}})),r=e.state.callbackCounter;r++,e.setState({caseData:n,callbackCounter:r},e.setCaseDeathData)}))})),this.modelAPI.predict_all({days:this.props.days,model:this.props.death_model},(function(t){e.props.days>7?e.modelAPI.predict_all({days:e.props.days-7,model:e.props.death_model},(function(a){var n=t.map((function(e,t){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,deathValue:e.value-a[t].value>0?Math.log(e.value-a[t].value):0,deathValueTrue:e.value-a[t].value>0?e.value-a[t].value:0}})),r=e.state.callbackCounter;r++,e.setState({deathData:n,callbackCounter:r},e.setCaseDeathData)})):e.modelAPI.history_cumulative({days:e.props.days-7},(function(a){var n=t.map((function(e,t){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,deathValue:e.deathValue-a.find((function(t){return t.area.iso_2===e.area.iso_2})).deathValue>0?Math.log(e.deathValue-a.find((function(t){return t.area.iso_2===e.area.iso_2})).deathValue):0,deathValueTrue:e.deathValue-a.find((function(t){return t.area.iso_2===e.area.iso_2})).deathValue>0?e.deathValue-a.find((function(t){return t.area.iso_2===e.area.iso_2})).deathValue:0}})),r=e.state.callbackCounter;r++,e.setState({deathData:n,callbackCounter:r},e.setCaseDeathData)}))}))):this.modelAPI.history_cumulative({days:this.props.days},(function(t){e.modelAPI.history_cumulative({days:e.props.days-7},(function(a){var n=t.map((function(e,t){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,caseValue:e.value-a[t].value>0?Math.log(e.value-a[t].value):0,caseValueTrue:e.value-a[t].value>0?e.value-a[t].value:0,deathValue:e.deathValue-a[t].deathValue>0?Math.log(e.deathValue-a[t].deathValue):0,deathValueTrue:e.deathValue-a[t].deathValue>0?e.deathValue-a[t].deathValue:0}})),r=n,s=e.state.callbackCounter;s+=2,e.setState({caseData:n,deathData:r,callbackCounter:s},e.setCaseDeathData)}))}))}},{key:"fetchData",value:function(e){!e||""===this.props.confirmed_model&&""===this.props.death_model?this.getCaseDeathData():"cumulative"===this.props.statistic?this.props.days>0?this.predictCaseDeathData():this.getHistoryCumulative():this.newCases()}},{key:"handleMapClick",value:function(e){var t=this.props,a=t.onMapClick,n=t.onNoData,r=e.target.options.data;r?a(r):n(r)}},{key:"getRadius",value:function(e){if(0===e)return e;var t=Math.log(e/1e3);return t<.5&&(t=.5),t}},{key:"getColor",value:function(e){return(e/=1e4)>100?"#800026":e>50?"#BD0026":e>25?"#E31A1C":e>10?"#FC4E2A":e>5?"#FD8D3C":e>2?"#FEB24C":e>.5?"#FED976":"#FFEDA0"}},{key:"renderUS",value:function(){return r.a.createElement(re,{markers:this.state.us})}},{key:"renderStates",value:function(){return r.a.createElement(re,{markers:this.state.stateMarkers})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(B.a,{style:{height:"65vh",width:"100%"},zoom:4,minZoom:1,center:[37.8,-96],ref:function(t){e.map=t},maxBounds:[[90,-1/0],[-90,1/0]],worldCopyJump:!0},r.a.createElement(F.a,{url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png"}),r.a.createElement(re,{markers:this.state.markers}),r.a.createElement(G.a,{position:"topright"},r.a.createElement(G.a.BaseLayer,{name:"Show US Country"},r.a.createElement(z.a,null,this.renderUS())),r.a.createElement(G.a.BaseLayer,{checked:!0,name:"Show US State"},r.a.createElement(z.a,null,this.renderStates())))))}}]),a}(n.Component);function ie(e){return"".concat(e.country).concat(e.state?" / "+e.state:"")}function oe(e){var t=e.split("/");return{country:t[0].trim(),state:2===t.length?t[1].trim():""}}a(810),a(811);var ce=C.a.Option,le=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleYScaleSelect=function(e){console.log(e),n.setState({yScale:e.target.value})},n.handleStatisticSelect=function(e){n.setState({statistic:e.target.value},(function(){n.map.fetchData(n.state.dynamicMapOn)}))},n.handleDataTypeSelect=function(e){console.log(e),n.setState({dataType:e})},n.handleMapShownSelect=function(e){n.setState({mapShown:e.target.value},(function(){n.map.fetchData(n.state.dynamicMapOn)}))},n.componentWillMount=function(){n.addAreaByStr("US"),n.formRef=r.a.createRef(),n.modelAPI=new Y,n.modelAPI.areas((function(e){return n.setState({areasList:e})})),n.modelAPI.infection_models((function(e){return n.setState({modelsList:e},(function(){n.modelAPI.death_models((function(e){for(var t=function(t){n.setState((function(a){return{modelsList:[].concat(Object(S.a)(a.modelsList),[e[t]])}}))},a=6;a<e.length;++a)t(a)}))}))})),n.modelAPI.getCurrentDate((function(e){return n.setState({currentDate:e[0].date,firstDate:e[0].firstDate})})),n.modelAPI.real_time((function(e){n.setState({totalConfirmed:e.totalConfirmed,totalDeaths:e.totalDeaths})}))},n.bindRef=function(e){n.map=e},n.onAlertClose=function(){n.setState({noDataError:!1})},n.onNoData=function(e){n.setState({noDataError:!0,errorDescription:"There is currently no data for ".concat(e)})},n.generateMarks=function(){var e=n.state,t=e.currentDate,a=e.days,r=e.firstDate,s=new Date("".concat(t,"T00:00")),i=new Date("".concat(r,"T00:00"));s.setDate(s.getDate(Date)+a);var o={};o[a]="".concat(s.getMonth()+1,"/").concat(s.getDate());for(var c=a+7,l=1,u=1+Math.floor(2e3/n.state.width);c<a+50&&c<=99;)s.setDate(s.getDate()+7),o[c]=l%u?"":"".concat(s.getMonth()+1,"/").concat(s.getDate()),c+=7,l+=1;for((s=new Date("".concat(t,"T00:00"))).setDate(s.getDate(Date)+a),s.setDate(s.getDate()-7),c=a-7,l=1;s>=i&&c>a-30;)o[c]=l%u?"":"".concat(s.getMonth()+1,"/").concat(s.getDate()),s.setDate(s.getDate()-7),c-=7,l+=1;return o},n.getDaysToFirstDate=function(){var e=n.state,t=e.currentDate,a=e.firstDate,r=new Date("".concat(t,"T00:00")),s=new Date("".concat(a,"T00:00"));return Math.ceil(Math.abs(r-s)/864e5)},n.toggleControlInstructions=function(){var e=n.state.showControlInstructions;n.setState({showControlInstructions:!e})},n.toggleMapInstructions=function(){var e=n.state.showMapInstructions;n.setState({showMapInstructions:!e})},n.state={areas:n.props.areas||[],areasList:[],models:n.props.models||["SI-kJalpha - Default"],modelsList:[],currentDate:"",firstDate:"",current:!0,worst_effort:!1,best_effort:!1,mainGraphData:{},days:14,dynamicMapOn:!0,dataType:["confirmed"],statistic:"cumulative",mapShown:"confirmed",yScale:"linear",noDataError:!1,errorDescription:"",showControlInstructions:!1,showMapInstructions:!1,totalConfirmed:0,totalDeaths:0,width:0,height:0},n.addAreaByStr=n.addAreaByStr.bind(Object(w.a)(n)),n.removeAreaByStr=n.removeAreaByStr.bind(Object(w.a)(n)),n.onValuesChange=n.onValuesChange.bind(Object(w.a)(n)),n.onMapClick=n.onMapClick.bind(Object(w.a)(n)),n.onDaysToPredictChange=n.onDaysToPredictChange.bind(Object(w.a)(n)),n.switchDynamicMap=n.switchDynamicMap.bind(Object(w.a)(n)),n.onAlertClose=n.onAlertClose.bind(Object(w.a)(n)),n.onNoData=n.onNoData.bind(Object(w.a)(n)),n.generateMarks=n.generateMarks.bind(Object(w.a)(n)),n.handleDataTypeSelect=n.handleDataTypeSelect.bind(Object(w.a)(n)),n.handleStatisticSelect=n.handleStatisticSelect.bind(Object(w.a)(n)),n.handleYScaleSelect=n.handleYScaleSelect.bind(Object(w.a)(n)),n.toggleControlInstructions=n.toggleControlInstructions.bind(Object(w.a)(n)),n.toggleMapInstructions=n.toggleMapInstructions.bind(Object(w.a)(n)),n.updateWindowDimensions=n.updateWindowDimensions.bind(Object(w.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"updateWindowDimensions",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"onMapClick",value:function(e){this.areaIsSelected(e)||this.addAreaByStr(e)}},{key:"areaIsSelected",value:function(e){return!(!this.state.areas||!e)&&this.state.areas.includes(e)}},{key:"addAreaByStr",value:function(e){var t=this,a=oe(e);this.setState((function(t){return{areas:[].concat(Object(S.a)(t.areas),[e])}}),(function(){t.state.days>=0?t.modelAPI.predict({state:a.state,country:a.country,models:t.state.models,days:t.state.days,current:t.state.current,worst_effort:t.state.worst_effort,best_effort:t.state.best_effort},(function(a){t.setState((function(t){return{mainGraphData:Object(E.a)(Object(E.a)({},t.mainGraphData),{},Object(D.a)({},e,a))}}))})):t.modelAPI.checkHistory({state:a.state,country:a.country,days:t.state.days},(function(a){t.setState((function(t){return{mainGraphData:Object(E.a)(Object(E.a)({},t.mainGraphData),{},Object(D.a)({},e,a))}}))})),null!=t.formRef.current&&t.formRef.current.setFieldsValue({areas:t.state.areas})}))}},{key:"removeAreaByStr",value:function(e){this.setState((function(t){return{areas:t.areas.filter((function(t){return t!==e})),mainGraphData:Object.keys(t.mainGraphData).filter((function(t){return t!==e})).reduce((function(e,a){return Object(E.a)(Object(E.a)({},e),{},Object(D.a)({},a,t.mainGraphData[a]))}),{})}}))}},{key:"modelIsSelected",value:function(e){if(this.state.models&&e){var t="".concat(e.name);return this.state.models.includes(t)}return!1}},{key:"onValuesChange",value:function(e,t){var a=this;this.state.dataType;if("socialDistancing"in e&&this.setState({current:t.socialDistancing.includes("current"),worst_effort:t.socialDistancing.includes("worst_effort"),best_effort:t.socialDistancing.includes("best_effort")},(function(){a.reloadAll()})),"models"in e)this.setState({models:e.models},(function(){a.reloadAll()}));else{var n=this.state.areas,r=t.areas,s=r.filter((function(e){return!n.includes(e)})),i=n.filter((function(e){return!r.includes(e)}));s.forEach(this.addAreaByStr),i.forEach(this.removeAreaByStr)}}},{key:"onDaysToPredictChange",value:function(e){var t=this;this.state.areas;this.setState({days:e},(function(){t.reloadAll()}))}},{key:"reloadAll",value:function(){var e=this,t=this.state.areas;this.setState({areas:[],mainGraphData:{}},(function(){t.forEach(e.addAreaByStr),e.state.dynamicMapOn&&0!==e.state.models.length&&e.map.fetchData(e.state.dynamicMapOn)}))}},{key:"switchDynamicMap",value:function(e){this.setState({dynamicMapOn:e}),this.map.fetchData(e)}},{key:"render",value:function(){var e=this,t=this.state,a=t.areas,n=t.areasList,s=t.models,i=t.modelsList,o=t.days,c=t.mainGraphData,l=t.dynamicMapOn,u=t.dataType,D=t.statistic,E=t.mapShown,S=t.yScale,w=t.noDataError,O=t.errorDescription,_=this.generateMarks(),M=this.getDaysToFirstDate(),j=n.filter((function(t){return!e.areaIsSelected(t)})).map(ie).sort().map((function(e){return r.a.createElement(ce,{key:e}," ",e," ")})),V=i.filter((function(t){return!e.modelIsSelected(t)})).map((function(e){return r.a.createElement(ce,{key:e.name,value:e.name},r.a.createElement(k.a,{title:e.description,placement:"right"},e.name))})),A={area:r.a.createElement("p",{className:"instruction"},"Select the areas by clicking on the map or searching in this input box."),model:r.a.createElement("div",{className:"instruction"},r.a.createElement("p",{className:"instruction"},'"SI-kJalpha - 20x " assumes that the true positive cases are 20 times the current reported cases. "SI-kJalpha-Default" is our best guess.')),date:r.a.createElement("p",{className:"instruction"},"Predictions up to the date selected will be shown."),socialDistancing:r.a.createElement("p",{className:"instruction"},"Compare different social distancing scenarios."),data_type:r.a.createElement("p",{className:"instruction"},"Select the forecasts for cumulative infections or/and deaths."),statistics:r.a.createElement("p",{className:"instruction"},"Switch between cumulative view and incident view."),scale:r.a.createElement("p",{className:"instruction"},"Switch between linear view and logarithmic view.")},I={selectMap:r.a.createElement("p",{className:"instruction vertical"},"Hover over the bubbles to see case and death data. Select to add to the plot. Button on the top right to toggle between US states and the country."),dynamicMap:r.a.createElement("p",{className:"instruction vertical"},"Enable the map to dynamically change to reflect the data and predictions based on the selected options. Turn off if the interface seems slow."),radioGroup:r.a.createElement("p",{className:"instruction vertical"},"Switch between cumulative infection view or death view on the heatmap.")},x="";if(0!=this.state.totalConfirmed&&0!=this.state.totalDeaths){var N=new Date,T=String(N.getDate()).padStart(2,"0");x="By "+String(N.getMonth()+1).padStart(2,"0")+"/"+T+"/"+N.getFullYear()+", "+this.state.totalConfirmed.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" people around the world have been tested positive, and "+this.state.totalDeaths.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" people have died of COVID-19."}for(var R="",W="",L=s.length-1;L>=0;L--){if("SI-kJalpha"===s[L].substring(0,10)){R=s[L],0===W.length&&(W=s[L]+" (death prediction)");break}W=s[L]}var B=r.a.createElement("div",{id:"header",className:"text-center"},r.a.createElement("div",{id:"overview"},r.a.createElement("b",null,x)));return r.a.createElement("div",{className:"covid-19-predict"},B,r.a.createElement("div",null,r.a.createElement(p.a,{type:"flex",justify:"center",id:"charts"},w?r.a.createElement(b.a,{message:"".concat(O),description:"Please wait for our updates.",type:"error",closable:!0,onClose:this.onAlertClose}):null,r.a.createElement("div",{className:"form-column"},r.a.createElement("div",null,r.a.createElement("div",{className:"form-wrapper gray",id:"graph_options"},r.a.createElement(y.a,{ref:this.formRef,onValuesChange:this.onValuesChange,initialValues:{areas:a,models:s,days:14,socialDistancing:["current"]}},r.a.createElement(g.a,{content:A.area,placement:"top",visible:this.state.showControlInstructions},r.a.createElement(y.a.Item,{style:{marginBottom:"0px"},label:"Areas",name:"areas",rules:[{required:!0,message:"Please select areas!"}]},r.a.createElement(C.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select Areas"},j))),r.a.createElement(g.a,{content:A.model,placement:"rightTop",visible:this.state.showControlInstructions,align:{overflow:{adjustX:!1,adjustY:!1}}},r.a.createElement(y.a.Item,{style:{marginBottom:"0px"},label:"Models:",name:"models",rules:[{required:!0,message:"Please select a prediction model!"}]},r.a.createElement(C.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select Prediction Models"},V))),r.a.createElement(g.a,{placement:"rightBottom",content:A.date,visible:this.state.showControlInstructions},r.a.createElement(y.a.Item,{label:"Date to Predict",name:"days"},r.a.createElement(v.a,{marks:_,min:o-30>=-M?o-30:-M,initialValue:o,max:o+50<=99?o+50:99,onAfterChange:this.onDaysToPredictChange,step:null,tooltipVisible:!1}))),r.a.createElement(g.a,{content:A.socialDistancing,placement:"right",visible:this.state.showControlInstructions},r.a.createElement(y.a.Item,{label:"Social Distancing",name:"socialDistancing",style:{marginBottom:"0px"}},r.a.createElement(f.a.Group,{style:{width:"100%"}},r.a.createElement(p.a,null,r.a.createElement(f.a,{defaultChecked:!0,value:"current"},"Current Trend"),r.a.createElement(f.a,{value:"worst_effort"},"Worst Distancing Effort"),r.a.createElement(f.a,{value:"best_effort"},"Best Distancing Effort")))))),r.a.createElement(y.a,null,r.a.createElement(g.a,{content:A.data_type,placement:"right",visible:this.state.showControlInstructions},r.a.createElement(y.a.Item,{label:"Data Types",style:{marginBottom:"0px"}},r.a.createElement(f.a.Group,{value:u,onChange:this.handleDataTypeSelect},r.a.createElement(f.a,{defaultChecked:!0,value:"confirmed"},"Confirmed Cases"),r.a.createElement(f.a,{value:"death"},"Deaths")))),r.a.createElement(g.a,{content:A.statistics,placement:"right",visible:this.state.showControlInstructions},r.a.createElement(y.a.Item,{label:"Statistic",style:{marginBottom:"0px"}},r.a.createElement(m.a.Group,{value:D,onChange:this.handleStatisticSelect},r.a.createElement(m.a,{value:"cumulative"},"Cumulative Cases"),r.a.createElement(m.a,{value:"delta"},"New Cases")))),r.a.createElement(g.a,{content:A.scale,placement:"right",visible:this.state.showControlInstructions},r.a.createElement(y.a.Item,{label:"Scale",style:{marginBottom:"0px"}},r.a.createElement(m.a.Group,{value:S,onChange:this.handleYScaleSelect},r.a.createElement(m.a,{value:"linear"},"Linear"),r.a.createElement(m.a,{value:"log"},"Logarithmic"))))))),a.length?r.a.createElement("div",null,r.a.createElement("div",{className:"graph-wrapper"},r.a.createElement(P,{data:c,dataType:u,onNoData:this.onNoData,statistic:D,yScale:S}))):null),r.a.createElement("div",{className:"map-column"},r.a.createElement("div",{className:"form-wrapper gray",id:"graph_options"},r.a.createElement("div",null,r.a.createElement("span",{className:"map-control"},r.a.createElement(g.a,{content:I.dynamicMap,placement:"bottom",visible:this.state.showMapInstructions},r.a.createElement(h.a,{defaultChecked:!0,onChange:this.switchDynamicMap}),r.a.createElement("b",null,"\xa0\xa0Dynamic Map\xa0\xa0"))))),r.a.createElement("div",null,r.a.createElement("div",{className:"map-wrapper"},r.a.createElement(g.a,{content:I.selectMap,placement:"leftBottom",visible:this.state.showMapInstructions},r.a.createElement(se,{className:"map",triggerRef:this.bindRef,dynamicMapOn:l,days:o,confirmed_model:R,death_model:W,onMapClick:this.onMapClick,onNoData:this.onNoData,statistic:D,dataType:E})))),r.a.createElement("div",null,r.a.createElement("div",{className:"instruction-buttons-wrapper"},r.a.createElement(d.a,{className:"instruction-button",onClick:this.toggleControlInstructions},0==this.state.showControlInstructions?"Help with controls":"Close control instructions"),r.a.createElement(d.a,{className:"instruction-button",onClick:this.toggleMapInstructions},0==this.state.showMapInstructions?"Help with the map":"Close map instructions")))))))}}]),a}(n.PureComponent),ue=(a(933),a(403),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"page-wrapper"},r.a.createElement("div",{className:"article"},r.a.createElement("h1",{className:"article-title"},"ReCOVER: Accurate Predictions and Resource Management for COVID-19 Epidemic Response"),r.a.createElement("p",{className:"article-paragraph"},"Accurate forecasts of COVID-19 is central to resource management and building strategies to deal with the epidemic. This is an NSF-funded project on COVID-19 forecasting led by by ",r.a.createElement("a",{className:"article-anchor",href:"https://sites.usc.edu/prasanna/"}," Viktor K. Prasanna ")," and ",r.a.createElement("a",{className:"article-anchor",href:"http://www-scf.usc.edu/~ajiteshs/"}," Ajitesh Srivastava "),"from the ",r.a.createElement("a",{className:"article-anchor",href:"https://dslab.usc.edu/"}," Data Science Lab ")," at the University of Southern California."),r.a.createElement("h2",null,"Our Approach"),r.a.createElement("p",{className:"article-paragraph"},"We use our own epidemic model called ",r.a.createElement("a",{className:"article-anchor",href:"https://arxiv.org/abs/2007.05180"}," SI-kJalpha"),", preliminary version of which we have successfully used during ",r.a.createElement("a",{className:"article-anchor",href:"https://news.usc.edu/83180/usc-engineers-earn-national-recognition-for-predicting-disease-outbreaks/",target:"_blank"},"DARPA Grand Challenge 2014"),". Our forecast appears on the official ",r.a.createElement("a",{className:"article-anchor",href:"https://www.cdc.gov/coronavirus/2019-ncov/covid-data/forecasting-us.html"}," CDC webpage"),". Our model can consider the effect of many complexities of the epidemic process and yet be simplified to a few parameters that are learned using fast linear regressions. Therefore, our approach can learn and generate forecasts extremely quickly. On a 2 core desktop machine, our approach takes only 3.18s to tune hyper-parameters, learn parameters and generate 100 days of forecasts of reported cases and deaths for all the states in the US. The total execution time for 184 countries is 11.83s and for more than 3000 US counties is 101.03s. Despite being fast, the accuracy of our forecasts is on par with the state-of-the-art as demonstrated on the ",r.a.createElement("a",{className:"article-anchor",href:"https://scc-usc.github.io/ReCOVER-COVID-19/#/leaderboard"}," leaderboard page"),". Details of modeling and comparisons can be found in ",r.a.createElement("a",{className:"article-anchor",href:"https://arxiv.org/abs/2007.05180"}," our paper"),". This work is supported by National Science Foundation Award No. 2027007 (RAPID)"),r.a.createElement("p",{className:"article-paragraph"},"The ",r.a.createElement("a",{className:"article-anchor",href:"https://github.com/scc-usc/ReCOVER-COVID-19",target:"_blank"}," Github repository ")," for this project is publicly available."),r.a.createElement("p",{className:"article-paragraph"},"The matlab code for forecasting is also made available on ",r.a.createElement("a",{className:"article-anchor",href:"https://www.mathworks.com/matlabcentral/fileexchange/75281-recover",target:"_blank"},"File Exchange"),". For the latest code, please see the Github repo."),r.a.createElement("p",{className:"article-paragraph"}," The code of the prediction model and this web application is contributed by Ajitesh Srivastava, Jamin Chen, Frost Tianjian Xu, and Bob Xiaochen Yang. "),r.a.createElement("p",{className:"article-paragraph"}," The forecast visualization is further implemented by James Orme-Rogers, James Wolfe, Sung Bin Kim, and Vicky Yu. "),r.a.createElement("h2",null,"Related Papers"),r.a.createElement("ol",{className:"article-paragraph"},r.a.createElement("li",null,"Ajitesh Srivastava, Tianjian Xu and Viktor K. Prasanna,",r.a.createElement("a",{className:"article-anchor",href:"https://arxiv.org/abs/2007.05180",target:"_blank"},' "Fast and Accurate Forecasting of COVID-19 Deaths using the SIkJalpha Model"')," [arXiv]."),r.a.createElement("li",null,"Ajitesh Srivastava and Viktor K. Prasanna,",r.a.createElement("a",{className:"article-anchor",href:"https://arxiv.org/abs/2006.02127",target:"_blank"},' "Data-driven Identification of Number of Unreported Cases for COVID-19: Bounds and Limitations"')," [arXiv]. Accepted at KDD 2020."),r.a.createElement("li",null,"Ajitesh Srivastava and Viktor K. Prasanna,",r.a.createElement("a",{className:"article-anchor",href:"https://arxiv.org/abs/2004.11372",target:"_blank"},' "Learning to Forecast and Forecasting to Learn from the COVID-19 Pandemic"')," [arXiv].")),r.a.createElement("h2",null,"Other Links"),r.a.createElement("ol",{className:"article-paragraph"},r.a.createElement("li",null,r.a.createElement("a",{className:"article-anchor",href:"https://www.youtube.com/watch?v=ll6k8wlxOFo",target:"_blank"},"Webinar ")," describing our intial approach.")),r.a.createElement("h2",null,"USC Data Science Lab"),r.a.createElement("p",{className:"article-paragraph"},"The USC Data Science Lab focuses on applying machine learning, data mining, and network analysis to real-world problems in society and industry. Please find more information and other research projects ",r.a.createElement("a",{className:"article-anchor",href:"https://sites.usc.edu/dslab/",target:"_blank"}," on our website"),".")))}}]),a}(n.Component)),de=(a(934),a(355));var he=function(e){var t=e.series,a=e.lineGenerator,n=e.xScale,s=e.yScale;return t.map((function(e){var t=e.id,i=e.data,o=e.color,c=e.predicted,l=e.distancing,u={strokeWidth:5};return c&&(u.strokeDasharray=l?"6, 4":"2, 6"),r.a.createElement("path",{key:t,d:a(i.map((function(e){return{x:n(e.data.x),y:s(e.data.y)}}))),fill:"none",stroke:o,style:u})}))},me={axis:{ticks:{text:{fontSize:18}},legend:{text:{fontSize:18}}},legends:{text:{fontSize:18}}},pe=(n.Component,a(109));var fe=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).parseData=function(e,t){var a=Object.keys(e)[0];if(e[a])return"reproduction"===t?e[a].observed_rt.map((function(t,a){var n={name:t.date.split("-")[1]+"/"+t.date.split("-")[2]};n[Object.keys(e)[0]]=t.value,n["error".concat(Object.keys(e)[0])]=t.conf;for(var r=1;r<Object.keys(e).length;++r)n[Object.keys(e)[r]]=e[Object.keys(e)[r]].observed_rt[a].value,n["error".concat(Object.keys(e)[r])]=e[Object.keys(e)[r]].observed_rt[a].conf;return n})):e[a].observed_mrf.map((function(t,a){var n={name:t.date.split("-")[1]+"/"+t.date.split("-")[2]};n[Object.keys(e)[0]]=t.value,n["error".concat(Object.keys(e)[0])]=t.conf;for(var r=1;r<Object.keys(e).length;++r)n[Object.keys(e)[r]]=e[Object.keys(e)[r]].observed_mrf[a].value,n["error".concat(Object.keys(e)[r])]=e[Object.keys(e)[r]].observed_mrf[a].conf;return n}))},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.date,n=e.scoreType,s=this.parseData(t,n),i=Object.keys(t),o=[];i.map((function(e,t){var a=function(e){var t=[I.red,I.gold,I.lime,I.cyan,I.geekblue,I.purple,I.magenta];return t[e%t.length]}(t);return o.push(a),0}));for(var c=[],l=0;l<i.length;++l)c.push(r.a.createElement(pe.e,{type:"monotone",key:l,dataKey:i[l],stroke:o[l][3],strokeWidth:5},r.a.createElement(pe.b,{dataKey:"error".concat(i[l]),width:15,strokeWidth:2,stroke:o[l][6],direction:"y"})));return r.a.createElement(pe.f,{width:1400,height:300,data:s,margin:{top:40,right:30,left:40,bottom:5}},r.a.createElement(pe.a,{strokeDasharray:"3 3"}),r.a.createElement(pe.i,{dataKey:"name"}),r.a.createElement(pe.j,null,"reproduction"===n?r.a.createElement(pe.c,{value:"Dynamic Reproduction Number",dy:90,position:"insideLeft",angle:-90,fontSize:15}):r.a.createElement(pe.c,{value:"MFR Score",dy:45,position:"insideLeft",angle:-90,fontSize:15})),r.a.createElement(pe.h,null),r.a.createElement(pe.g,{x:a,stroke:"green",strokeWidth:5,fontSize:20,label:{position:"top",value:"selected date",fill:"green",fontSize:15},strokeDasharray:"10 10"}),"reproduction"===n?r.a.createElement(pe.g,{y:1,stroke:"SandyBrown",strokeWidth:5,strokeDasharray:"3 3",label:{position:"left",value:"",fill:"red",fontSize:20}}):null,r.a.createElement(pe.d,{iconSize:40}),c)}}]),a}(n.Component),ve=a(117),ge=a(247),ye=a(579),be=a(580),ke=a(587);ve.e(ke.a);var De=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).onShowState=function(t){e.setState({showState:t})},e.modelAPI=new Y,e.state={areasList:[],showState:!1,worldSeries:{},usaSeries:{}},e.modelAPI.areas((function(t){return e.setState({areasList:t})})),e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.triggerRef(this)}},{key:"fetchData",value:function(){var e=this,t=arguments,a=this.props.scoreType;t[0]?"reproduction"===a?this.modelAPI.scores_all({weeks:this.props.weeks},(function(a){var n=a.map((function(e){return{id:e.area.iso_2,value:e.value>0?e.value:0,area:e.area}}));t[1]?e.setState({heatmapData:n},e.initChart):e.setState({heatmapData:n},e.updateChart)})):this.modelAPI.all_mrf_scores({weeks:this.props.weeks},(function(a){var n=a.map((function(e){return{id:e.area.iso_2,value:e.value>0?e.value:0,area:e.area}}));t[1]?e.setState({heatmapData:n},e.initChart):e.setState({heatmapData:n},e.updateChart)})):"reproduction"===a?this.modelAPI.scores_all({weeks:this.props.latestWeek},(function(t){var a=t.map((function(e){return{id:e.area.iso_2,value:e.value>0?e.value:0,area:e.area,conf:e.conf}}));e.setState({heatmapData:a},e.initChart)})):this.modelAPI.all_mrf_scores({weeks:this.props.latestWeek},(function(t){var a=t.map((function(e){return{id:e.area.iso_2,value:e.value>0?e.value:0,area:e.area,conf:e.conf}}));e.setState({heatmapData:a},e.initChart)}))}},{key:"initChart",value:function(){this.chart=ve.d("chartdiv",ge.a),this.chart.projection=new ge.d.Mercator;var e=this.chart.series.push(new ge.b);e=this.createChartSeries(e,{geodata:ye.a,exclude:["AQ"],data:this.state.heatmapData});var t=this.chart.series.push(new ge.b);t=this.createChartSeries(t,{geodata:be.a,data:this.state.heatmapData,disabled:!this.state.showState}),this.stateSeries=[t],this.initChartInterface(),this.setState({worldSeries:e,usaSeries:t})}},{key:"updateChart",value:function(){var e=this.state.worldSeries,t=this.state.usaSeries;e.data=this.state.heatmapData,t.data=this.state.heatmapData}},{key:"createChartSeries",value:function(e,t){var a=this.props.scoreType,n=(e=Object.assign(e,t)).mapPolygons.template;"reproduction"===a?e.heatRules.push({property:"fill",target:n,min:ve.c("#85DB50"),max:ve.c("#F33A21"),minValue:0,maxValue:4}):e.heatRules.push({property:"fill",target:n,min:ve.c("#85DB50"),max:ve.c("#F33A21"),minValue:0,maxValue:.4}),n.tooltipText="{name}: {value}",n.nonScalingStroke=!0,n.strokeWidth=.5,n.states.create("hover").properties.fill=ve.c("#83FE00"),n.cursorOverStyle=ve.b.pointer;var r=this.props,s=r.onMapClick,i=r.onNoData;return n.events.on("hit",(function(e){var t=e.target.dataItem.dataContext,a=(t.id,t.value,t.area),n=t.name;a?s(a):i(n)})),e}},{key:"initChartInterface",value:function(){var e=this,t=this.state.showState;this.chart.zoomControl=new ge.c,this.chart.zoomControl.cursorOverStyle=ve.b.pointer;var a=this.chart.chartContainer.createChild(ve.a);a.label.text="".concat(t?"Hide":"Show"," States/Provinces"),a.togglable=!0,a.padding(5,5,5,5),a.align="right",a.marginRight=15,a.cursorOverStyle=ve.b.pointer,a.events.on("hit",(function(){e.onShowState(a.isActive);var t=e.state.showState;e.stateSeries.forEach((function(e){return e.disabled=!t})),a.label.text="".concat(t?"Hide":"Show"," States/Provinces")}))}},{key:"componentWillUnmount",value:function(){this.chart&&this.chart.dispose()}},{key:"render",value:function(){return r.a.createElement("div",{id:"chartdiv"})}}]),a}(n.Component),Ee=(a(1017),C.a.Option),Se=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){n.formRef=r.a.createRef(),n.modelAPI=new Y,n.modelAPI.latest_score_date((function(e){return n.setState({latestDate:e[0].date,weeks:e[0].weeks,latestWeek:e[0].weeks,firstDate:e[0].firstDate},(function(){n.addAreaByStr("US"),n.formRef.current.setFieldsValue({weeks:n.state.latestWeek}),n.map.fetchData(n.state.dynamicMapOn)}))})),n.modelAPI.areas((function(e){return n.setState({areasList:e})}))},n.bindRef=function(e){n.map=e},n.onAlertClose=function(){n.setState({noDataError:!1})},n.onNoData=function(e){n.setState({noDataError:!0,errorDescription:"There is currently no data for ".concat(e)})},n.generateMarks=function(){var e=n.state,t=e.weeks,a=(e.lastDate,e.latestWeek),r=e.firstDate,s=new Date("".concat(r,"T00:00"));s.setDate(s.getDate(Date)+7*t);for(var i={},o=0;o<=5&&t+o<=a;)i[t+o]="".concat(s.getMonth()+1,"/").concat(s.getDate()),s.setDate(s.getDate(Date)+7),o++;for(o=1,(s=new Date("".concat(r,"T00:00"))).setDate(s.getDate(Date)+7*(t-1));o<=5&&t-o>=0;)i[t-o]="".concat(s.getMonth()+1,"/").concat(s.getDate()),s.setDate(s.getDate(Date)-7),o++;return(s=new Date("".concat(r,"T00:00"))).setDate(s.getDate(Date)+7*t),[s,i]},n.handleScoreTypeSelect=function(e){n.setState({scoreType:e.target.value},(function(){n.map.fetchData(n.state.dynamicMapOn,!0)}))},n.state={areas:n.props.areas||[],areasList:[],latestDate:"",firstDate:"",mainGraphData:{},weeks:n.props.weeks||0,latestWeek:0,dynamicMapOn:!1,noDataError:!1,errorDescription:"",scoreType:"reproduction"},n.addAreaByStr=n.addAreaByStr.bind(Object(w.a)(n)),n.removeAreaByStr=n.removeAreaByStr.bind(Object(w.a)(n)),n.onValuesChange=n.onValuesChange.bind(Object(w.a)(n)),n.onMapClick=n.onMapClick.bind(Object(w.a)(n)),n.onWeeksChange=n.onWeeksChange.bind(Object(w.a)(n)),n.switchDynamicMap=n.switchDynamicMap.bind(Object(w.a)(n)),n.onAlertClose=n.onAlertClose.bind(Object(w.a)(n)),n.onNoData=n.onNoData.bind(Object(w.a)(n)),n.generateMarks=n.generateMarks.bind(Object(w.a)(n)),n.handleScoreTypeSelect=n.handleScoreTypeSelect.bind(Object(w.a)(n)),n}return Object(c.a)(a,[{key:"onMapClick",value:function(e){this.areaIsSelected(e)||this.addAreaByStr(ie(e))}},{key:"areaIsSelected",value:function(e){if(this.state.areas&&e){var t=ie(e);return this.state.areas.includes(t)}return!1}},{key:"addAreaByStr",value:function(e){var t=this,a=oe(e);this.setState((function(t){return{areas:[].concat(Object(S.a)(t.areas),[e])}}),(function(){t.modelAPI.scores({state:a.state,country:a.country,weeks:t.state.latestWeek},(function(a){t.setState((function(t){return{mainGraphData:Object(E.a)({},t.mainGraphData,Object(D.a)({},e,a))}}))})),t.formRef.current.setFieldsValue({areas:t.state.areas})}))}},{key:"removeAreaByStr",value:function(e){this.setState((function(t){return{areas:t.areas.filter((function(t){return t!==e})),mainGraphData:Object.keys(t.mainGraphData).filter((function(t){return t!==e})).reduce((function(e,a){return Object(E.a)({},e,Object(D.a)({},a,t.mainGraphData[a]))}),{})}}))}},{key:"onValuesChange",value:function(e,t){var a=this.state.areas,n=t.areas;if(n&&a){var r=n.filter((function(e){return!a.includes(e)})),s=a.filter((function(e){return!n.includes(e)}));r.forEach(this.addAreaByStr),s.forEach(this.removeAreaByStr)}}},{key:"onWeeksChange",value:function(e){var t=this;this.setState({weeks:e},(function(){t.state.dynamicMapOn&&t.map.fetchData(t.state.dynamicMapOn)}))}},{key:"switchDynamicMap",value:function(e){this.setState({dynamicMapOn:e}),this.map.fetchData(e)}},{key:"render",value:function(){var e=this,t=this.state,a=t.areas,n=t.areasList,s=t.weeks,i=t.mainGraphData,o=t.dynamicMapOn,c=t.latestWeek,l=t.noDataError,u=t.errorDescription,d=t.scoreType,f=n.filter((function(t){return!e.areaIsSelected(t)})).map(ie).sort().map((function(e){return r.a.createElement(Ee,{key:e}," ",e," ")})),g=this.generateMarks(),k=Object(O.a)(g,2),D=k[0],E=k[1],S=D.getMonth()+1<10?"0".concat(D.getMonth()+1):D.getMonth()+1,w=D.getDate()<10?"0".concat(D.getDate()):D.getDate(),_="".concat(S,"/").concat(w);return r.a.createElement("div",{className:"score-page"},r.a.createElement(p.a,{type:"flex",justify:"space-around"},r.a.createElement(de.a,{span:10},l?r.a.createElement(b.a,{message:"".concat(u),description:"Please wait for our updates.",type:"error",closable:!0,onClose:this.onAlertClose}):null,r.a.createElement("div",{className:"form-wrapper"},r.a.createElement(y.a,{ref:this.formRef,onValuesChange:this.onValuesChange},r.a.createElement(y.a.Item,{label:"Areas",name:"areas",rules:[{required:!0,message:"Please select areas!"}]},r.a.createElement(C.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select Areas"},f)),r.a.createElement(y.a.Item,{label:"Week to check",name:"weeks",rules:[{required:!0,message:"Please select the week you want to see"}]},r.a.createElement(v.a,{marks:E,initialValue:s,min:s-5>=0?s-5:0,max:s+5<=c?s+5:c,onAfterChange:this.onWeeksChange}))),r.a.createElement("div",{className:"radio-group"},"Data Type:\xa0\xa0",r.a.createElement(m.a.Group,{value:d,onChange:this.handleScoreTypeSelect},r.a.createElement(m.a,{value:"reproduction"},"Dynamic Reproduction Number"),r.a.createElement(m.a,{value:"mfr"},"Model-based Fatality Rate"))),r.a.createElement("p",null,"Dynamic Map:\xa0\xa0",r.a.createElement(h.a,{onChange:this.switchDynamicMap})))),r.a.createElement(de.a,{span:14},r.a.createElement("div",{className:"map-wrapper"},r.a.createElement(De,{className:"score-map",triggerRef:this.bindRef,dynamicMapOn:o,weeks:s,latestWeek:c,onMapClick:this.onMapClick,onNoData:this.onNoData,scoreType:d})))),a.length?r.a.createElement(p.a,null,r.a.createElement(de.a,{span:24},r.a.createElement("div",{className:"graph-wrapper"},r.a.createElement(fe,{data:i,date:_,scoreType:d})))):null)}}]),a}(n.PureComponent),we=a(586),Ce=a(66),Oe=(a(1018),a(1019),a(1124)),_e=a(1125),Me=function(){return r.a.createElement(Oe.a,{collapseOnSelect:!0,expand:"lg",className:"navbar-header navbar-light"},r.a.createElement(Oe.a.Brand,{href:"#/"},r.a.createElement("img",{className:"logo",src:"https://identity.usc.edu/files/2011/12/combo_gold_white_cardinal.png",alt:"USC"})),r.a.createElement(Oe.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),r.a.createElement(Oe.a.Collapse,{id:"responsive-navbar-nav"},r.a.createElement(_e.a,{className:"mr-auto"},r.a.createElement(_e.a.Link,{className:"navbar-link",href:"#/"},"COVID-19 Forecast"),r.a.createElement(_e.a.Link,{className:"navbar-link",href:"#score"},"Reproduction Number"),r.a.createElement(_e.a.Link,{className:"navbar-link",href:"#highlights"},"Highlights"),r.a.createElement(_e.a.Link,{className:"navbar-link",href:"#leaderboard"},"Evaluation"),r.a.createElement(_e.a.Link,{className:"navbar-link",href:"#about"},"About Us")),r.a.createElement(_e.a,null)))},je=(a(1022),a(1023),a(583)),Ve=a(582),Ae=(a(1025),"https://htmlpreview.github.io/?https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/frontend/src/leaderboard/USFH_compare.html"),Ie=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).state={which_hub:Ae,width:0,height:0},e.updateWindowDimensions=e.updateWindowDimensions.bind(Object(w.a)(e)),e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"updateWindowDimensions",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"getAvatar",value:function(e){var t="";switch(e){case 1:t="https://img.icons8.com/officel/80/000000/medal2.png";break;case 2:t="https://img.icons8.com/officel/80/000000/medal-second-place.png";break;case 3:t="https://img.icons8.com/officel/80/000000/medal2-third-place.png";break;default:t="https://img.icons8.com/carbon-copy/100/000000/"+e+"-circle.png"}return r.a.createElement(je.a,{className:"rank-number",src:t,alt:""})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"page-wrapper"},r.a.createElement("div",{className:"grid"},r.a.createElement(p.a,null,r.a.createElement("div",{className:"introduction"},r.a.createElement("p",null,"We evaluate the submissions that are made publicly on various forecasting hubs and highlight where our submissions stand. Note that the following only compares the submissions and not the forecasting methodologies. The submissions may have used different methodologies over time and tuned manually. The evaluation of different methodologies is a part of our other upcoming project ",r.a.createElement("a",{href:"https://github.com/scc-usc/covid19-forecast-bench"},"here"),"."),r.a.createElement("p",null,"We are currently contributing to the following hubs. Please select one to see the evaluations.","\n")),r.a.createElement("div",null,r.a.createElement(d.a,{onClick:function(){return e.setState({which_hub:Ae})}},"US Forecast Hub"),r.a.createElement(d.a,{onClick:function(){return e.setState({which_hub:"https://htmlpreview.github.io/?https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/frontend/src/leaderboard/GFH_compare.html"})}},"Germany/Poland Forecast Hub"))),r.a.createElement(p.a,null,r.a.createElement(Ve.a,{url:this.state.which_hub,width:"100%",height:(.7*this.state.height).toString()}))))}}]),a}(n.Component),xe=a(278),Ne=(a(1062),a(584));function Te(e){var t=Object(n.useState)(null),a=Object(O.a)(t,2),s=a[0],i=a[1];function o(e){var t=e.numPages;i(t),document.querySelectorAll(".react-pdf__Page__textContent").forEach((function(e){var t=e.style;t.top="0",t.left="0",t.transform=""}))}var c=e.pdf;return r.a.createElement(Ne.SizeMe,{monitorHeight:!0,refreshRate:128,refreshMode:"debounce",render:function(e){var t=e.size;return r.a.createElement("div",null,r.a.createElement(xe.Document,{file:c,options:{workerSrc:"pdf.worker.js"},onLoadSuccess:o},Array.from(new Array(s),(function(e,a){return r.a.createElement(xe.Page,{width:t.width,key:"page_".concat(a+1),pageNumber:a+1})}))))}})}xe.pdfjs.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(xe.pdfjs.version,"/pdf.worker.js");var Re=a(585),Pe=a.n(Re),We=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).redirectForecast=function(){n.setState({redirectForecast:!0,redirectAbout:!1,redirectScore:!1,redirectLeaderboard:!1,redirectHighlights:!1})},n.redirectAbout=function(){n.setState({redirectForecast:!1,redirectAbout:!0,redirectScore:!1,redirectLeaderboard:!1,redirectHighlights:!1})},n.redirectScore=function(){n.setState({redirectForecast:!1,redirectAbout:!1,redirectScore:!0,redirectHighlights:!1,redirectLeaderboard:!1})},n.redirectLeaderboard=function(){n.setState({redirectForecast:!1,redirectAbout:!1,redirectScore:!1,redirectLeaderboard:!0,redirectHighlights:!1})},n.redirectHighlights=function(){n.setState({redirectForecast:!1,redirectAbout:!1,redirectScore:!1,redirectLeaderboard:!1,redirectHighlights:!0})},n.state={redirectForecast:!1,redirectAbout:!1,redirectScore:!1,redirectLeaderboard:!1,redirectHighlights:!1},n}return Object(c.a)(a,[{key:"render",value:function(){var e=this.state,t=e.redirectForecast,a=e.redirectAbout,n=e.redirectScore,s=e.redirectLeaderboard,i=e.redirectHighlights;return r.a.createElement(we.a,{basename:"/"},t?r.a.createElement(Ce.a,{to:"/"}):null,i?r.a.createElement(Ce.a,{to:"/highlights"}):null,n?r.a.createElement(Ce.a,{to:"/score"}):null,a?r.a.createElement(Ce.a,{to:"/about"}):null,s?r.a.createElement(Ce.a,{to:"/leaderboard"}):null,r.a.createElement(Me,{redirectForecast:this.redirectForecast,redirectHighlights:this.redirectHighlights,redirectScore:this.redirectScore,redirectAbout:this.redirectAbout,redirectLeaderboard:this.redirectLeaderboard}),r.a.createElement(Ce.d,null,r.a.createElement(Ce.b,{exact:!0,path:"/",render:function(e){return r.a.createElement(le,e)}}),r.a.createElement(Ce.b,{exact:!0,path:"/score",render:function(e){return r.a.createElement(Se,e)}}),r.a.createElement(Ce.b,{exact:!0,path:"/about",render:function(e){return r.a.createElement(ue,e)}}),r.a.createElement(Ce.b,{exact:!0,path:"/leaderboard",render:function(e){return r.a.createElement(Ie,e)}}),r.a.createElement(Ce.b,{exact:!0,path:"/highlights"},r.a.createElement(Te,{pdf:Pe.a}))))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(We,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},305:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=305},403:function(e,t,a){},554:function(e,t,a){e.exports=a.p+"static/media/global_lats_longs.16f05c12.txt"},555:function(e,t,a){e.exports=a.p+"static/media/global_population_data.e9f67e1b.txt"},585:function(e,t,a){e.exports=a.p+"static/media/highlights.56274eeb.pdf"},650:function(e,t,a){e.exports=a(1076)},655:function(e,t,a){},810:function(e,t,a){},933:function(e,t,a){}},[[650,1,3]]]);
//# sourceMappingURL=main.1c9b119f.chunk.js.map