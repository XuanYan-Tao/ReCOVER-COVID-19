(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{290:function(e,t,a){},315:function(e,t,a){e.exports=a.p+"static/media/global_lats_longs.16f05c12.txt"},316:function(e,t,a){e.exports=a.p+"static/media/global_population_data.e9f67e1b.txt"},619:function(e,t,a){e.exports=a(997)},624:function(e,t,a){},778:function(e,t,a){},901:function(e,t,a){},984:function(e,t,a){},985:function(e,t,a){},992:function(e,t,a){},993:function(e,t,a){},995:function(e,t,a){},997:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(50),i=a.n(s),o=(a(624),a(45)),c=a(44),l=a(57),u=a(56),d=(a(418),a(234)),h=(a(419),a(260)),m=(a(346),a(81)),p=(a(239),a(76)),f=(a(629),a(178)),g=(a(420),a(333)),v=(a(422),a(96)),y=(a(348),a(77)),b=(a(423),a(334)),k=(a(421),a(228)),E=a(153),D=a(95),w=a(135),S=a(39),C=(a(399),a(136)),_=a(80),O=a(222),V=a(128),M=a.n(V),j=a(146),R=a.n(j),A=a(49);var I,x,N=function(e){var t=e.series,a=e.lineGenerator,n=e.xScale,s=e.yScale;return t.map((function(e){var t=e.id,i=e.data,o=e.color,c=e.predicted,l=e.distancing,u={strokeWidth:3};return c&&(u.strokeDasharray=l?"6, 4":"2, 6"),r.a.createElement("path",{key:t,d:a(i.map((function(e){return{x:n(e.data.x),y:s(e.data.y)}}))),fill:"none",stroke:o,style:u})}))},T={axis:{ticks:{text:{fontSize:16}},legend:{text:{fontSize:16}}},legends:{text:{fontSize:14}}},W=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={width:0,height:0},n.updateWindowDimensions=n.updateWindowDimensions.bind(Object(S.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"updateWindowDimensions",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"parseDate",value:function(e){var t=e.split("-").map(Number),a=Object(_.a)(t,3),n=a[0],r=a[1],s=a[2];return new Date(n,r-=1,s)}},{key:"getCumulativeData",value:function(e,t){var a=this;return e.map((function(e){return{x:a.parseDate(e.date),y:e.value/t}}))}},{key:"getDeltaData",value:function(e,t,a){var n=this;return e.map((function(r,s){return 0===s?{x:n.parseDate(r.date),y:(r.value-t)/a}:{x:n.parseDate(r.date),y:(r.value-e[s-1].value)/a}}))}},{key:"processData",value:function(e,t){var a=t.statistic,n=t.yScale,r=t.initialVal,s=t.normalizer,i="delta"===a?this.getDeltaData(e,r,s):this.getCumulativeData(e,s);return"log"===n&&(i=i.filter((function(e){e.x;return e.y>0}))),i}},{key:"getDataMax",value:function(){var e=this.props.data,t=0;return Object.keys(e).forEach((function(a){var n=e[a],r=n.observed,s=n.predictions;t=Math.max(t,Math.max.apply(Math,Object(w.a)(r.map((function(e){return e.value}))))),s.forEach((function(e){var a=e.time_series;t=Math.max(t,Math.max.apply(Math,Object(w.a)(a.map((function(e){return e.value})))))}))})),t}},{key:"getYAxisProps",value:function(){for(var e=this.props,t=e.statistic,a=e.yScale,n={format:function(e){return R()(e).format("0.[0]a")},orient:"left",tickSize:5,tickPadding:5,tickRotation:0,legend:"delta"===t?"New Cases":"Cumulative Cases",legendOffset:-60,legendPosition:"middle"},r=[],s=0;s<=Math.ceil(Math.log10(this.getDataMax()));s++)r.push(Math.pow(10,s));var i=Object(D.a)(Object(D.a)({},n),{},{tickValues:r});return"log"===a?{axisLeft:i,gridYValues:r,yScale:{type:"log",base:10,min:Math.min.apply(Math,r),max:Math.max.apply(Math,r)}}:{axisLeft:n,yScale:{type:"linear",min:"auto",max:"auto"}}}},{key:"render",value:function(){var e=this,t=this.props.data,a=this.props,n=a.statistic,s=a.yScale,i=a.dataType,o=[],c=[];Object.keys(t).sort().forEach((function(a,r){var l=function(e){var t=[A.red,A.gold,A.green,A.blue,A.volcano,A.yellow,A.cyan,A.purple,A.orange,A.lime,A.geekblue,A.magenta];return t[e%t.length]}(r),u=t[a].observed,d=t[a].observed_deaths,h=t[a].normalizer;i.includes("confirmed")&&(o.push({id:a,data:e.processData(u,{statistic:n,yScale:s,initialVal:0,normalizer:h}),predicted:!1}),c.push(l[4])),i.includes("death")&&(o.push({id:"".concat(a," death"),data:e.processData(d,{statistic:n,yScale:s,initialVal:0,normalizer:h}),predicted:!1}),c.push(l[6])),t[a].predictions.filter((function(e){return e.time_series.length>0})).forEach((function(t,r){var m=t.model.name,p="SI-kJalpha"!==m.substring(0,10)||m.includes("death prediction"),f=t.distancing,g=t.time_series,v=[];if(i.includes("death")&&p)v=[d[d.length-1]].concat(g);else{if(!i.includes("confirmed")||p)return;v=[u[u.length-1]].concat(g)}o.push({id:"".concat(a," (").concat(m,", ").concat(f,")"),data:e.processData(v,{statistic:n,yScale:s,initialVal:p?d[d.length-2].value:u[u.length-2].value,normalizer:h}),predicted:!0,distancing:f}),r<=4?c.push(l[4+r]):r<=8?c.push(l[8-r]):c.push(l[r%10])}))}));if(o.length>0){var l=o[0].data[0].x,u=o[0].data[0].x;o.forEach((function(e){e.data.forEach((function(e){var t=e.x;l=Math.min(l,t),u=Math.max(u,t)}))})),l=M()(l),(u=M()(u)).diff(l,"days")>15&&"every month"}var d=1+this.state.width/300;return r.a.createElement(O.a,Object.assign({data:o,colors:c,margin:{top:10,right:50,bottom:70,left:100},xScale:{type:"time",format:"native",precision:"day"},axisBottom:{tickValues:d,format:function(e){return M()(e).format("M/D")},orient:"bottom",tickSize:5,tickPadding:5,tickRotation:0,legend:"Date",legendOffset:36,legendPosition:"middle"}},this.getYAxisProps(),{enableSlices:"x",sliceTooltip:function(e){var t=e.slice;return r.a.createElement("div",{style:{background:"white",padding:"9px 12px",border:"1px solid #ccc"}},r.a.createElement("div",null,M()(t.points[0].data.x).format("MMM Do YYYY")),t.points.map((function(e){return r.a.createElement("div",{key:e.id,style:{color:e.serieColor,padding:"3px 0"}},r.a.createElement("strong",null,e.serieId),"[",R()(e.data.yFormatted).format("0.[0]a"),"]")})))},pointSize:0,pointLabel:"y",pointLabelYOffset:-12,legends:[{anchor:"top-left",direction:"column",justify:!1,translateX:0,translateY:0,itemsSpacing:0,itemDirection:"left-to-right",itemWidth:80,itemHeight:20,itemOpacity:.75,symbolSize:12,symbolShape:"circle",symbolBorderColor:"rgba(0, 0, 0, .5)",effects:[{on:"hover",style:{itemBackground:"rgba(0, 0, 0, .03)",itemOpacity:1}}]}],layers:["grid","markers","areas","crosshair",N,"slices","points","axes","legends"],theme:T}))}}]),a}(n.Component),P=a(1048),L=a(1049),B=a(1050),z=a(1051),F=a(1052),G=a(1044),H=a(86),U=a.n(H),Y="https://dslab-covid19-backend.herokuapp.com/api",K=function(){function e(){Object(o.a)(this,e)}return Object(c.a)(e,[{key:"affected_by",value:function(e){}},{key:"areas",value:function(e){var t="".concat(Y,"/areas");U.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"models",value:function(e){var t="".concat(Y,"/models");U.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"infection_models",value:function(e){var t="".concat(Y,"/infection_models");U.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"death_models",value:function(e){var t="".concat(Y,"/death_models");U.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"cumulative_infections",value:function(e){var t="".concat(Y,"/cumulative_infections");U.a.get(t).then((function(t){return e(t.data)}))}},{key:"predict_all",value:function(e,t){var a="".concat(Y,"/predict_all");U.a.get(a,{params:e}).then((function(e){return t(e.data)}))}},{key:"predict",value:function(e,t){var a="".concat(Y,"/predict");U.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"getCurrentDate",value:function(e){var t="".concat(Y,"/current_date");U.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"checkHistory",value:function(e,t){var a="".concat(Y,"/check_history");U.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"history_cumulative",value:function(e,t){var a="".concat(Y,"/history_cumulative");U.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"scores_all",value:function(e,t){var a="".concat(Y,"/scores_all");U.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"scores",value:function(e,t){var a="".concat(Y,"/scores");U.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"latest_score_date",value:function(e){var t="".concat(Y,"/latest_score_date");U.a.get(t).then((function(t){var a=t.data;e(a)}))}},{key:"cumulative_death",value:function(e,t){var a="".concat(Y,"/cumulative_death");U.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"all_mrf_scores",value:function(e,t){var a="".concat(Y,"/all_mrf_scores");U.a.get(a,{params:e}).then((function(e){t(e.data)}))}},{key:"real_time",value:function(e){U.a.get("https://api.covid19api.com/summary").then((function(t){var a=t.data.Global.TotalConfirmed,n=t.data.Global.TotalDeaths;e({totalConfirmed:a,totalDeaths:n})}))}}]),e}(),J=(a(776),a(315)),X=a.n(J),q=a(316),Z=a.n(q),Q=a(154),$=a.n(Q);function ee(e,t){$.a.parse(e,{download:!0,dynamicTyping:!0,complete:function(e){t(e.data)}})}function te(e,t){return t=e/t,Math.round(t)}function ae(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}ee(X.a,(function(e){I=e})),ee(Z.a,(function(e){x=e}));var ne=function(e){var t=e.caseKey,a=e.deathKey,n=e.data,s=e.center,i=e.caseRadius,o=e.deathRadius,c=e.caseValue,l=e.deathValue,u=e.population,d=e.color,h=e.caseOpacity,m=e.deathOpacity,p=(e.stroke,e.onClick);return r.a.createElement(P.a,{key:a,data:n,center:s,radius:o,fillColor:"black",fillOpacity:m,stroke:!1,onClick:p},r.a.createElement(P.a,{key:t,data:n,center:s,radius:i,color:"white",weight:1.5,fillColor:d,fillOpacity:h,stroke:!0,onClick:p},r.a.createElement(L.a,{direction:"right",opacity:1,sticky:!0},r.a.createElement("b",null,r.a.createElement("span",null,n)),r.a.createElement("br",null),r.a.createElement("span",null,"Cases: "+ae(c)+" (1 in "+ae(te(u,c))+")"),r.a.createElement("br",null),r.a.createElement("span",null,"Deaths: "+ae(l)+" (1 in "+ae(te(u,l))+")"),r.a.createElement("br",null))),r.a.createElement(L.a,{direction:"right",opacity:1,sticky:!0},r.a.createElement("b",null,r.a.createElement("span",null,n)),r.a.createElement("br",null),r.a.createElement("span",null,"Cases: "+ae(c)+" (1 in "+ae(te(u,c))+")"),r.a.createElement("br",null),r.a.createElement("span",null,"Deaths: "+ae(l)+" (1 in "+ae(te(u,l))+")"),r.a.createElement("br",null)))},re=function(e){var t=e.markers.map((function(e){var t=Object.assign({},e);return r.a.createElement(ne,t)}));return r.a.createElement(n.Fragment,null,t)},se=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).modelAPI=new K,e.state={areasList:[],worldCases:[],worldDeaths:[],markers:[],stateMarkers:[],countyMarkers:[],renderStateCountyMarkers:[],us:[],renderUS:[],callbackCounter:0,mapInitialized:!1,zoomlevel:4,prev_zoomlevel:4,height:0,width:0},e.modelAPI.areas((function(t){return e.setState({areasList:t})})),e.updateMarkerSizes=e.updateMarkerSizes.bind(Object(S.a)(e)),e.updateWindowDimensions=e.updateWindowDimensions.bind(Object(S.a)(e)),e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.triggerRef(this),this.fetchData(this.props.dynamicMapOn),this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"updateWindowDimensions",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"setCaseDeathData",value:function(){var e=this;if(this.state.callbackCounter>1){if(this.setState({callbackCounter:0}),this.state.mapInitialized){var t=!1,a=0,n=this.state.markers,r=this.state.stateMarkers,s=this.state.us;for(u=0;u<I.length;u++){var i=this.state.caseData[u].caseValueTrue,o=this.state.deathData[u].deathValueTrue,c=.5;0===i&&(c=0);var l=1;0===o&&(l=0),u<184?155===u?(t=!0,s[0].caseRadius=3*this.getRadius(i,x[u][0]),s[0].caseValue=i,s[0].color=this.getColor(i,x[u][0]),s[0].caseOpacity=c,s[0].deathRadius=.75*this.getRadius(o,x[u][0]),s[0].deathValue=o,s[0].deathOpacity=l):t?(n[u-1].caseRadius=3*this.getRadius(i,x[u][0]),n[u-1].caseValue=i,n[u-1].color=this.getColor(i,x[u][0]),n[u-1].caseOpacity=c,n[u-1].deathRadius=.75*this.getRadius(o,x[u][0]),n[u-1].deathValue=o,n[u-1].deathOpacity=l):(n[u].caseRadius=3*this.getRadius(i,x[u][0]),n[u].caseValue=i,n[u].color=this.getColor(i,x[u][0]),n[u].caseOpacity=c,n[u].deathRadius=.75*this.getRadius(o,x[u][0]),n[u].deathValue=o,n[u].deathOpacity=l):(r[a].caseRadius=3*this.getRadius(i,x[u][0]),r[a].caseValue=i,r[a].color=this.getColor(i,x[u][0]),r[a].caseOpacity=c,r[a].deathRadius=.75*this.getRadius(o,x[u][0]),r[a].deathValue=o,r[a].deathOpacity=l,a++)}this.setState({markers:n,stateMarkers:r,us:s})}else{if(this.setState({mapInitialized:!0}),"undefined"!=typeof this.state.caseData&&"undefined"!=typeof this.state.deathData){for(var u=0;u<I.length;u++){var d=this.state.caseData[u],h=this.state.deathData[u],m=.5;0===d.valueTrue&&(m=0);var p=1;if(0===h.valueTrue&&(p=0),u<184)"US "===this.state.areasList[u].country+" "?(this.state.us.push({key:d.name,caseKey:d.name+"-cases",deathKey:d.name+"-deaths",data:d.name,center:[I[u][1],I[u][2]],caseRadius:3*this.getRadius(d.caseValueTrue,x[u][0]),deathRadius:.75*this.getRadius(h.deathValueTrue,x[u][0]),caseValue:d.caseValueTrue,deathValue:h.deathValueTrue,population:x[u][0],color:this.getColor(d.caseValueTrue,x[u][0]),caseOpacity:m,deathOpacity:p,stroke:!0,onClick:function(t){return e.handleMapClick(t)}}),this.state.renderUS.push(this.state.us[0])):this.state.markers.push({key:d.name,caseKey:d.name+"-cases",deathKey:d.name+"-deaths",data:d.name,center:[I[u][1],I[u][2]],caseRadius:3*this.getRadius(d.caseValueTrue,x[u][0]),deathRadius:.75*this.getRadius(h.deathValueTrue,x[u][0]),caseValue:d.caseValueTrue,deathValue:h.deathValueTrue,population:x[u][0],color:this.getColor(d.caseValueTrue,x[u][0]),caseOpacity:m,deathOpacity:p,stroke:!0,onClick:function(t){return e.handleMapClick(t)}});else this.state.stateMarkers.push({key:d.id,caseKey:d.state+"-cases",deathKey:d.state+"-deaths",data:d.name+" / "+d.state,center:[I[u][1],I[u][2]],caseRadius:3*this.getRadius(d.caseValueTrue),deathRadius:.75*this.getRadius(h.deathValueTrue,x[u][0]),caseValue:d.caseValueTrue,deathValue:h.deathValueTrue,population:x[u][0],color:this.getColor(d.caseValueTrue,x[u][0]),display:"none",caseOpacity:m,deathOpacity:p,stroke:!0,onClick:function(t){return e.handleMapClick(t)}})}var f=this.state.markers,g=this.state.stateMarkers,v=this.state.us;this.setState({markers:f,stateMarkers:g,us:v})}}}}},{key:"getCaseDeathData",value:function(){var e=this;this.modelAPI.cumulative_infections((function(t){var a=t.map((function(e){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,area:e.area,caseValue:Math.log(e.max_percentage),caseValueTrue:e.value}})),n=e.state.callbackCounter;n++,e.setState({caseData:a,callbackCounter:n},e.setCaseDeathData)})),this.modelAPI.cumulative_death({days:0},(function(t){var a=t.map((function(e){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,area:e.area,deathValue:Math.log(e.max_percentage),deathValueTrue:e.value}})),n=e.state.callbackCounter;n++,e.setState({deathData:a,callbackCounter:n},e.setCaseDeathData)}))}},{key:"predictCaseDeathData",value:function(){var e=this;this.modelAPI.predict_all({days:this.props.days,model:this.props.confirmed_model},(function(t){var a=t.map((function(e){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,area:e.area,caseValue:Math.log(e.max_val_percentage),caseValueTrue:e.value}})),n=e.state.callbackCounter;n++,e.setState({caseData:a,callbackCounter:n},e.setCaseDeathData)})),this.modelAPI.predict_all({days:this.props.days,model:this.props.death_model},(function(t){var a=t.map((function(e){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,area:e.area,deathValue:Math.log(e.max_death_percentage),deathValueTrue:e.value}})),n=e.state.callbackCounter;n++,e.setState({deathData:a,callbackCounter:n},e.setCaseDeathData)}))}},{key:"getHistoryCumulative",value:function(){var e=this;this.modelAPI.history_cumulative({days:this.props.days},(function(t){var a=t.map((function(e){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,area:e.area,caseValue:Math.log(e.max_val_percentage),caseValueTrue:e.value,deathValue:Math.log(e.max_death_percentage),deathValueTrue:e.deathValue}})),n=a,r=e.state.callbackCounter;r+=2,e.setState({caseData:a,deathData:n,callbackCounter:r},e.setCaseDeathData)}))}},{key:"newCases",value:function(){var e=this;this.props.days>0?(this.modelAPI.predict_all({days:this.props.days,model:this.props.confirmed_model},(function(t){e.props.days>7?e.modelAPI.predict_all({days:e.props.days-7,model:e.props.confirmed_model},(function(a){var n=t.map((function(e,t){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,area:e.area,caseValue:e.value-a[t].value>0?Math.log(e.value-a[t].value):0,caseValueTrue:e.value-a[t].value>0?e.value-a[t].value:0}})),r=e.state.callbackCounter;r++,e.setState({caseData:n,callbackCounter:r},e.setCaseDeathData)})):e.modelAPI.history_cumulative({days:e.props.days-7},(function(a){var n=t.map((function(e,t){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,area:e.area,caseValue:e.value-a.find((function(t){return t.area.iso_2===e.area.iso_2})).value>0?Math.log(e.value-a.find((function(t){return t.area.iso_2===e.area.iso_2})).value):0,caseValueTrue:e.value-a.find((function(t){return t.area.iso_2===e.area.iso_2})).value>0?e.value-a.find((function(t){return t.area.iso_2===e.area.iso_2})).value:0}})),r=e.state.callbackCounter;r++,e.setState({caseData:n,callbackCounter:r},e.setCaseDeathData)}))})),this.modelAPI.predict_all({days:this.props.days,model:this.props.death_model},(function(t){e.props.days>7?e.modelAPI.predict_all({days:e.props.days-7,model:e.props.death_model},(function(a){var n=t.map((function(e,t){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,deathValue:e.value-a[t].value>0?Math.log(e.value-a[t].value):0,deathValueTrue:e.value-a[t].value>0?e.value-a[t].value:0}})),r=e.state.callbackCounter;r++,e.setState({deathData:n,callbackCounter:r},e.setCaseDeathData)})):e.modelAPI.history_cumulative({days:e.props.days-7},(function(a){var n=t.map((function(e,t){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,deathValue:e.deathValue-a.find((function(t){return t.area.iso_2===e.area.iso_2})).deathValue>0?Math.log(e.deathValue-a.find((function(t){return t.area.iso_2===e.area.iso_2})).deathValue):0,deathValueTrue:e.deathValue-a.find((function(t){return t.area.iso_2===e.area.iso_2})).deathValue>0?e.deathValue-a.find((function(t){return t.area.iso_2===e.area.iso_2})).deathValue:0}})),r=e.state.callbackCounter;r++,e.setState({deathData:n,callbackCounter:r},e.setCaseDeathData)}))}))):this.modelAPI.history_cumulative({days:this.props.days},(function(t){e.modelAPI.history_cumulative({days:e.props.days-7},(function(a){var n=t.map((function(e,t){return{id:e.area.iso_2,name:e.area.country,state:e.area.state,caseValue:e.value-a[t].value>0?Math.log(e.value-a[t].value):0,caseValueTrue:e.value-a[t].value>0?e.value-a[t].value:0,deathValue:e.deathValue-a[t].deathValue>0?Math.log(e.deathValue-a[t].deathValue):0,deathValueTrue:e.deathValue-a[t].deathValue>0?e.deathValue-a[t].deathValue:0}})),r=n,s=e.state.callbackCounter;s+=2,e.setState({caseData:n,deathData:r,callbackCounter:s},e.setCaseDeathData)}))}))}},{key:"fetchData",value:function(e){!e||""===this.props.confirmed_model&&""===this.props.death_model?this.getCaseDeathData():"cumulative"===this.props.statistic?this.props.days>0?this.predictCaseDeathData():this.getHistoryCumulative():this.newCases()}},{key:"handleMapClick",value:function(e){var t=this.props,a=t.onMapClick,n=t.onNoData,r=e.target.options.data;r?a(r):n(r)}},{key:"getRadius",value:function(e,t){if(this.props.perMillion&&(e=1e8*e/t),0===e)return e;var a=this.state.zoomlevel*Math.log(e/1e3)/3;return a<1&&(a=1),a}},{key:"updateMarkerSizes",value:function(){var e,t,a=this.state.zoomlevel/this.state.prev_zoomlevel;for(e=this.state.markers,t=0;t<e.length;t++)e[t].deathRadius=a*e[t].deathRadius,e[t].caseRadius=a*e[t].caseRadius;for(this.setState({markers:e}),e=this.state.stateMarkers,t=0;t<e.length;t++)e[t].deathRadius=a*e[t].deathRadius,e[t].caseRadius=a*e[t].caseRadius;for(this.setState({stateMarkers:e}),e=this.state.us,t=0;t<e.length;t++)e[t].deathRadius=a*e[t].deathRadius,e[t].caseRadius=a*e[t].caseRadius;this.setState({us:e})}},{key:"getColor",value:function(e,t){return this.props.perMillion&&(e=1e7*e/t),(e/=1e4)>100?"#800026":e>50?"#BD0026":e>25?"#E31A1C":e>10?"#FC4E2A":e>5?"#FD8D3C":e>2?"#FEB24C":e>.5?"#FED976":"#FFEDA0"}},{key:"renderUS",value:function(){return r.a.createElement(re,{markers:this.state.us})}},{key:"renderStates",value:function(){return r.a.createElement(re,{markers:this.state.stateMarkers})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(B.a,{style:{height:"65vh",width:"100%"},zoom:4,minZoom:1,center:[37.8,-96],ref:function(t){e.map=t},onzoomend:function(){e.setState({prev_zoomlevel:e.state.zoomlevel}),e.setState({zoomlevel:e.map.leafletElement.getZoom()}),e.updateMarkerSizes()},maxBounds:[[90,-1/0],[-90,1/0]],worldCopyJump:!0},r.a.createElement(z.a,{url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png"}),r.a.createElement(re,{markers:this.state.markers}),r.a.createElement(F.a,{position:"topright"},r.a.createElement(F.a.BaseLayer,{name:"Show US Country"},r.a.createElement(G.a,null,this.renderUS())),r.a.createElement(F.a.BaseLayer,{checked:!0,name:"Show US State"},r.a.createElement(G.a,null,this.renderStates())))))}}]),a}(n.Component);function ie(e){return"".concat(e.country).concat(e.state?" / "+e.state:"")}function oe(e){var t=e.split("/");return{country:t[0].trim(),state:2===t.length?t[1].trim():""}}var ce,le;a(778),a(779);function ue(e){ce=e}function de(e){le=e}function he(e,t){$.a.parse(e,{download:!0,dynamicTyping:!0,complete:function(e){t(e.data)}})}var me=C.a.Option,pe=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).handleYScaleSelect=function(e){console.log(e),n.setState({yScale:e.target.value})},n.handleStatisticSelect=function(e){n.setState({statistic:e.target.value},(function(){n.map.fetchData(n.state.dynamicMapOn)}))},n.handleDataTypeSelect=function(e){console.log(e),n.setState({dataType:e})},n.handleMapShownSelect=function(e){n.setState({mapShown:e.target.value},(function(){n.map.fetchData(n.state.dynamicMapOn)}))},n.componentWillMount=function(){n.addAreaByStr("US"),n.state.plainareas.length<1&&n.loadAreaNames(),window.removeEventListener("resize",n.updateWindowDimensions),n.formRef=r.a.createRef(),n.modelAPI=new K,n.modelAPI.areas((function(e){return n.setState({areasList:e})})),n.modelAPI.infection_models((function(e){return n.setState({modelsList:e},(function(){n.modelAPI.death_models((function(e){for(var t=function(t){n.setState((function(a){return{modelsList:[].concat(Object(w.a)(a.modelsList),[e[t]])}}))},a=6;a<e.length;++a)t(a)}))}))})),n.modelAPI.getCurrentDate((function(e){return n.setState({currentDate:e[0].date,firstDate:e[0].firstDate})})),n.modelAPI.real_time((function(e){n.setState({totalConfirmed:e.totalConfirmed,totalDeaths:e.totalDeaths})}))},n.bindRef=function(e){n.map=e},n.onAlertClose=function(){n.setState({noDataError:!1})},n.onNoData=function(e){n.setState({noDataError:!0,errorDescription:"There is currently no data for ".concat(e)})},n.generateMarks=function(){var e=n.state,t=e.currentDate,a=e.days,r=e.firstDate,s=new Date("".concat(t,"T00:00")),i=new Date("".concat(r,"T00:00"));s.setDate(s.getDate(Date)+a);var o={};o[a]="".concat(s.getMonth()+1,"/").concat(s.getDate());for(var c=a+7,l=1,u=1+Math.floor(2e3/n.state.width);c<a+50&&c<=99;)s.setDate(s.getDate()+7),o[c]=l%u?"":"".concat(s.getMonth()+1,"/").concat(s.getDate()),c+=7,l+=1;for((s=new Date("".concat(t,"T00:00"))).setDate(s.getDate(Date)+a),s.setDate(s.getDate()-7),c=a-7,l=1;s>=i&&c>a-30;)o[c]=l%u?"":"".concat(s.getMonth()+1,"/").concat(s.getDate()),s.setDate(s.getDate()-7),c-=7,l+=1;return o},n.getDaysToFirstDate=function(){var e=n.state,t=e.currentDate,a=e.firstDate,r=new Date("".concat(t,"T00:00")),s=new Date("".concat(a,"T00:00"));return Math.ceil(Math.abs(r-s)/864e5)},n.toggleControlInstructions=function(){var e=n.state.showControlInstructions;n.setState({showControlInstructions:!e})},n.toggleMapInstructions=function(){var e=n.state.showMapInstructions;n.setState({showMapInstructions:!e})},n.state={areas:n.props.areas||[],areasList:[],plainareas:[],all_populations:[],models:n.props.models||["SI-kJalpha - Default"],modelsList:[],currentDate:"",firstDate:"",current:!0,worst_effort:!1,best_effort:!1,mainGraphData:{},days:14,dynamicMapOn:!0,perMillion:!1,dataType:["confirmed"],statistic:"cumulative",mapShown:"confirmed",yScale:"linear",noDataError:!1,errorDescription:"",showControlInstructions:!1,showMapInstructions:!1,totalConfirmed:0,totalDeaths:0,width:0,height:0},n.addAreaByStr=n.addAreaByStr.bind(Object(S.a)(n)),n.loadAreaNames=n.loadAreaNames.bind(Object(S.a)(n)),n.removeAreaByStr=n.removeAreaByStr.bind(Object(S.a)(n)),n.onValuesChange=n.onValuesChange.bind(Object(S.a)(n)),n.onMapClick=n.onMapClick.bind(Object(S.a)(n)),n.onDaysToPredictChange=n.onDaysToPredictChange.bind(Object(S.a)(n)),n.switchDynamicMap=n.switchDynamicMap.bind(Object(S.a)(n)),n.switchPerMillion=n.switchPerMillion.bind(Object(S.a)(n)),n.onAlertClose=n.onAlertClose.bind(Object(S.a)(n)),n.onNoData=n.onNoData.bind(Object(S.a)(n)),n.generateMarks=n.generateMarks.bind(Object(S.a)(n)),n.handleDataTypeSelect=n.handleDataTypeSelect.bind(Object(S.a)(n)),n.handleStatisticSelect=n.handleStatisticSelect.bind(Object(S.a)(n)),n.handleYScaleSelect=n.handleYScaleSelect.bind(Object(S.a)(n)),n.toggleControlInstructions=n.toggleControlInstructions.bind(Object(S.a)(n)),n.toggleMapInstructions=n.toggleMapInstructions.bind(Object(S.a)(n)),n.updateWindowDimensions=n.updateWindowDimensions.bind(Object(S.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions),this.state.plainareas.length<1&&this.loadAreaNames()}},{key:"updateWindowDimensions",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"loadAreaNames",value:function(){var e,t=this,a=[];if(he(X.a,ue),he(Z.a,de),"undefined"!==typeof ce){for(e=0;e<ce.length;e++)a[e]=ce[e][0];this.setState({plainareas:a},(function(){t.reloadAll()})),this.setState({all_populations:le})}}},{key:"onMapClick",value:function(e){this.areaIsSelected(e)||this.addAreaByStr(e)}},{key:"areaIsSelected",value:function(e){return!(!this.state.areas||!e)&&this.state.areas.includes(e)}},{key:"addAreaByStr",value:function(e){var t=this,a=oe(e),n=this.state.plainareas.indexOf(a.state);-1==n&&(n=this.state.plainareas.indexOf(a.country));var r=1;n>-1&&this.state.perMillion&&(r=this.state.all_populations[n]/1e6),this.setState((function(t){return{areas:[].concat(Object(w.a)(t.areas),[e])}}),(function(){t.state.days>=0?t.modelAPI.predict({state:a.state,country:a.country,models:t.state.models,days:t.state.days,current:t.state.current,worst_effort:t.state.worst_effort,best_effort:t.state.best_effort},(function(a){var n=a;n.normalizer=r,t.setState((function(t){return{mainGraphData:Object(D.a)(Object(D.a)({},t.mainGraphData),{},Object(E.a)({},e,n))}}))})):t.modelAPI.checkHistory({state:a.state,country:a.country,days:t.state.days},(function(a){var n=a;n.normalizer=r,t.setState((function(t){return{mainGraphData:Object(D.a)(Object(D.a)({},t.mainGraphData),{},Object(E.a)({},e,n))}}))})),null!=t.formRef.current&&t.formRef.current.setFieldsValue({areas:t.state.areas})}))}},{key:"removeAreaByStr",value:function(e){this.setState((function(t){return{areas:t.areas.filter((function(t){return t!==e})),mainGraphData:Object.keys(t.mainGraphData).filter((function(t){return t!==e})).reduce((function(e,a){return Object(D.a)(Object(D.a)({},e),{},Object(E.a)({},a,t.mainGraphData[a]))}),{})}}))}},{key:"modelIsSelected",value:function(e){if(this.state.models&&e){var t="".concat(e.name);return this.state.models.includes(t)}return!1}},{key:"onValuesChange",value:function(e,t){var a=this;this.state.dataType;if("socialDistancing"in e&&this.setState({current:t.socialDistancing.includes("current"),worst_effort:t.socialDistancing.includes("worst_effort"),best_effort:t.socialDistancing.includes("best_effort")},(function(){a.reloadAll()})),"models"in e)this.setState({models:e.models},(function(){a.reloadAll()}));else{var n=this.state.areas,r=t.areas,s=r.filter((function(e){return!n.includes(e)})),i=n.filter((function(e){return!r.includes(e)}));s.forEach(this.addAreaByStr),i.forEach(this.removeAreaByStr)}}},{key:"onDaysToPredictChange",value:function(e){var t=this;this.state.areas;this.setState({days:e},(function(){t.reloadAll()}))}},{key:"reloadAll",value:function(){var e=this,t=this.state.areas;this.setState({areas:[],mainGraphData:{}},(function(){e.state.plainareas.length<1&&e.loadAreaNames(),t.forEach(e.addAreaByStr),e.state.dynamicMapOn&&0!==e.state.models.length&&e.map.fetchData(e.state.dynamicMapOn)}))}},{key:"switchDynamicMap",value:function(e){this.setState({dynamicMapOn:e}),this.map.fetchData(e)}},{key:"switchPerMillion",value:function(e){var t=this;this.setState({perMillion:e},(function(){t.reloadAll()})),this.map.fetchData(this.state.dynamicMapOn)}},{key:"render",value:function(){var e=this,t=this.state,a=t.areas,n=t.areasList,s=t.models,i=t.modelsList,o=t.days,c=t.mainGraphData,l=t.dynamicMapOn,u=t.perMillion,E=t.dataType,D=t.statistic,w=t.mapShown,S=t.yScale,_=t.noDataError,O=t.errorDescription,V=this.generateMarks(),M=this.getDaysToFirstDate(),j=n.filter((function(t){return!e.areaIsSelected(t)})).map(ie).sort().map((function(e){return r.a.createElement(me,{key:e}," ",e," ")})),R=i.filter((function(t){return!e.modelIsSelected(t)})).map((function(e){return r.a.createElement(me,{key:e.name,value:e.name},r.a.createElement(k.a,{title:e.description,placement:"right"},e.name))})),A={area:r.a.createElement("p",{className:"instruction"},"Select the areas by clicking on the map or searching in this input box."),model:r.a.createElement("div",{className:"instruction"},r.a.createElement("p",{className:"instruction"},'"SI-kJalpha - 20x " assumes that the true positive cases are 20 times the current reported cases. "SI-kJalpha-Default" is our best guess.')),date:r.a.createElement("p",{className:"instruction"},"Predictions up to the date selected will be shown."),socialDistancing:r.a.createElement("p",{className:"instruction"},"Compare different social distancing scenarios."),data_type:r.a.createElement("p",{className:"instruction"},"Select the forecasts for cumulative infections or/and deaths."),statistics:r.a.createElement("p",{className:"instruction"},"Switch between cumulative view and incident view."),scale:r.a.createElement("p",{className:"instruction"},"Switch between linear view and logarithmic view.")},I={perMillionView:r.a.createElement("p",{className:"instruction vertical"},"Turn on to see all the plot and the bubbles based on per million population of the region."),selectMap:r.a.createElement("p",{className:"instruction vertical"},"Hover over the bubbles to see case and death data. Select to add to the plot. Button on the top right to toggle between US states and the country."),dynamicMap:r.a.createElement("p",{className:"instruction vertical"},"Enable the map to dynamically change to reflect the data and predictions based on the selected options. Turn off if the interface seems slow."),radioGroup:r.a.createElement("p",{className:"instruction vertical"},"Switch between cumulative infection view or death view on the heatmap.")},x="";if(0!=this.state.totalConfirmed&&0!=this.state.totalDeaths){var N=new Date,T=String(N.getDate()).padStart(2,"0");x="By "+String(N.getMonth()+1).padStart(2,"0")+"/"+T+"/"+N.getFullYear()+", "+this.state.totalConfirmed.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" people around the world have been tested positive, and "+this.state.totalDeaths.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" people have died of COVID-19."}for(var P="",L="",B=s.length-1;B>=0;B--){if("SI-kJalpha"===s[B].substring(0,10)){P=s[B],0===L.length&&(L=s[B]+" (death prediction)");break}L=s[B]}var z=r.a.createElement("div",{id:"header",className:"text-center"},r.a.createElement("div",{id:"overview"},r.a.createElement("b",null,x)));return r.a.createElement("div",{className:"covid-19-predict"},z,r.a.createElement("div",null,r.a.createElement(p.a,{type:"flex",justify:"center",id:"charts"},_?r.a.createElement(b.a,{message:"".concat(O),description:"Please wait for our updates.",type:"error",closable:!0,onClose:this.onAlertClose}):null,r.a.createElement("div",{className:"form-column"},r.a.createElement("div",null,r.a.createElement("div",{className:"form-wrapper gray",id:"graph_options"},r.a.createElement(y.a,{ref:this.formRef,onValuesChange:this.onValuesChange,initialValues:{areas:a,models:s,days:14,socialDistancing:["current"]}},r.a.createElement(v.a,{content:A.area,placement:"top",visible:this.state.showControlInstructions},r.a.createElement(y.a.Item,{style:{marginBottom:"0px"},label:"Areas",name:"areas",rules:[{required:!0,message:"Please select areas!"}]},r.a.createElement(C.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select Areas"},j))),r.a.createElement(v.a,{content:A.model,placement:"rightTop",visible:this.state.showControlInstructions,align:{overflow:{adjustX:!1,adjustY:!1}}},r.a.createElement(y.a.Item,{style:{marginBottom:"0px"},label:"Models:",name:"models",rules:[{required:!0,message:"Please select a prediction model!"}]},r.a.createElement(C.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select Prediction Models"},R))),r.a.createElement(v.a,{placement:"rightBottom",content:A.date,visible:this.state.showControlInstructions},r.a.createElement(y.a.Item,{label:"Date to Predict",name:"days"},r.a.createElement(g.a,{marks:V,min:o-30>=-M?o-30:-M,initialValue:o,max:o+50<=99?o+50:99,onAfterChange:this.onDaysToPredictChange,step:null,tooltipVisible:!1}))),r.a.createElement(v.a,{content:A.socialDistancing,placement:"right",visible:this.state.showControlInstructions},r.a.createElement(y.a.Item,{label:"Social Distancing",name:"socialDistancing",style:{marginBottom:"0px"}},r.a.createElement(f.a.Group,{style:{width:"100%"}},r.a.createElement(p.a,null,r.a.createElement(f.a,{defaultChecked:!0,value:"current"},"Current Trend"),r.a.createElement(f.a,{value:"worst_effort"},"Worst Distancing Effort"),r.a.createElement(f.a,{value:"best_effort"},"Best Distancing Effort")))))),r.a.createElement(y.a,null,r.a.createElement(v.a,{content:A.data_type,placement:"right",visible:this.state.showControlInstructions},r.a.createElement(y.a.Item,{label:"Data Types",style:{marginBottom:"0px"}},r.a.createElement(f.a.Group,{value:E,onChange:this.handleDataTypeSelect},r.a.createElement(f.a,{defaultChecked:!0,value:"confirmed"},"Confirmed Cases"),r.a.createElement(f.a,{value:"death"},"Deaths")))),r.a.createElement(v.a,{content:A.statistics,placement:"right",visible:this.state.showControlInstructions},r.a.createElement(y.a.Item,{label:"Statistic",style:{marginBottom:"0px"}},r.a.createElement(m.a.Group,{value:D,onChange:this.handleStatisticSelect},r.a.createElement(m.a,{value:"cumulative"},"Cumulative Cases"),r.a.createElement(m.a,{value:"delta"},"New Cases")))),r.a.createElement(v.a,{content:A.scale,placement:"right",visible:this.state.showControlInstructions},r.a.createElement(y.a.Item,{label:"Scale",style:{marginBottom:"0px"}},r.a.createElement(m.a.Group,{value:S,onChange:this.handleYScaleSelect},r.a.createElement(m.a,{value:"linear"},"Linear"),r.a.createElement(m.a,{value:"log"},"Logarithmic"))))))),a.length?r.a.createElement("div",null,r.a.createElement("div",{className:"graph-wrapper"},r.a.createElement(W,{data:c,perMillion:u,dataType:E,onNoData:this.onNoData,statistic:D,yScale:S}))):null),r.a.createElement("div",{className:"map-column"},r.a.createElement("div",{className:"form-wrapper gray",id:"graph_options"},r.a.createElement("div",null,r.a.createElement("span",{className:"map-control"},r.a.createElement("table",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(v.a,{content:I.dynamicMap,placement:"bottom",visible:this.state.showMapInstructions},r.a.createElement(h.a,{defaultChecked:!0,onChange:this.switchDynamicMap}),r.a.createElement("b",null,"\xa0\xa0Dynamic Map\xa0\xa0"))),r.a.createElement("td",null,r.a.createElement(v.a,{content:I.perMillionView,placement:"top",visible:this.state.showMapInstructions},"\xa0\xa0\xa0",r.a.createElement(h.a,{onChange:this.switchPerMillion}),r.a.createElement("b",null,"\xa0\xa0Data/Million Population \xa0\xa0")))))))),r.a.createElement("div",null,r.a.createElement("div",{className:"map-wrapper"},r.a.createElement(v.a,{content:I.selectMap,placement:"leftBottom",visible:this.state.showMapInstructions},r.a.createElement(se,{className:"map",triggerRef:this.bindRef,dynamicMapOn:l,perMillion:u,days:o,confirmed_model:P,death_model:L,onMapClick:this.onMapClick,onNoData:this.onNoData,statistic:D,dataType:w})))),r.a.createElement("div",null,r.a.createElement("div",{className:"instruction-buttons-wrapper"},r.a.createElement(d.a,{className:"instruction-button",onClick:this.toggleControlInstructions},0==this.state.showControlInstructions?"Help with controls":"Close control instructions"),r.a.createElement(d.a,{className:"instruction-button",onClick:this.toggleMapInstructions},0==this.state.showMapInstructions?"Help with the map":"Close map instructions")))))))}}]),a}(n.PureComponent),fe=(a(901),a(290),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"page-wrapper"},r.a.createElement("div",{className:"article"},r.a.createElement("h1",{className:"article-title"},"ReCOVER: Accurate Predictions and Resource Management for COVID-19 Epidemic Response"),r.a.createElement("p",{className:"article-paragraph"},"Accurate forecasts of COVID-19 is central to resource management and building strategies to deal with the epidemic. This is an NSF-funded project on COVID-19 forecasting led by by ",r.a.createElement("a",{className:"article-anchor",href:"https://sites.usc.edu/prasanna/"}," Viktor K. Prasanna ")," and ",r.a.createElement("a",{className:"article-anchor",href:"http://www-scf.usc.edu/~ajiteshs/"}," Ajitesh Srivastava "),"from the ",r.a.createElement("a",{className:"article-anchor",href:"https://dslab.usc.edu/"}," Data Science Lab ")," at the University of Southern California."),r.a.createElement("h2",null,"Our Approach"),r.a.createElement("p",{className:"article-paragraph"},"We use our own epidemic model called ",r.a.createElement("a",{className:"article-anchor",href:"https://arxiv.org/abs/2007.05180"}," SI-kJalpha"),", preliminary version of which we have successfully used during ",r.a.createElement("a",{className:"article-anchor",href:"https://news.usc.edu/83180/usc-engineers-earn-national-recognition-for-predicting-disease-outbreaks/",target:"_blank"},"DARPA Grand Challenge 2014"),". Our forecast appears on the official ",r.a.createElement("a",{className:"article-anchor",href:"https://www.cdc.gov/coronavirus/2019-ncov/covid-data/forecasting-us.html"}," CDC webpage"),". Our model can consider the effect of many complexities of the epidemic process and yet be simplified to a few parameters that are learned using fast linear regressions. Therefore, our approach can learn and generate forecasts extremely quickly. On a 2 core desktop machine, our approach takes only 3.18s to tune hyper-parameters, learn parameters and generate 100 days of forecasts of reported cases and deaths for all the states in the US. The total execution time for 184 countries is 11.83s and for more than 3000 US counties is 101.03s. Despite being fast, the accuracy of our forecasts is on par with the state-of-the-art as demonstrated on the ",r.a.createElement("a",{className:"article-anchor",href:"https://scc-usc.github.io/ReCOVER-COVID-19/#/leaderboard"}," leaderboard page"),". Details of modeling and comparisons can be found in ",r.a.createElement("a",{className:"article-anchor",href:"https://arxiv.org/abs/2007.05180"}," our paper"),". This work is supported by National Science Foundation Award No. 2027007 (RAPID)"),r.a.createElement("p",{className:"article-paragraph"},"The ",r.a.createElement("a",{className:"article-anchor",href:"https://github.com/scc-usc/ReCOVER-COVID-19",target:"_blank"}," Github repository ")," for this project is publicly available."),r.a.createElement("p",{className:"article-paragraph"},"The matlab code for forecasting is also made available on ",r.a.createElement("a",{className:"article-anchor",href:"https://www.mathworks.com/matlabcentral/fileexchange/75281-recover",target:"_blank"},"File Exchange"),". For the latest code, please see the Github repo."),r.a.createElement("p",{className:"article-paragraph"}," The code of the prediction model and this web application is contributed by Ajitesh Srivastava, Jamin Chen, Frost Tianjian Xu, and Bob Xiaochen Yang. "),r.a.createElement("p",{className:"article-paragraph"}," The forecast visualization is further implemented by James Orme-Rogers, James Wolfe, Sung Bin Kim, and Vicky Yu. "),r.a.createElement("h2",null,"Related Papers"),r.a.createElement("ol",{className:"article-paragraph"},r.a.createElement("li",null,"Ajitesh Srivastava, Tianjian Xu and Viktor K. Prasanna,",r.a.createElement("a",{className:"article-anchor",href:"https://arxiv.org/abs/2007.05180",target:"_blank"},' "Fast and Accurate Forecasting of COVID-19 Deaths using the SIkJalpha Model"')," [arXiv]."),r.a.createElement("li",null,"Ajitesh Srivastava and Viktor K. Prasanna,",r.a.createElement("a",{className:"article-anchor",href:"https://arxiv.org/abs/2006.02127",target:"_blank"},' "Data-driven Identification of Number of Unreported Cases for COVID-19: Bounds and Limitations"')," [arXiv]. Accepted at KDD 2020."),r.a.createElement("li",null,"Ajitesh Srivastava and Viktor K. Prasanna,",r.a.createElement("a",{className:"article-anchor",href:"https://arxiv.org/abs/2004.11372",target:"_blank"},' "Learning to Forecast and Forecasting to Learn from the COVID-19 Pandemic"')," [arXiv].")),r.a.createElement("h2",null,"Other Links"),r.a.createElement("ol",{className:"article-paragraph"},r.a.createElement("li",null,r.a.createElement("a",{className:"article-anchor",href:"https://www.youtube.com/watch?v=dBye3euqlKc",target:"_blank"}," Lightning talk ")," presenting the status (October)."),r.a.createElement("li",null,r.a.createElement("a",{className:"article-anchor",href:"https://www.youtube.com/watch?v=ll6k8wlxOFo",target:"_blank"},"Webinar ")," describing our intial approach (April).")),r.a.createElement("h2",null,"USC Data Science Lab"),r.a.createElement("p",{className:"article-paragraph"},"The USC Data Science Lab focuses on applying machine learning, data mining, and network analysis to real-world problems in society and industry. Please find more information and other research projects ",r.a.createElement("a",{className:"article-anchor",href:"https://sites.usc.edu/dslab/",target:"_blank"}," on our website"),".")))}}]),a}(n.Component)),ge=(a(502),a(195));var ve=function(e){var t=e.series,a=e.lineGenerator,n=e.xScale,s=e.yScale;return t.map((function(e){var t=e.id,i=e.data,o=e.color,c=e.predicted,l=e.distancing,u={strokeWidth:5};return c&&(u.strokeDasharray=l?"6, 4":"2, 6"),r.a.createElement("path",{key:t,d:a(i.map((function(e){return{x:n(e.data.x),y:s(e.data.y)}}))),fill:"none",stroke:o,style:u})}))},ye={axis:{ticks:{text:{fontSize:18}},legend:{text:{fontSize:18}}},legends:{text:{fontSize:18}}},be=(n.Component,a(110));var ke=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).parseData=function(e,t){var a=Object.keys(e)[0];if(e[a])return"reproduction"===t?e[a].observed_rt.map((function(t,a){var n={name:t.date.split("-")[1]+"/"+t.date.split("-")[2]};n[Object.keys(e)[0]]=t.value,n["error".concat(Object.keys(e)[0])]=t.conf;for(var r=1;r<Object.keys(e).length;++r)n[Object.keys(e)[r]]=e[Object.keys(e)[r]].observed_rt[a].value,n["error".concat(Object.keys(e)[r])]=e[Object.keys(e)[r]].observed_rt[a].conf;return n})):e[a].observed_mrf.map((function(t,a){var n={name:t.date.split("-")[1]+"/"+t.date.split("-")[2]};n[Object.keys(e)[0]]=t.value,n["error".concat(Object.keys(e)[0])]=t.conf;for(var r=1;r<Object.keys(e).length;++r)n[Object.keys(e)[r]]=e[Object.keys(e)[r]].observed_mrf[a].value,n["error".concat(Object.keys(e)[r])]=e[Object.keys(e)[r]].observed_mrf[a].conf;return n}))},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.date,n=e.scoreType,s=this.parseData(t,n),i=Object.keys(t),o=[];i.map((function(e,t){var a=function(e){var t=[A.red,A.gold,A.lime,A.cyan,A.geekblue,A.purple,A.magenta];return t[e%t.length]}(t);return o.push(a),0}));for(var c=[],l=0;l<i.length;++l)c.push(r.a.createElement(be.e,{type:"monotone",key:l,dataKey:i[l],stroke:o[l][3],strokeWidth:5},r.a.createElement(be.b,{dataKey:"error".concat(i[l]),width:15,strokeWidth:2,stroke:o[l][6],direction:"y"})));return r.a.createElement(be.f,{width:1400,height:300,data:s,margin:{top:40,right:30,left:40,bottom:5}},r.a.createElement(be.a,{strokeDasharray:"3 3"}),r.a.createElement(be.i,{dataKey:"name"}),r.a.createElement(be.j,null,"reproduction"===n?r.a.createElement(be.c,{value:"Dynamic Reproduction Number",dy:90,position:"insideLeft",angle:-90,fontSize:15}):r.a.createElement(be.c,{value:"MFR Score",dy:45,position:"insideLeft",angle:-90,fontSize:15})),r.a.createElement(be.h,null),r.a.createElement(be.g,{x:a,stroke:"green",strokeWidth:5,fontSize:20,label:{position:"top",value:"selected date",fill:"green",fontSize:15},strokeDasharray:"10 10"}),"reproduction"===n?r.a.createElement(be.g,{y:1,stroke:"SandyBrown",strokeWidth:5,strokeDasharray:"3 3",label:{position:"left",value:"",fill:"red",fontSize:20}}):null,r.a.createElement(be.d,{iconSize:40}),c)}}]),a}(n.Component),Ee=a(118),De=a(236),we=a(552),Se=a(553),Ce=a(557);Ee.e(Ce.a);var _e=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).onShowState=function(t){e.setState({showState:t})},e.modelAPI=new K,e.state={areasList:[],showState:!1,worldSeries:{},usaSeries:{}},e.modelAPI.areas((function(t){return e.setState({areasList:t})})),e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.triggerRef(this)}},{key:"fetchData",value:function(){var e=this,t=arguments,a=this.props.scoreType;t[0]?"reproduction"===a?this.modelAPI.scores_all({weeks:this.props.weeks},(function(a){var n=a.map((function(e){return{id:e.area.iso_2,value:e.value>0?e.value:0,area:e.area}}));t[1]?e.setState({heatmapData:n},e.initChart):e.setState({heatmapData:n},e.updateChart)})):this.modelAPI.all_mrf_scores({weeks:this.props.weeks},(function(a){var n=a.map((function(e){return{id:e.area.iso_2,value:e.value>0?e.value:0,area:e.area}}));t[1]?e.setState({heatmapData:n},e.initChart):e.setState({heatmapData:n},e.updateChart)})):"reproduction"===a?this.modelAPI.scores_all({weeks:this.props.latestWeek},(function(t){var a=t.map((function(e){return{id:e.area.iso_2,value:e.value>0?e.value:0,area:e.area,conf:e.conf}}));e.setState({heatmapData:a},e.initChart)})):this.modelAPI.all_mrf_scores({weeks:this.props.latestWeek},(function(t){var a=t.map((function(e){return{id:e.area.iso_2,value:e.value>0?e.value:0,area:e.area,conf:e.conf}}));e.setState({heatmapData:a},e.initChart)}))}},{key:"initChart",value:function(){this.chart=Ee.d("chartdiv",De.a),this.chart.projection=new De.d.Mercator;var e=this.chart.series.push(new De.b);e=this.createChartSeries(e,{geodata:we.a,exclude:["AQ"],data:this.state.heatmapData});var t=this.chart.series.push(new De.b);t=this.createChartSeries(t,{geodata:Se.a,data:this.state.heatmapData,disabled:!this.state.showState}),this.stateSeries=[t],this.initChartInterface(),this.setState({worldSeries:e,usaSeries:t})}},{key:"updateChart",value:function(){var e=this.state.worldSeries,t=this.state.usaSeries;e.data=this.state.heatmapData,t.data=this.state.heatmapData}},{key:"createChartSeries",value:function(e,t){var a=this.props.scoreType,n=(e=Object.assign(e,t)).mapPolygons.template;"reproduction"===a?e.heatRules.push({property:"fill",target:n,min:Ee.c("#85DB50"),max:Ee.c("#F33A21"),minValue:0,maxValue:4}):e.heatRules.push({property:"fill",target:n,min:Ee.c("#85DB50"),max:Ee.c("#F33A21"),minValue:0,maxValue:.4}),n.tooltipText="{name}: {value}",n.nonScalingStroke=!0,n.strokeWidth=.5,n.states.create("hover").properties.fill=Ee.c("#83FE00"),n.cursorOverStyle=Ee.b.pointer;var r=this.props,s=r.onMapClick,i=r.onNoData;return n.events.on("hit",(function(e){var t=e.target.dataItem.dataContext,a=(t.id,t.value,t.area),n=t.name;a?s(a):i(n)})),e}},{key:"initChartInterface",value:function(){var e=this,t=this.state.showState;this.chart.zoomControl=new De.c,this.chart.zoomControl.cursorOverStyle=Ee.b.pointer;var a=this.chart.chartContainer.createChild(Ee.a);a.label.text="".concat(t?"Hide":"Show"," States/Provinces"),a.togglable=!0,a.padding(5,5,5,5),a.align="right",a.marginRight=15,a.cursorOverStyle=Ee.b.pointer,a.events.on("hit",(function(){e.onShowState(a.isActive);var t=e.state.showState;e.stateSeries.forEach((function(e){return e.disabled=!t})),a.label.text="".concat(t?"Hide":"Show"," States/Provinces")}))}},{key:"componentWillUnmount",value:function(){this.chart&&this.chart.dispose()}},{key:"render",value:function(){return r.a.createElement("div",{id:"chartdiv"})}}]),a}(n.Component),Oe=(a(984),C.a.Option),Ve=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){n.formRef=r.a.createRef(),n.modelAPI=new K,n.modelAPI.latest_score_date((function(e){return n.setState({latestDate:e[0].date,weeks:e[0].weeks,latestWeek:e[0].weeks,firstDate:e[0].firstDate},(function(){n.addAreaByStr("US"),n.formRef.current.setFieldsValue({weeks:n.state.latestWeek}),n.map.fetchData(n.state.dynamicMapOn)}))})),n.modelAPI.areas((function(e){return n.setState({areasList:e})}))},n.bindRef=function(e){n.map=e},n.onAlertClose=function(){n.setState({noDataError:!1})},n.onNoData=function(e){n.setState({noDataError:!0,errorDescription:"There is currently no data for ".concat(e)})},n.generateMarks=function(){var e=n.state,t=e.weeks,a=(e.lastDate,e.latestWeek),r=e.firstDate,s=new Date("".concat(r,"T00:00"));s.setDate(s.getDate(Date)+7*t);for(var i={},o=0;o<=5&&t+o<=a;)i[t+o]="".concat(s.getMonth()+1,"/").concat(s.getDate()),s.setDate(s.getDate(Date)+7),o++;for(o=1,(s=new Date("".concat(r,"T00:00"))).setDate(s.getDate(Date)+7*(t-1));o<=5&&t-o>=0;)i[t-o]="".concat(s.getMonth()+1,"/").concat(s.getDate()),s.setDate(s.getDate(Date)-7),o++;return(s=new Date("".concat(r,"T00:00"))).setDate(s.getDate(Date)+7*t),[s,i]},n.handleScoreTypeSelect=function(e){n.setState({scoreType:e.target.value},(function(){n.map.fetchData(n.state.dynamicMapOn,!0)}))},n.state={areas:n.props.areas||[],areasList:[],latestDate:"",firstDate:"",mainGraphData:{},weeks:n.props.weeks||0,latestWeek:0,dynamicMapOn:!1,noDataError:!1,errorDescription:"",scoreType:"reproduction"},n.addAreaByStr=n.addAreaByStr.bind(Object(S.a)(n)),n.removeAreaByStr=n.removeAreaByStr.bind(Object(S.a)(n)),n.onValuesChange=n.onValuesChange.bind(Object(S.a)(n)),n.onMapClick=n.onMapClick.bind(Object(S.a)(n)),n.onWeeksChange=n.onWeeksChange.bind(Object(S.a)(n)),n.switchDynamicMap=n.switchDynamicMap.bind(Object(S.a)(n)),n.onAlertClose=n.onAlertClose.bind(Object(S.a)(n)),n.onNoData=n.onNoData.bind(Object(S.a)(n)),n.generateMarks=n.generateMarks.bind(Object(S.a)(n)),n.handleScoreTypeSelect=n.handleScoreTypeSelect.bind(Object(S.a)(n)),n}return Object(c.a)(a,[{key:"onMapClick",value:function(e){this.areaIsSelected(e)||this.addAreaByStr(ie(e))}},{key:"areaIsSelected",value:function(e){if(this.state.areas&&e){var t=ie(e);return this.state.areas.includes(t)}return!1}},{key:"addAreaByStr",value:function(e){var t=this,a=oe(e);this.setState((function(t){return{areas:[].concat(Object(w.a)(t.areas),[e])}}),(function(){t.modelAPI.scores({state:a.state,country:a.country,weeks:t.state.latestWeek},(function(a){t.setState((function(t){return{mainGraphData:Object(D.a)({},t.mainGraphData,Object(E.a)({},e,a))}}))})),t.formRef.current.setFieldsValue({areas:t.state.areas})}))}},{key:"removeAreaByStr",value:function(e){this.setState((function(t){return{areas:t.areas.filter((function(t){return t!==e})),mainGraphData:Object.keys(t.mainGraphData).filter((function(t){return t!==e})).reduce((function(e,a){return Object(D.a)({},e,Object(E.a)({},a,t.mainGraphData[a]))}),{})}}))}},{key:"onValuesChange",value:function(e,t){var a=this.state.areas,n=t.areas;if(n&&a){var r=n.filter((function(e){return!a.includes(e)})),s=a.filter((function(e){return!n.includes(e)}));r.forEach(this.addAreaByStr),s.forEach(this.removeAreaByStr)}}},{key:"onWeeksChange",value:function(e){var t=this;this.setState({weeks:e},(function(){t.state.dynamicMapOn&&t.map.fetchData(t.state.dynamicMapOn)}))}},{key:"switchDynamicMap",value:function(e){this.setState({dynamicMapOn:e}),this.map.fetchData(e)}},{key:"render",value:function(){var e=this,t=this.state,a=t.areas,n=t.areasList,s=t.weeks,i=t.mainGraphData,o=t.dynamicMapOn,c=t.latestWeek,l=t.noDataError,u=t.errorDescription,d=t.scoreType,f=n.filter((function(t){return!e.areaIsSelected(t)})).map(ie).sort().map((function(e){return r.a.createElement(Oe,{key:e}," ",e," ")})),v=this.generateMarks(),k=Object(_.a)(v,2),E=k[0],D=k[1],w=E.getMonth()+1<10?"0".concat(E.getMonth()+1):E.getMonth()+1,S=E.getDate()<10?"0".concat(E.getDate()):E.getDate(),O="".concat(w,"/").concat(S);return r.a.createElement("div",{className:"score-page"},r.a.createElement(p.a,{type:"flex",justify:"space-around"},r.a.createElement(ge.a,{span:10},l?r.a.createElement(b.a,{message:"".concat(u),description:"Please wait for our updates.",type:"error",closable:!0,onClose:this.onAlertClose}):null,r.a.createElement("div",{className:"form-wrapper"},r.a.createElement(y.a,{ref:this.formRef,onValuesChange:this.onValuesChange},r.a.createElement(y.a.Item,{label:"Areas",name:"areas",rules:[{required:!0,message:"Please select areas!"}]},r.a.createElement(C.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select Areas"},f)),r.a.createElement(y.a.Item,{label:"Week to check",name:"weeks",rules:[{required:!0,message:"Please select the week you want to see"}]},r.a.createElement(g.a,{marks:D,initialValue:s,min:s-5>=0?s-5:0,max:s+5<=c?s+5:c,onAfterChange:this.onWeeksChange}))),r.a.createElement("div",{className:"radio-group"},"Data Type:\xa0\xa0",r.a.createElement(m.a.Group,{value:d,onChange:this.handleScoreTypeSelect},r.a.createElement(m.a,{value:"reproduction"},"Dynamic Reproduction Number"),r.a.createElement(m.a,{value:"mfr"},"Model-based Fatality Rate"))),r.a.createElement("p",null,"Dynamic Map:\xa0\xa0",r.a.createElement(h.a,{onChange:this.switchDynamicMap})))),r.a.createElement(ge.a,{span:14},r.a.createElement("div",{className:"map-wrapper"},r.a.createElement(_e,{className:"score-map",triggerRef:this.bindRef,dynamicMapOn:o,weeks:s,latestWeek:c,onMapClick:this.onMapClick,onNoData:this.onNoData,scoreType:d})))),a.length?r.a.createElement(p.a,null,r.a.createElement(ge.a,{span:24},r.a.createElement("div",{className:"graph-wrapper"},r.a.createElement(ke,{data:i,date:O,scoreType:d})))):null)}}]),a}(n.PureComponent),Me=a(556),je=a(67),Re=(a(985),a(986),a(1045)),Ae=a(1046),Ie=function(){return r.a.createElement(Re.a,{collapseOnSelect:!0,expand:"lg",className:"navbar-header navbar-light"},r.a.createElement(Re.a.Brand,{href:"#/"},r.a.createElement("img",{className:"logo",src:"https://identity.usc.edu/files/2011/12/combo_gold_white_cardinal.png",alt:"USC"})),r.a.createElement(Re.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),r.a.createElement(Re.a.Collapse,{id:"responsive-navbar-nav"},r.a.createElement(Ae.a,{className:"mr-auto"},r.a.createElement(Ae.a.Link,{className:"navbar-link",href:"#/"},"COVID-19 Forecast"),r.a.createElement(Ae.a.Link,{className:"navbar-link",href:"#row"},"All Locations!"),r.a.createElement(Ae.a.Link,{className:"navbar-link",href:"#score"},"Reproduction Number"),r.a.createElement(Ae.a.Link,{className:"navbar-link",href:"#highlights"},"Highlights"),r.a.createElement(Ae.a.Link,{className:"navbar-link",href:"#leaderboard"},"Evaluation"),r.a.createElement(Ae.a.Link,{className:"navbar-link",href:"#about"},"About Us")),r.a.createElement(Ae.a,null)))},xe=(a(989),a(990),a(555)),Ne=a(331),Te=(a(992),"https://htmlpreview.github.io/?https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/frontend/src/leaderboard/USFH_compare.html"),We=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).state={which_hub:Te,width:0,height:0},e.updateWindowDimensions=e.updateWindowDimensions.bind(Object(S.a)(e)),e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"updateWindowDimensions",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"getAvatar",value:function(e){var t="";switch(e){case 1:t="https://img.icons8.com/officel/80/000000/medal2.png";break;case 2:t="https://img.icons8.com/officel/80/000000/medal-second-place.png";break;case 3:t="https://img.icons8.com/officel/80/000000/medal2-third-place.png";break;default:t="https://img.icons8.com/carbon-copy/100/000000/"+e+"-circle.png"}return r.a.createElement(xe.a,{className:"rank-number",src:t,alt:""})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"page-wrapper"},r.a.createElement("div",{className:"grid"},r.a.createElement(p.a,null,r.a.createElement("div",{className:"introduction"},r.a.createElement("p",null,"We evaluate the submissions that are made publicly on various forecasting hubs and highlight where our submissions stand. Note that the following only compares the submissions and not the forecasting methodologies. The submissions may have used different methodologies over time and tuned manually. The evaluation of different methodologies is a part of our other upcoming project ",r.a.createElement("a",{href:"https://github.com/scc-usc/covid19-forecast-bench"},"here"),"."),r.a.createElement("p",null,"We are currently contributing to the following hubs. Please select one to see the evaluations.","\n")),r.a.createElement("div",null,r.a.createElement(d.a,{onClick:function(){return e.setState({which_hub:Te})}},"US Forecast Hub"),r.a.createElement(d.a,{onClick:function(){return e.setState({which_hub:"https://htmlpreview.github.io/?https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/frontend/src/leaderboard/GFH_compare.html"})}},"Germany/Poland Forecast Hub"))),r.a.createElement(p.a,null,r.a.createElement(Ne.a,{url:this.state.which_hub,width:"100%",height:(.7*this.state.height).toString()}))))}}]),a}(n.Component),Pe=(a(993),function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).state={width:0,height:0},e.updateWindowDimensions=e.updateWindowDimensions.bind(Object(S.a)(e)),e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"updateWindowDimensions",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"render",value:function(){return r.a.createElement("div",{className:"page-wrapper"},r.a.createElement("div",{className:"grid"},r.a.createElement(p.a,null,r.a.createElement(Ne.a,{url:"https://htmlpreview.github.io/?https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/frontend/src/highlights/highlights.html",width:"100%",height:(.9*this.state.height).toString()}))))}}]),a}(n.Component)),Le=(a(994),a(995),[]),Be=C.a.Option,ze=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).state={cum_or_inc:"Cumulative",data_loading:!0,areas:[],width:0,height:0,arealist:[],case_data:[],death_data:[],death_list:[],case_preds:[],case_pred_list:[],death_preds:[],death_pred_list:[],CoD:"case",case_data_plot:[],death_data_plot:[],case_preds_plot:[],death_preds_plot:[],data_date:[],pred_date:[],to_plot:[]},e.updateWindowDimensions=e.updateWindowDimensions.bind(Object(S.a)(e)),e.plotData=e.plotData.bind(Object(S.a)(e)),e.onValuesChange=e.onValuesChange.bind(Object(S.a)(e)),e.doneLoading=e.doneLoading.bind(Object(S.a)(e)),e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions),this.setState({arealist:Le})}},{key:"componentWillMount",value:function(){$.a.parse("https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/results/forecasts/google_data.csv",{download:!0,complete:function(e){var t;for(t=1;t<e.data.length;t++)e.data[t].length>2&&(Le[t-1]=e.data[t][1]);this.setState({data_date:e.data[0].slice(2)}),this.setState({arealist:Le}),this.setState({case_data:e.data})}.bind(this)}),$.a.parse("https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/results/forecasts/google_deaths.csv",{download:!0,complete:function(e){var t,a=[];for(t=1;t<e.data.length;t++)e.data[t].length>2&&(a[t-1]=e.data[t][1]);this.setState({death_list:a}),this.setState({death_data:e.data})}.bind(this)}),$.a.parse("https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/results/forecasts/google_forecasts_current_0.csv",{download:!0,complete:function(e){var t,a=[];for(t=1;t<e.data.length;t++)e.data[t].length>2&&(a[t-1]=e.data[t][1]);this.setState({pred_date:e.data[0].slice(2)}),this.setState({case_pred_list:a}),this.setState({case_preds:e.data})}.bind(this)}),$.a.parse("https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/results/forecasts/google_deaths_current_0.csv",{download:!0,complete:function(e){var t,a=[];for(t=1;t<e.data.length;t++)e.data[t].length>2&&(a[t-1]=e.data[t][1]);this.setState({death_pred_list:a}),this.setState({death_preds:e.data})}.bind(this)})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"updateWindowDimensions",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"plotData",value:function(){var e,t,a,n=[];if("case"===this.state.CoD?(e=this.state.case_data_plot,t=this.state.case_preds_plot):(e=this.state.death_data_plot,t=this.state.death_preds_plot),"Cumulative"===this.state.cum_or_inc){for(a=0;a<e.length;a++)e[a]>0&&n.push({x:this.state.data_date[a],y:e[a]});var r=[];for(a=0;a<t.length;a++)r.push({x:this.state.pred_date[a],y:t[a]})}else{var s=e[0],i=0;for(a=1;a<e.length;a++)(i=e[a]-s)>=0&&s>0&&n.push({x:this.state.data_date[a],y:i}),s=e[a];r=[];for(s=e[e.length-1],a=0;a<t.length;a++)(i=t[a]-s)>=0&&s>0&&r.push({x:this.state.pred_date[a],y:i}),s=t[a]}var o=[{id:"Data",data:n},{id:"Forecasts",data:r}];this.setState({to_plot:o})}},{key:"onValuesChange",value:function(e,t){var a=this;if("areas"in e){var n=this.state.arealist.indexOf(t.areas),r=[];n>-1&&(r=this.state.case_data[n+1].slice(2)),this.setState({case_data_plot:r}),r=[],(n=this.state.case_pred_list.indexOf(t.areas))>-1&&(r=this.state.case_preds[n+1].slice(2)),this.setState({case_preds_plot:r});var s=[];(n=this.state.death_list.indexOf(t.areas))>-1&&(s=this.state.death_data[n+1].slice(2)),this.setState({death_data_plot:s}),s=[],(n=this.state.death_pred_list.indexOf(t.areas))>-1&&(s=this.state.death_preds[n+1].slice(2)),this.setState({death_preds_plot:s})}"cum_or_inc"in e&&this.setState({cum_or_inc:t.cum_or_inc},(function(){return a.plotData()})),this.setState({CoD:t.CoD},(function(){return a.plotData()}))}},{key:"doneLoading",value:function(){this.setState({data_loading:!1})}},{key:"render",value:function(){var e=this.state,t=e.areas,a=e.arealist,n=e.CoD,s=e.to_plot,i=(e.data_loading,e.cum_or_inc),o=a.length>0&&a.map((function(e){return r.a.createElement(Be,{key:e,value:e},e)}),this),c=1+this.state.width/280;return this.state.data_loading&this.state.case_preds.length>0&&this.state.death_preds.length>0&&this.doneLoading(),r.a.createElement("div",{className:"page-wrapper"},r.a.createElement("div",{className:"grid"},r.a.createElement(p.a,null,r.a.createElement("h1",null,'Forecasts for "Almost" Everywhere')),r.a.createElement(p.a,null,r.a.createElement("div",{className:"introduction"},r.a.createElement("p",null,"Use this page to see forecasts not addressed on the ",r.a.createElement("a",{href:"#/"}," main page"),". Forecasts are available for all locations (around 20,000) for which Google makes its data",r.a.createElement("a",{href:"https://github.com/scc-usc/covid19-forecast-bench"}," public"),"."),r.a.createElement("p",null,"[Note: The data is noisy for some regions with decreasing cumulative values and missing values. See below for our forecasts from alternative sources.]"))),r.a.createElement(p.a,null,r.a.createElement("div",{className:"form-column-row"},r.a.createElement(y.a,{ref:this.formRef,onValuesChange:this.onValuesChange,initialValues:{areas:t,CoD:n,cum_or_inc:i}},r.a.createElement(v.a,{content:"start typing a location name to plot its data.",placement:"top"},r.a.createElement(y.a.Item,{style:{marginBottom:"0px"},label:"Location",name:"areas",rules:[{required:!0,message:"Please select areas!"}]},r.a.createElement(C.a,{showSearch:!0,loading:this.state.data_loading,style:{width:"100%"},placeholder:"Select Areas"},o))),r.a.createElement(p.a,null,r.a.createElement(ge.a,null,r.a.createElement(v.a,{content:"Choose to plot cumulative or new weekly numbers",placement:"bottomLeft"},r.a.createElement(y.a.Item,{label:"Data Type",style:{marginBottom:"5px"},name:"cum_or_inc",value:i},r.a.createElement(m.a.Group,{initialValue:"Cumulative",buttonStyle:"solid"},r.a.createElement(m.a.Button,{value:"Cumulative"},"Cumulative"),r.a.createElement(m.a.Button,{value:"New"},"Weekly New"))))),r.a.createElement(ge.a,null,r.a.createElement(v.a,{content:"Choose cases or deaths to plot",placement:"bottomLeft"},r.a.createElement(y.a.Item,{label:"",style:{marginBottom:"5px"},name:"CoD",value:n},r.a.createElement(m.a.Group,{initialValue:"case",buttonStyle:"solid"},r.a.createElement(m.a.Button,{value:"case"},"Cases"),r.a.createElement(m.a.Button,{value:"death"},"Deaths"))))))))),r.a.createElement("div",{className:"graph"},r.a.createElement(O.a,{data:s,margin:{top:50,right:10,bottom:100,left:60},xScale:{type:"time",format:"%Y-%m-%d"},xFormat:"time:%Y-%m-%d",yScale:{type:"linear",min:"auto",max:"auto",stacked:!1,reverse:!1},axisTop:null,axisRight:null,axisLeft:{format:function(e){return R()(e).format("0.[0]a")},orient:"left",tickSize:5,tickPadding:5,tickRotation:0,legend:i.concat(" ".concat(n.concat("s"))),legendOffset:-55,legendPosition:"middle"},axisBottom:{format:"%b %d",tickValues:c,legend:"date",legendOffset:36,legendPosition:"middle"},colors:{scheme:"nivo"},pointSize:10,pointColor:{theme:"background"},pointBorderWidth:2,pointBorderColor:{from:"serieColor"},pointLabel:"y",pointLabelYOffset:-12,useMesh:!0,legends:[{text:{fontSize:14},anchor:"top-left",direction:"column",justify:!1,translateX:30,translateY:0,itemsSpacing:0,itemDirection:"left-to-right",itemWidth:80,itemHeight:20,itemOpacity:.75,symbolSize:12,symbolShape:"circle",symbolBorderColor:"rgba(0, 0, 0, .5)",effects:[{on:"hover",style:{itemBackground:"rgba(0, 0, 0, .03)",itemOpacity:1}}]}],theme:{axis:{ticks:{text:{fontSize:16}},legend:{text:{fontSize:16}}},legends:{text:{fontSize:16}}}}),r.a.createElement(p.a,null,r.a.createElement("div",{className:"introduction"},"Use the following links to download CSV files to analyze yourself (Right-click -> Save As): ","\n",r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("a",{href:"https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/results/forecasts/google_data.csv",download:!0,target:"_blank"},"All formatted case data from Google ")),r.a.createElement("li",null,r.a.createElement("a",{href:"https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/results/forecasts/google_deaths.csv",download:!0,target:"_blank"},"All formatted death data from Google ")," "),r.a.createElement("li",null,r.a.createElement("a",{href:"https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/results/forecasts/google_forecasts_current_0.csv",download:!0,target:"_blank"},"Case forecasts on Google data ")," "),r.a.createElement("li",null,r.a.createElement("a",{href:"https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/results/forecasts/google_deaths_current_0.csv",download:!0,target:"_blank"},"Death forecasts on Google data ")," ")))),r.a.createElement(p.a,null,r.a.createElement("div",{className:"introduction"},"The following are the latest forecasts for Countries and the US states used on the main forecast page. These files are based on the",r.a.createElement("a",{href:"https://github.com/CSSEGISandData/COVID-19/tree/master/csse_covid_19_data"}," JHU data"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("a",{href:"https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/results/forecasts/us_data.csv",download:!0,target:"_blank"},"All formatted case data for US states ")),r.a.createElement("li",null,r.a.createElement("a",{href:"https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/results/forecasts/us_deaths.csv",download:!0,target:"_blank"},"All formatted death data for US states ")),r.a.createElement("li",null,r.a.createElement("a",{href:"https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/results/forecasts/global_forecasts_current_0.csv",download:!0,target:"_blank"},"Case forecasts for all countries ")),r.a.createElement("li",null,r.a.createElement("a",{href:"https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/results/forecasts/global_deaths_current_0.csv",download:!0,target:"_blank"},"Death forecasts for all countries "))))),r.a.createElement(p.a,null,r.a.createElement("div",{className:"introduction"},"Follow  this ",r.a.createElement("a",{href:"https://github.com/scc-usc/ReCOVER-COVID-19/tree/master/results/historical_forecasts"},"link "),"for dated forecasts for German states and Polish Voivodeships. These files are based on the data compiled by",r.a.createElement("a",{href:"https://github.com/CSSEGISandData/COVID-19/tree/master/csse_covid_19_data",target:"_blank"}," Germany and Poland Forecast Hub"))))))}}]),a}(n.Component),Fe=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).redirectForecast=function(){n.setState({redirectForecast:!0,redirectAbout:!1,redirectScore:!1,redirectLeaderboard:!1,redirectHighlights:!1,redirectRoW:!1})},n.redirectAbout=function(){n.setState({redirectForecast:!1,redirectAbout:!0,redirectScore:!1,redirectLeaderboard:!1,redirectHighlights:!1,redirectRoW:!1})},n.redirectScore=function(){n.setState({redirectForecast:!1,redirectAbout:!1,redirectScore:!0,redirectHighlights:!1,redirectLeaderboard:!1,redirectRoW:!1})},n.redirectLeaderboard=function(){n.setState({redirectForecast:!1,redirectAbout:!1,redirectScore:!1,redirectLeaderboard:!0,redirectHighlights:!1,redirectRoW:!1})},n.redirectHighlights=function(){n.setState({redirectForecast:!1,redirectAbout:!1,redirectScore:!1,redirectLeaderboard:!1,redirectHighlights:!0,redirectRoW:!1})},n.redirectRoW=function(){n.setState({redirectForecast:!1,redirectAbout:!1,redirectScore:!1,redirectLeaderboard:!1,redirectHighlights:!1,redirectRoW:!0})},n.state={redirectForecast:!1,redirectAbout:!1,redirectScore:!1,redirectLeaderboard:!1,redirectHighlights:!1,redirectRoW:!1},n}return Object(c.a)(a,[{key:"render",value:function(){var e=this.state,t=e.redirectForecast,a=e.redirectAbout,n=e.redirectScore,s=e.redirectLeaderboard,i=e.redirectHighlights;e.redirectRoW;return r.a.createElement(Me.a,{basename:"/"},t?r.a.createElement(je.a,{to:"/"}):null,i?r.a.createElement(je.a,{to:"/highlights"}):null,n?r.a.createElement(je.a,{to:"/score"}):null,a?r.a.createElement(je.a,{to:"/about"}):null,s?r.a.createElement(je.a,{to:"/leaderboard"}):null,s?r.a.createElement(je.a,{to:"/row"}):null,r.a.createElement(Ie,{redirectForecast:this.redirectForecast,redirectHighlights:this.redirectHighlights,redirectScore:this.redirectScore,redirectAbout:this.redirectAbout,redirectLeaderboard:this.redirectLeaderboard,redirectRoW:this.redirectRoW}),r.a.createElement(je.d,null,r.a.createElement(je.b,{exact:!0,path:"/",render:function(e){return r.a.createElement(pe,e)}}),r.a.createElement(je.b,{exact:!0,path:"/score",render:function(e){return r.a.createElement(Ve,e)}}),r.a.createElement(je.b,{exact:!0,path:"/about",render:function(e){return r.a.createElement(fe,e)}}),r.a.createElement(je.b,{exact:!0,path:"/leaderboard",render:function(e){return r.a.createElement(We,e)}}),r.a.createElement(je.b,{exact:!0,path:"/highlights",render:function(e){return r.a.createElement(Pe,e)}}),r.a.createElement(je.b,{exact:!0,path:"/row",render:function(e){return r.a.createElement(ze,e)}})))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(Fe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[619,1,3]]]);
//# sourceMappingURL=main.01a0604f.chunk.js.map