{"version":3,"sources":["frontendData/global_lats_longs.txt","frontendData/global_population_data.txt","covid19graph.js","covid19map.js","modelapi.js","covid19util.js","test_data.js","covid19predict.js","aboutus.js","scorePage/scoreGraph.js","scorePage/newScoreGraph.js","scorePage/scoreMap.js","scorePage/scorePage.js","navbar/navbar.js","leaderboard/leaderboard.js","highlights/highlights.js","covid19app.js","serviceWorker.js","index.js"],"names":["module","exports","global_lat_long","populationVect","DashedLine","series","lineGenerator","xScale","yScale","map","id","data","color","predicted","distancing","style","strokeWidth","strokeDasharray","key","d","x","y","fill","stroke","theme","axis","ticks","text","fontSize","legend","legends","Covid19Graph","props","state","width","height","updateWindowDimensions","bind","this","window","addEventListener","removeEventListener","setState","innerWidth","innerHeight","dateStr","split","Number","year","month","day","Date","parseDate","date","value","initialVal","i","params","statistic","retData","getDeltaData","getCumulativeData","filter","max","Object","keys","forEach","area","observed","predictions","Math","p","timeSeries","time_series","linearAxisLeft","format","numeral","orient","tickSize","tickPadding","tickRotation","legendOffset","legendPosition","logTickValues","ceil","log10","getDataMax","push","pow","logAxisLeft","tickValues","axisLeft","gridYValues","type","base","min","dataType","chartData","colors","sort","idx","lineColor","index","red","gold","green","blue","volcano","yellow","cyan","purple","orange","lime","geekblue","magenta","length","getLineColor","observedConfirmed","observedDeath","observed_deaths","includes","processData","modelName","model","name","isDeathModel","substring","augmented_timeSeries","concat","minDate","maxDate","moment","diff","num_ticks","margin","top","right","bottom","left","precision","axisBottom","getYAxisProps","enableSlices","sliceTooltip","slice","background","padding","border","points","point","serieColor","serieId","yFormatted","pointSize","pointLabel","pointLabelYOffset","anchor","direction","justify","translateX","translateY","itemsSpacing","itemDirection","itemWidth","itemHeight","itemOpacity","symbolSize","symbolShape","symbolBorderColor","effects","on","itemBackground","layers","Component","API_BASE_URL","process","ModelAPI","callback","endpoint","axios","get","then","res","allAreas","allModels","infectionModels","deathModels","currentDate","latestDate","total_confirmed","Global","TotalConfirmed","total_deaths","TotalDeaths","totalConfirmed","totalDeaths","parseData","url","callBack","Papa","parse","download","dynamicTyping","complete","results","casesPerPersonCalculation","populationNum","numCases","round","numberWithCommas","toString","replace","globalLL","population","Covid19Marker","caseKey","deathKey","center","caseRadius","deathRadius","caseValue","deathValue","caseOpacity","deathOpacity","onClick","CircleMarker","radius","fillColor","fillOpacity","weight","Tooltip","opacity","sticky","Covid19MarkerList","items","markers","Covid19Map","modelAPI","areasList","worldCases","worldDeaths","stateMarkers","countyMarkers","renderStateCountyMarkers","us","renderUS","callbackCounter","mapInitialized","areas","triggerRef","fetchData","dynamicMapOn","usFound","stateCount","caseData","caseValueTrue","deathData","deathValueTrue","getRadius","getColor","caseArea","deathArea","valueTrue","country","e","handleMapClick","display","cumulative_infections","cumulativeInfections","iso_2","log","max_percentage","setCaseDeathData","cumulative_death","days","cumulativeDeath","predict_all","confirmed_model","max_val_percentage","death_model","max_death_percentage","history_cumulative","historyCumulative","previousCumulative","find","historyInfections","nextDayCumulative","getCaseDeathData","predictCaseDeathData","getHistoryCumulative","newCases","onMapClick","onNoData","target","options","Map","zoom","minZoom","ref","maxBounds","Infinity","worldCopyJump","TileLayer","LayersControl","position","BaseLayer","LayerGroup","checked","renderStates","areaToStr","a","strToArea","s","words","trim","Option","Covid19Predict","handleYScaleSelect","console","handleStatisticSelect","handleDataTypeSelect","handleMapShownSelect","mapShown","componentWillMount","addAreaByStr","formRef","React","createRef","infection_models","modelsList","death_models","prevState","getCurrentDate","firstDate","real_time","global","bindRef","onAlertClose","noDataError","errorDescription","generateMarks","beginDate","setDate","getDate","marks","getMonth","skip","skip_factor","floor","getDaysToFirstDate","beginningDate","abs","toggleControlInstructions","showControlInstructions","toggleMapInstructions","showMapInstructions","models","current","worst_effort","best_effort","mainGraphData","removeAreaByStr","onValuesChange","onDaysToPredictChange","switchDynamicMap","areaIsSelected","areaStr","areaObj","predict","checkHistory","setFieldsValue","targetAreaStr","reduce","newMainGraphData","newModelStr","changedValues","allValues","socialDistancing","reloadAll","prevAreas","newAreas","areasToAdd","areasToRemove","daysToFirstDate","countryOptions","modelOptions","modelIsSelected","title","description","placement","CONTROL_INSTRUCTIONS","className","data_type","statistics","scale","MAP_INSTRUCTION","selectMap","dynamicMap","radioGroup","overview","today","dd","String","padStart","getFullYear","confirmed_model_map","death_model_map","Heading","message","closable","onClose","initialValues","content","visible","Item","marginBottom","label","rules","required","mode","placeholder","align","overflow","adjustX","adjustY","initialValue","onAfterChange","step","tooltipVisible","Group","defaultChecked","onChange","PureComponent","AboutUs","href","NewScoreGraph","scoreType","firstArea","observed_rt","dataSet","conf","observed_mrf","strokeColor","lines","dataKey","dy","angle","iconSize","am4core","am4themes_animated","ScoreMap","onShowState","showState","worldSeries","usaSeries","args","arguments","scores_all","weeks","scores","heatmapData","initChart","updateChart","all_mrf_scores","latestWeek","chart","am4maps","projection","Mercator","createChartSeries","geodata","am4geodata_worldLow","exclude","am4geodata_usaLow","disabled","stateSeries","initChartInterface","seriesProps","polygonTemplate","assign","mapPolygons","template","heatRules","property","minValue","maxValue","tooltipText","nonScalingStroke","states","create","properties","cursorOverStyle","pointer","events","dataItem","dataContext","zoomControl","button","chartContainer","createChild","togglable","marginRight","isActive","dispose","ScorePage","componentDidMount","latest_score_date","lastDate","handleScoreTypeSelect","onWeeksChange","newAreaStr","formatted_current_date","span","NavBar","Navbar","collapseOnSelect","expand","Brand","src","alt","Toggle","aria-controls","Collapse","Nav","Link","USFH","Leaderboard","which_hub","number","icon_src","Highlights","Covid19App","redirectForecast","redirectAbout","redirectScore","redirectLeaderboard","redirectHighlights","basename","to","exact","path","render","Boolean","location","hostname","match","ReactDOM","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error"],"mappings":"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","file":"static/js/main.9a790b8a.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/global_lats_longs.16f05c12.txt\";","module.exports = __webpack_public_path__ + \"static/media/global_population_data.e9f67e1b.txt\";","import React, { Component} from \"react\";\r\n//import ReactDOM from \"react-dom\";\r\nimport { ResponsiveLine } from \"@nivo/line\";\r\nimport moment from \"moment\";\r\nimport numeral from \"numeral\";\r\nimport {\r\n  red,\r\n  volcano,\r\n  orange,\r\n  yellow,\r\n  gold,\r\n  lime,\r\n  green,\r\n  cyan,\r\n  blue,\r\n  geekblue,\r\n  purple,\r\n  magenta\r\n} from \"@ant-design/colors\";\r\n\r\n\r\nfunction getLineColor(index) {\r\n  const colors = [\r\n    red,\r\n    gold,\r\n    green,\r\n    blue,\r\n    volcano,\r\n    yellow,\r\n    cyan,\r\n    purple,\r\n    orange,\r\n    lime,\r\n    geekblue,\r\n    magenta\r\n  ];\r\n\r\n  return colors[index % colors.length];\r\n}\r\n\r\n// Custom layer for Nivo Line that allows us to display predictions as dashed\r\n// lines.\r\nconst DashedLine = ({ series, lineGenerator, xScale, yScale }) => {\r\n  return series.map(({ id, data, color, predicted, distancing }) => {\r\n    let style = {\r\n      strokeWidth: 3\r\n    };\r\n\r\n    // Add custom style if predicted.\r\n    if (predicted) {\r\n      if (distancing) {\r\n        style.strokeDasharray = \"6, 4\";\r\n      } else {\r\n        // Display a sparser pattern for no social distancing.\r\n        style.strokeDasharray = \"2, 6\";\r\n      }\r\n    }\r\n\r\n    return (\r\n      <path\r\n        key={id}\r\n        d={lineGenerator(\r\n          data.map(d => ({\r\n            x: xScale(d.data.x),\r\n            y: yScale(d.data.y)\r\n          }))\r\n        )}\r\n        fill=\"none\"\r\n        stroke={color}\r\n        style={style}\r\n      />\r\n    );\r\n  });\r\n};\r\n\r\nconst theme = {\r\n  axis: {\r\n    ticks: {\r\n      text: {\r\n        fontSize: 16\r\n      }\r\n    },\r\n    legend: {\r\n      text: {\r\n        fontSize: 16\r\n      }\r\n    }\r\n  },\r\n  legends: {\r\n    text: {\r\n      fontSize: 14\r\n    }\r\n  }\r\n};\r\n\r\nclass Covid19Graph extends Component {\r\n  ////////////////////////////////////\r\nconstructor(props) {\r\n  super(props);\r\n  this.state = { width: 0, height: 0 };\r\n  this.updateWindowDimensions = this.updateWindowDimensions.bind(this);\r\n}\r\n\r\ncomponentDidMount() {\r\n  this.updateWindowDimensions();\r\n  window.addEventListener('resize', this.updateWindowDimensions);\r\n}\r\n\r\ncomponentWillUnmount() {\r\n  window.removeEventListener('resize', this.updateWindowDimensions);\r\n}\r\n\r\nupdateWindowDimensions() {\r\n  this.setState({ width: window.innerWidth, height: window.innerHeight });\r\n}\r\n\r\n  ////////////////////////////////////\r\n\r\n  parseDate(dateStr) {\r\n    let [year, month, day] = dateStr.split(\"-\").map(Number);\r\n    // Month in JS is 0-based.\r\n    month -= 1;\r\n    return new Date(year, month, day);\r\n  }\r\n\r\n  /**\r\n   * Given a time series returned by the predict endpoint, getCumulativeData\r\n   * returns it in Nivo format.\r\n   */\r\n  getCumulativeData(data) {\r\n    return data.map(d => ({\r\n      x: this.parseDate(d.date),\r\n      y: d.value\r\n    }));\r\n  }\r\n\r\n  /**\r\n   * Given a time series returned by the predict endpoint, getDeltaData returns\r\n   * the adjacent difference of the timeseries, in Nivo format.\r\n   * @param initialVal - The initial value that is subtracted from the 1st\r\n   *  element.\r\n   */\r\n  getDeltaData(data, initialVal) {\r\n    return data.map((d, i) => {\r\n      if (i === 0) {\r\n        return {\r\n          x: this.parseDate(d.date),\r\n          y: d.value - initialVal\r\n        };\r\n      }\r\n\r\n      return {\r\n        x: this.parseDate(d.date),\r\n        y: d.value - data[i - 1].value\r\n      };\r\n    });\r\n  }\r\n\r\n  // processData properly formats the given data, and performs special\r\n  // operations based on parameter values.\r\n  processData(data, params) {\r\n    const { statistic, yScale, initialVal } = params;\r\n\r\n    // Determine whether we need to calculate deltas between points.\r\n    let retData =\r\n      statistic === \"delta\"\r\n        ? this.getDeltaData(data, initialVal)\r\n        : this.getCumulativeData(data);\r\n\r\n    // Remove all points with y = 0 if we're using log scale, otherwise it will\r\n    // break.\r\n    if (yScale === \"log\") {\r\n      retData = retData.filter(({ x, y }) => y > 0);\r\n    }\r\n\r\n    return retData;\r\n  }\r\n\r\n  /**\r\n   * getDataMax returns the maximum value present in the data supplied to the\r\n   * graph.\r\n   */\r\n  getDataMax() {\r\n    const { data } = this.props;\r\n\r\n    let max = 0;\r\n\r\n    Object.keys(data).forEach(area => {\r\n      const { observed, predictions } = data[area];\r\n      max = Math.max(max, Math.max(...observed.map(({ value }) => value)));\r\n\r\n      predictions.forEach(p => {\r\n        const timeSeries = p.time_series;\r\n        max = Math.max(max, Math.max(...timeSeries.map(({ value }) => value)));\r\n      });\r\n    });\r\n\r\n    return max;\r\n  }\r\n\r\n  /**\r\n   * getYAxisProps returns the corresponding Nivo line props for supporting\r\n   * different Y axis types (linear and log).\r\n   */\r\n  getYAxisProps() {\r\n    const { statistic, yScale } = this.props;\r\n\r\n    const linearAxisLeft = {\r\n      // Format large y numbers as their abbreviations.\r\n      format: y => numeral(y).format(\"0.[0]a\"),\r\n      orient: \"left\",\r\n      tickSize: 5,\r\n      tickPadding: 5,\r\n      tickRotation: 0,\r\n      legend: statistic === \"delta\" ? \"New Cases\" : \"Cumulative Cases\",\r\n      legendOffset: -60,\r\n      legendPosition: \"middle\"\r\n    };\r\n\r\n    let logTickValues = [];\r\n    for (let i = 0; i <= Math.ceil(Math.log10(this.getDataMax())); i++) {\r\n      logTickValues.push(Math.pow(10, i));\r\n    }\r\n\r\n    // The 'axisLeft' prop for log scale is the same as for linear axis, except\r\n    // that the tick values must be supplied.\r\n    const logAxisLeft = {\r\n      ...linearAxisLeft,\r\n      tickValues: logTickValues\r\n    };\r\n\r\n    // For log scale Y axes, we must supply the Y tick values for the grid, as\r\n    // well as specifying the min/ max, since it seems like Nivo cannot\r\n    // automatically determine the domain for log scale.\r\n    if (yScale === \"log\") {\r\n      return {\r\n        axisLeft: logAxisLeft,\r\n        gridYValues: logTickValues,\r\n        yScale: {\r\n          type: \"log\",\r\n          base: 10,\r\n          min: Math.min(...logTickValues),\r\n          max: Math.max(...logTickValues)\r\n        }\r\n      };\r\n    }\r\n\r\n    return {\r\n      axisLeft: linearAxisLeft,\r\n      yScale: {\r\n        type: \"linear\",\r\n        min: \"auto\",\r\n        max: \"auto\"\r\n      }\r\n    };\r\n  }\r\n\r\n  render() {\r\n    let { data } = this.props;\r\n    const { statistic, yScale, dataType } = this.props;\r\n    // chartData contains the data that we will pass into Nivo line chart.\r\n    let chartData = [];\r\n    // colors holds hex values for each line in the chart.\r\n    let colors = [];\r\n\r\n    // Sort the data by area name (so we have a consistent coloring) and then\r\n    // loop over each area.\r\n    Object.keys(data)\r\n      .sort()\r\n      .forEach((area, idx) => {\r\n        const lineColor = getLineColor(idx);\r\n        const observedConfirmed = data[area].observed\r\n        const observedDeath = data[area].observed_deaths;\r\n        // Add the observed infection data if confirmed is selected\r\n        if (dataType.includes(\"confirmed\"))\r\n        {\r\n          chartData.push({\r\n            id: area,\r\n            data: this.processData(observedConfirmed, {\r\n              statistic: statistic,\r\n              yScale: yScale,\r\n              initialVal: 0\r\n            }),\r\n            // 'predicted' is a custom prop that we add so later we can tell the\r\n            // difference between observed/predicted data when drawing the lines.\r\n            predicted: false\r\n          });\r\n  \r\n          colors.push(lineColor[4]);\r\n        }\r\n        if (dataType.includes(\"death\"))\r\n        {\r\n          //also push death value to the same graph\r\n          chartData.push({\r\n            id: `${area} death`,\r\n            data: this.processData(observedDeath, {\r\n              statistic: statistic,\r\n              yScale: yScale,\r\n              initialVal: 0\r\n            }),\r\n            // 'predicted' is a custom prop that we add so later we can tell the\r\n            // difference between observed/predicted data when drawing the lines.\r\n            predicted: false\r\n          });\r\n\r\n          colors.push(lineColor[6])\r\n        }\r\n        \r\n        // Add the data for each of the predicted time series. Filter out time\r\n        // series that don't have any data associated.\r\n        data[area].predictions\r\n          .filter(p => p.time_series.length > 0)\r\n          .forEach((p,idx) => {\r\n            const modelName = p.model.name;\r\n            const isDeathModel = modelName.substring(0, 10) !== \"SI-kJalpha\" || modelName.includes(\"death prediction\")\r\n            const distancing = p.distancing;\r\n            const timeSeries = p.time_series;\r\n            //check if the model is a death model\r\n            let augmented_timeSeries = []\r\n            if (dataType.includes(\"death\") && isDeathModel)\r\n            {\r\n              augmented_timeSeries = [observedDeath[observedDeath.length - 1]].concat(timeSeries);\r\n            }\r\n            else if (dataType.includes(\"confirmed\") && !isDeathModel)\r\n            {\r\n              augmented_timeSeries = [observedConfirmed[observedConfirmed.length - 1]].concat(timeSeries);\r\n            }\r\n            else\r\n            {\r\n              return\r\n            }\r\n            chartData.push({\r\n              id: `${area} (${modelName}, ${distancing})`,\r\n              // If we're displaying deltas, we pass in the last observed value as\r\n              // the initial value for calculating the predicted deltas.\r\n              data: this.processData(augmented_timeSeries, {\r\n                statistic: statistic,\r\n                yScale: yScale,\r\n                initialVal: isDeathModel?observedDeath[observedDeath.length - 2].value:observedConfirmed[observedConfirmed.length - 2].value\r\n              }),\r\n              // 'predicted' is a custom prop that we add so later we can tell the\r\n              // difference between observed/predicted data when drawing the lines.\r\n              predicted: true,\r\n              // 'distancing' is also a custom prop we add so we can draw the\r\n              // line patterns differently between yes/no social distancing.\r\n              distancing: distancing\r\n            });\r\n            if (idx <= 4)\r\n            {\r\n              colors.push(lineColor[4+idx]);\r\n            }\r\n            else if (idx <= 8)\r\n            {\r\n              colors.push(lineColor[8 - idx]);\r\n\r\n            }\r\n            else \r\n            {\r\n              colors.push(lineColor[idx%10]);\r\n            }\r\n          });\r\n      });\r\n\r\n    // Determine whether we need to show weeks or months on the X axis.\r\n    let tickValues = \"every week\";\r\n\r\n    if (chartData.length > 0) {\r\n      // Calculate the minimum and maximum dates present in the data.\r\n      let minDate = chartData[0].data[0].x;\r\n      let maxDate = chartData[0].data[0].x;\r\n\r\n      chartData.forEach(({ data }) => {\r\n        data.forEach(({ x }) => {\r\n          minDate = Math.min(minDate, x);\r\n          maxDate = Math.max(maxDate, x);\r\n        });\r\n      });\r\n\r\n      minDate = moment(minDate);\r\n      maxDate = moment(maxDate);\r\n\r\n      // Switch to 'every month' if the date range is over a certain threshold.\r\n      const diffInDays = maxDate.diff(minDate, \"days\");\r\n      if (diffInDays > 15) {\r\n        tickValues = \"every month\";\r\n      }\r\n    }\r\n    \r\n    const num_ticks = 1 + this.state.width/300;\r\n    return (\r\n\r\n      <ResponsiveLine\r\n        data={chartData}\r\n        colors={colors}\r\n        //50,50,50,80\r\n        margin={{ top: 10, right: 50, bottom: 70, left: 100 }}\r\n        xScale={{\r\n          type: \"time\",\r\n          format: \"native\",\r\n          precision: \"day\"\r\n        }}\r\n        axisBottom={{\r\n          // tickValues determines how often / with what values our 'format'\r\n          // func is called.\r\n          //tickValues: tickValues,\r\n          tickValues: num_ticks,\r\n          // A custom 'format' func is required since all the x values are\r\n          // javascript Date objects.\r\n          format: date => {\r\n            return moment(date).format(\"M/D\");\r\n          },\r\n          orient: \"bottom\",\r\n          tickSize: 5,\r\n          tickPadding: 5,\r\n          tickRotation: 0,\r\n          legend: \"Date\",\r\n          legendOffset: 36,\r\n          legendPosition: \"middle\"\r\n        }}\r\n        // Set up the Y axis.\r\n        {...this.getYAxisProps()}\r\n        enableSlices=\"x\"\r\n        sliceTooltip={({ slice }) => {\r\n          return (\r\n            <div\r\n              style={{\r\n                background: \"white\",\r\n                padding: \"9px 12px\",\r\n                border: \"1px solid #ccc\"\r\n              }}\r\n            >\r\n              <div>\r\n                {// Grab the date from the first point, this will be the title of\r\n                // the tooltip.\r\n                moment(slice.points[0].data.x).format(\"MMM Do YYYY\")}\r\n              </div>\r\n              {slice.points.map(point => (\r\n                <div\r\n                  key={point.id}\r\n                  style={{\r\n                    color: point.serieColor,\r\n                    padding: \"3px 0\"\r\n                  }}\r\n                >\r\n                  <strong>{point.serieId}</strong>[\r\n                  {numeral(point.data.yFormatted).format(\"0.[0]a\")}]\r\n                </div>\r\n              ))}\r\n            </div>\r\n          );\r\n        }}\r\n        pointSize={0}\r\n        pointLabel=\"y\"\r\n        pointLabelYOffset={-12}\r\n        legends={[\r\n          {\r\n            anchor: \"top-left\",\r\n            direction: \"column\",\r\n            justify: false,\r\n            translateX: 0,\r\n            translateY: 0,\r\n            itemsSpacing: 0,\r\n            itemDirection: \"left-to-right\",\r\n            itemWidth: 80,\r\n            itemHeight: 20,\r\n            itemOpacity: 0.75,\r\n            symbolSize: 12,\r\n            symbolShape: \"circle\",\r\n            symbolBorderColor: \"rgba(0, 0, 0, .5)\",\r\n            effects: [\r\n              {\r\n                on: \"hover\",\r\n                style: {\r\n                  itemBackground: \"rgba(0, 0, 0, .03)\",\r\n                  itemOpacity: 1\r\n                }\r\n              }\r\n            ]\r\n          }\r\n        ]}\r\n        layers={[\r\n          \"grid\",\r\n          \"markers\",\r\n          \"areas\",\r\n          \"crosshair\",\r\n          DashedLine,\r\n          \"slices\",\r\n          \"points\",\r\n          \"axes\",\r\n          \"legends\"\r\n        ]}\r\n        theme={theme}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default Covid19Graph;\r\n","import React, { Component, Fragment } from \"react\";\r\nimport { Map, TileLayer, CircleMarker, Tooltip, LayersControl, LayerGroup } from \"react-leaflet\";\r\nimport ModelAPI from \"./modelapi\";\r\nimport \"leaflet/dist/leaflet.css\";\r\n\r\nimport globalLL from \"./frontendData/global_lats_longs.txt\"\r\nimport population from './frontendData/global_population_data.txt'\r\n\r\nimport Papa from \"papaparse\";\r\n\r\nvar global_lat_long;\r\nvar populationVect;\r\n\r\nfunction parse_lat_long_global(data) {\r\n    global_lat_long = data;\r\n}\r\n\r\nfunction parse_population(data) {\r\n  populationVect = data;\r\n}\r\n\r\nfunction parseData(url, callBack) {\r\n    Papa.parse(url, {\r\n        download: true,\r\n        dynamicTyping: true,\r\n        complete: function(results) {\r\n            callBack(results.data);\r\n        }\r\n    });\r\n}\r\n\r\nfunction casesPerPersonCalculation(populationNum, numCases) {\r\n  numCases = populationNum/numCases;\r\n  return Math.round(numCases);\r\n}\r\n\r\nfunction numberWithCommas(x) {\r\n  return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n}\r\n\r\nparseData(globalLL, parse_lat_long_global);\r\nparseData(population, parse_population);\r\n\r\nconst Covid19Marker = ({ caseKey, deathKey, data, center, caseRadius, deathRadius, caseValue, deathValue, population, color, caseOpacity, deathOpacity, stroke, onClick }) => (\r\n  <CircleMarker\r\n    key={deathKey}\r\n    data={data}\r\n    center={center}\r\n    radius={deathRadius}\r\n    fillColor=\"black\"\r\n    fillOpacity={deathOpacity}\r\n    stroke={false}\r\n    onClick={onClick}\r\n  >\r\n    <CircleMarker\r\n      key={caseKey}\r\n      data={data}\r\n      center={center}\r\n      radius={caseRadius}\r\n      color=\"white\"\r\n      weight={1.5}\r\n      fillColor={color}\r\n      fillOpacity={caseOpacity}\r\n      stroke={true}\r\n      onClick={onClick}\r\n    >\r\n      <Tooltip direction=\"right\" opacity={1} sticky={true}>\r\n        <b><span>{data}</span></b><br></br>\r\n        <span>{\"Cases: \" + numberWithCommas(caseValue) + \" (1 in \" + numberWithCommas(casesPerPersonCalculation(population, caseValue)) + \")\"}</span><br></br>\r\n        <span>{\"Deaths: \" + numberWithCommas(deathValue) + \" (1 in \" + numberWithCommas(casesPerPersonCalculation(population, deathValue)) + \")\"}</span><br></br>\r\n      </Tooltip>\r\n    </CircleMarker>\r\n    <Tooltip direction=\"right\" opacity={1} sticky={true}>\r\n      <b><span>{data}</span></b><br></br>\r\n      <span>{\"Cases: \" + numberWithCommas(caseValue) + \" (1 in \" + numberWithCommas(casesPerPersonCalculation(population, caseValue)) + \")\"}</span><br></br>\r\n      <span>{\"Deaths: \" + numberWithCommas(deathValue) + \" (1 in \" + numberWithCommas(casesPerPersonCalculation(population, deathValue)) + \")\"}</span><br></br>\r\n\r\n    </Tooltip>\r\n  </CircleMarker>\r\n);\r\n\r\nconst Covid19MarkerList = ({ markers }) => {\r\n  const items = markers.map(({ ...props }) => (\r\n    <Covid19Marker {...props} />\r\n  ));\r\n  return <Fragment>{items}</Fragment>;\r\n}\r\n\r\nclass Covid19Map extends Component {\r\n\r\n  constructor() {\r\n    super();\r\n    this.modelAPI = new ModelAPI();\r\n\r\n    this.state = {\r\n      areasList : [],\r\n      worldCases: [],\r\n      worldDeaths: [],\r\n      markers: [],\r\n      stateMarkers: [],\r\n      countyMarkers: [],\r\n      renderStateCountyMarkers: [],\r\n      us: [],\r\n      renderUS: [],\r\n      callbackCounter: 0,\r\n      mapInitialized: false\r\n    };\r\n\r\n    this.modelAPI.areas(allAreas =>\r\n      this.setState({\r\n        areasList: allAreas\r\n      })\r\n    );\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.triggerRef(this);\r\n    this.fetchData(this.props.dynamicMapOn);\r\n  }\r\n\r\n  setCaseDeathData() {\r\n    if (this.state.callbackCounter > 1) {\r\n      let callbackCounter = 0;\r\n      this.setState({ callbackCounter });\r\n\r\n      if (!this.state.mapInitialized) {\r\n        let mapInitialized = true;\r\n        this.setState({ mapInitialized });\r\n        if (typeof(this.state.caseData) != \"undefined\" && typeof(this.state.deathData) != \"undefined\") {\r\n          for (var i = 0; i < global_lat_long.length; i++) {\r\n            let caseArea = this.state.caseData[i];\r\n            let deathArea = this.state.deathData[i];\r\n            let caseOpacity = 0.5;\r\n            if (caseArea.valueTrue === 0) {\r\n              caseOpacity = 0;\r\n            }\r\n            let deathOpacity = 1;\r\n            if (deathArea.valueTrue === 0) {\r\n              deathOpacity = 0;\r\n            }\r\n            if (i < 184) {\r\n              let compare = this.state.areasList[i].country + \" \";\r\n              if (\"US \" === compare) {\r\n                this.state.us.push({\r\n                  key: caseArea.name,\r\n                  caseKey: caseArea.name + \"-cases\",\r\n                  deathKey: caseArea.name + \"-deaths\",\r\n                  data: caseArea.name,\r\n                  center: [global_lat_long[i][1], global_lat_long[i][2]],\r\n                  caseRadius: 3 * this.getRadius(caseArea.caseValueTrue),\r\n                  deathRadius: 0.75 * this.getRadius(deathArea.deathValueTrue),\r\n                  caseValue: caseArea.caseValueTrue,\r\n                  deathValue: deathArea.deathValueTrue,\r\n                  population: populationVect[i][0],\r\n                  color: this.getColor(caseArea.caseValueTrue),\r\n                  caseOpacity: caseOpacity,\r\n                  deathOpacity: deathOpacity,\r\n                  stroke: true,\r\n                  onClick: (e) => this.handleMapClick(e)\r\n                });\r\n                this.state.renderUS.push(this.state.us[0]);\r\n              } else {\r\n                this.state.markers.push({\r\n                  key: caseArea.name,\r\n                  caseKey: caseArea.name + \"-cases\",\r\n                  deathKey: caseArea.name + \"-deaths\",\r\n                  data: caseArea.name,\r\n                  center: [global_lat_long[i][1], global_lat_long[i][2]],\r\n                  caseRadius: 3 * this.getRadius(caseArea.caseValueTrue),\r\n                  deathRadius: 0.75 * this.getRadius(deathArea.deathValueTrue),\r\n                  caseValue: caseArea.caseValueTrue,\r\n                  deathValue: deathArea.deathValueTrue,\r\n                  population: populationVect[i][0],\r\n                  color: this.getColor(caseArea.caseValueTrue),\r\n                  caseOpacity: caseOpacity,\r\n                  deathOpacity: deathOpacity,\r\n                  stroke: true,\r\n                  onClick: (e) => this.handleMapClick(e)\r\n                });\r\n              }\r\n            } else {\r\n              this.state.stateMarkers.push({\r\n                key: caseArea.id,\r\n                caseKey: caseArea.state + \"-cases\",\r\n                deathKey: caseArea.state + \"-deaths\",\r\n                data: caseArea.name +  \" / \" + caseArea.state,\r\n                center: [global_lat_long[i][1], global_lat_long[i][2]],\r\n                caseRadius: 3 * this.getRadius(caseArea.caseValueTrue),\r\n                deathRadius: 0.75 * this.getRadius(deathArea.deathValueTrue),\r\n                caseValue: caseArea.caseValueTrue,\r\n                deathValue: deathArea.deathValueTrue,\r\n                population: populationVect[i][0],\r\n                color: this.getColor(caseArea.caseValueTrue),\r\n                display: \"none\",\r\n                caseOpacity: caseOpacity,\r\n                deathOpacity: deathOpacity,\r\n                stroke: true,\r\n                onClick: (e) => this.handleMapClick(e)\r\n              });\r\n            }\r\n          }\r\n          let markers = this.state.markers;\r\n          let stateMarkers = this.state.stateMarkers;\r\n          let us = this.state.us;\r\n          this.setState({ markers, stateMarkers, us });\r\n        }\r\n      } else {\r\n        let usFound = false;\r\n        let stateCount = 0;\r\n        let markers = this.state.markers;\r\n        let stateMarkers = this.state.stateMarkers;\r\n        let us = this.state.us;\r\n        for (i = 0; i < global_lat_long.length; i++) {\r\n          let caseValue = this.state.caseData[i].caseValueTrue;\r\n          let deathValue = this.state.deathData[i].deathValueTrue;\r\n          let caseOpacity = 0.5;\r\n          if (caseValue === 0) {\r\n            caseOpacity = 0;\r\n          }\r\n          let deathOpacity = 1;\r\n          if (deathValue === 0) {\r\n            deathOpacity = 0;\r\n          }\r\n          if (i < 184) {\r\n            if (i === 155) {\r\n              usFound = true;\r\n              us[0].caseRadius = 3 * this.getRadius(caseValue);\r\n              us[0].caseValue = caseValue;\r\n              us[0].color = this.getColor(caseValue);\r\n              us[0].caseOpacity = caseOpacity;\r\n              us[0].deathRadius = 0.75 * this.getRadius(deathValue);\r\n              us[0].deathValue = deathValue;\r\n              us[0].deathOpacity = deathOpacity;\r\n            } else {\r\n              if (usFound) {\r\n                markers[i-1].caseRadius = 3 * this.getRadius(caseValue);\r\n                markers[i-1].caseValue = caseValue;\r\n                markers[i-1].color = this.getColor(caseValue);\r\n                markers[i-1].caseOpacity = caseOpacity;\r\n                markers[i-1].deathRadius = 0.75 * this.getRadius(deathValue);\r\n                markers[i-1].deathValue = deathValue;\r\n                markers[i-1].deathOpacity = deathOpacity;\r\n              } else {\r\n                markers[i].caseRadius = 3 * this.getRadius(caseValue);\r\n                markers[i].caseValue = caseValue;\r\n                markers[i].color = this.getColor(caseValue);\r\n                markers[i].caseOpacity = caseOpacity;\r\n                markers[i].deathRadius = 0.75 * this.getRadius(deathValue);\r\n                markers[i].deathValue = deathValue;\r\n                markers[i].deathOpacity = deathOpacity;\r\n              }\r\n            }\r\n          } else {\r\n            stateMarkers[stateCount].caseRadius = 3 * this.getRadius(caseValue);\r\n            stateMarkers[stateCount].caseValue = caseValue;\r\n            stateMarkers[stateCount].color = this.getColor(caseValue);\r\n            stateMarkers[stateCount].caseOpacity = caseOpacity;\r\n            stateMarkers[stateCount].deathRadius = 0.75 * this.getRadius(deathValue);\r\n            stateMarkers[stateCount].deathValue = deathValue;\r\n            stateMarkers[stateCount].deathOpacity = deathOpacity;\r\n            stateCount++;\r\n          }\r\n        }\r\n        this.setState({ markers, stateMarkers, us });\r\n      }\r\n    }\r\n  }\r\n\r\n  getCaseDeathData() {\r\n    this.modelAPI.cumulative_infections(cumulativeInfections => {\r\n      let caseData = cumulativeInfections.map(d => {\r\n        return {\r\n          id: d.area.iso_2,\r\n          name: d.area.country,\r\n          state: d.area.state,\r\n          area: d.area,\r\n          caseValue: Math.log(d.max_percentage),\r\n          caseValueTrue: d.value\r\n        };\r\n      });\r\n      let callbackCounter = this.state.callbackCounter;\r\n      callbackCounter++;\r\n      this.setState({ caseData, callbackCounter }, this.setCaseDeathData);\r\n    });\r\n    this.modelAPI.cumulative_death({\r\n      days: 0\r\n    }, cumulativeDeath => {\r\n      let deathData = cumulativeDeath.map(d => {\r\n        return {\r\n          id: d.area.iso_2,\r\n          name: d.area.country,\r\n          state: d.area.state,\r\n          area: d.area,\r\n          deathValue: Math.log(d.max_percentage),\r\n          deathValueTrue: d.value\r\n        };\r\n      });\r\n      let callbackCounter = this.state.callbackCounter;\r\n      callbackCounter++;\r\n      this.setState({ deathData, callbackCounter }, this.setCaseDeathData);\r\n    });\r\n  }\r\n\r\n  predictCaseDeathData() {\r\n    this.modelAPI.predict_all({\r\n      days: this.props.days,\r\n      model: this.props.confirmed_model\r\n    }, cumulativeInfections => {\r\n      let caseData = cumulativeInfections.map(d => {\r\n        return {\r\n          id: d.area.iso_2,\r\n          name: d.area.country,\r\n          state: d.area.state,\r\n          area: d.area,\r\n          caseValue: Math.log(d.max_val_percentage),\r\n          caseValueTrue: d.value\r\n        };\r\n      });\r\n      let callbackCounter = this.state.callbackCounter;\r\n      callbackCounter++;\r\n      this.setState({ caseData, callbackCounter }, this.setCaseDeathData);\r\n    });\r\n    this.modelAPI.predict_all({\r\n      days: this.props.days,\r\n      model: this.props.death_model\r\n    }, cumulativeInfections => {\r\n      let deathData = cumulativeInfections.map(d => {\r\n        return {\r\n          id: d.area.iso_2,\r\n          name: d.area.country,\r\n          state: d.area.state,\r\n          area: d.area,\r\n          deathValue: Math.log(d.max_death_percentage),\r\n          deathValueTrue: d.value\r\n        };\r\n      });\r\n      let callbackCounter = this.state.callbackCounter;\r\n      callbackCounter++;\r\n      this.setState({ deathData, callbackCounter }, this.setCaseDeathData);\r\n    });\r\n  }\r\n\r\n  getHistoryCumulative() {\r\n    this.modelAPI.history_cumulative({\r\n      days: this.props.days\r\n    }, historyCumulative => {\r\n      let caseData = historyCumulative.map(d => {\r\n        return {\r\n          id: d.area.iso_2,\r\n          name: d.area.country,\r\n          state: d.area.state,\r\n          area: d.area,\r\n          caseValue: Math.log(d.max_val_percentage),\r\n          caseValueTrue: d.value,\r\n          deathValue: Math.log(d.max_death_percentage),\r\n          deathValueTrue: d.deathValue\r\n        };\r\n      });\r\n      let deathData = caseData;\r\n      let callbackCounter = this.state.callbackCounter;\r\n      callbackCounter += 2;\r\n      this.setState({ caseData, deathData, callbackCounter }, this.setCaseDeathData);\r\n    });\r\n  }\r\n\r\n  newCases() {\r\n    if (this.props.days > 0) {\r\n      // prediction\r\n      this.modelAPI.predict_all({\r\n        days: this.props.days,\r\n        model: this.props.confirmed_model\r\n      }, cumulativeInfections => {\r\n        if (this.props.days > 7) {\r\n          this.modelAPI.predict_all({\r\n            days: this.props.days - 7,\r\n            model: this.props.confirmed_model\r\n          }, previousCumulative => {\r\n            let caseData = cumulativeInfections.map((d, index) => {\r\n              return {\r\n                id: d.area.iso_2,\r\n                name: d.area.country,\r\n                state: d.area.state,\r\n                area: d.area,\r\n                caseValue: d.value - previousCumulative[index].value > 0 ? Math.log(d.value - previousCumulative[index].value): 0,\r\n                caseValueTrue: d.value - previousCumulative[index].value > 0 ? d.value - previousCumulative[index].value: 0\r\n              };\r\n            });\r\n            let callbackCounter = this.state.callbackCounter;\r\n            callbackCounter++;\r\n            this.setState({ caseData, callbackCounter }, this.setCaseDeathData);\r\n          });\r\n        } else {\r\n          this.modelAPI.history_cumulative({\r\n            days: this.props.days - 7\r\n          }, previousCumulative => {\r\n            let caseData = cumulativeInfections.map((d, index) => {\r\n              return {\r\n                id: d.area.iso_2,\r\n                name: d.area.country,\r\n                state: d.area.state,\r\n                area: d.area,\r\n                caseValue: d.value - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).value > 0 ? Math.log(d.value - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).value): 0,\r\n                caseValueTrue: d.value - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).value > 0 ? d.value - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).value: 0\r\n              };\r\n            });\r\n            let callbackCounter = this.state.callbackCounter;\r\n            callbackCounter++;\r\n            this.setState({ caseData, callbackCounter }, this.setCaseDeathData);\r\n          });\r\n        }\r\n      });\r\n      this.modelAPI.predict_all({\r\n        days: this.props.days,\r\n        model: this.props.death_model\r\n      }, cumulativeInfections => {\r\n        if (this.props.days > 7) {\r\n          this.modelAPI.predict_all({\r\n            days: this.props.days - 7,\r\n            model: this.props.death_model\r\n          }, previousCumulative => {\r\n            let deathData = cumulativeInfections.map((d, index) => {\r\n              return {\r\n                id: d.area.iso_2,\r\n                name: d.area.country,\r\n                state: d.area.state,\r\n                deathValue: d.value - previousCumulative[index].value > 0 ? Math.log(d.value - previousCumulative[index].value): 0,\r\n                deathValueTrue: d.value - previousCumulative[index].value > 0 ? d.value - previousCumulative[index].value: 0\r\n              };\r\n            });\r\n            let callbackCounter = this.state.callbackCounter;\r\n            callbackCounter++;\r\n            this.setState({ deathData, callbackCounter }, this.setCaseDeathData);\r\n          });\r\n        } else {\r\n          this.modelAPI.history_cumulative({\r\n            days: this.props.days - 7\r\n          }, previousCumulative => {\r\n            let deathData = cumulativeInfections.map((d, index) => {\r\n              return {\r\n                id: d.area.iso_2,\r\n                name: d.area.country,\r\n                state: d.area.state,\r\n                deathValue: d.deathValue - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).deathValue > 0 ? Math.log(d.deathValue - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).deathValue): 0,\r\n                deathValueTrue: d.deathValue - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).deathValue > 0 ? d.deathValue - previousCumulative.find(x => x.area.iso_2 === d.area.iso_2).deathValue: 0\r\n              };\r\n            });\r\n            let callbackCounter = this.state.callbackCounter;\r\n            callbackCounter++;\r\n            this.setState({ deathData, callbackCounter }, this.setCaseDeathData);\r\n          });\r\n        }\r\n      });\r\n    } else {\r\n      // history\r\n      this.modelAPI.history_cumulative({\r\n        days: this.props.days,\r\n      }, historyInfections => {\r\n        this.modelAPI.history_cumulative({\r\n          days: this.props.days - 7,\r\n        }, nextDayCumulative => {\r\n          let caseData = historyInfections.map((d, index) => {\r\n            return {\r\n              id: d.area.iso_2,\r\n              name: d.area.country,\r\n              state: d.area.state,\r\n              caseValue: d.value - nextDayCumulative[index].value > 0 ? Math.log(d.value - nextDayCumulative[index].value): 0,\r\n              caseValueTrue: d.value - nextDayCumulative[index].value > 0 ? d.value - nextDayCumulative[index].value: 0,\r\n              deathValue: d.deathValue - nextDayCumulative[index].deathValue > 0 ? Math.log(d.deathValue - nextDayCumulative[index].deathValue): 0,\r\n              deathValueTrue: d.deathValue - nextDayCumulative[index].deathValue > 0 ? d.deathValue - nextDayCumulative[index].deathValue: 0\r\n            };\r\n          });\r\n          let deathData = caseData;\r\n          let callbackCounter = this.state.callbackCounter;\r\n          callbackCounter += 2;\r\n          this.setState({ caseData, deathData, callbackCounter }, this.setCaseDeathData);\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  fetchData(dynamicMapOn) {\r\n    if (!dynamicMapOn || (this.props.confirmed_model === \"\" && this.props.death_model === \"\")) {\r\n      // without dynamic map, show cumulative cases to date\r\n      this.getCaseDeathData();\r\n    } else {\r\n      // with dynamic map\r\n      if (this.props.statistic === \"cumulative\") {\r\n        if (this.props.days > 0) {\r\n          this.predictCaseDeathData();\r\n        } else {\r\n          // show history cumulative\r\n          this.getHistoryCumulative();\r\n        }\r\n      } else {\r\n        // new cases\r\n        this.newCases();\r\n      }\r\n    }\r\n  }\r\n\r\n  handleMapClick(e) {\r\n    const { onMapClick, onNoData } = this.props;\r\n    var area = e.target.options.data;\r\n    if (area) {\r\n      //console.log(\"Clicked on \" + area);\r\n      // if (area === \"US\") {\r\n      //   this.renderStatesCounties();\r\n      // }\r\n      // if (area.slice(0, 5) === \"US / \") {\r\n      //   this.renderUS();\r\n      // }\r\n      onMapClick(area);\r\n    } else {\r\n      onNoData(area);\r\n    }\r\n  }\r\n\r\n  getRadius(value) {\r\n    if (value === 0)\r\n      return value;\r\n  \tvar radius = Math.log(value / 1000);\r\n\r\n  \tif (radius < 0.5)\r\n  \t\tradius = 0.5;\r\n\r\n  \treturn radius;\r\n  }\r\n\r\n  getColor(d) {\r\n    d /= 10000;\r\n   \treturn d > 100 ? '#800026' :\r\n           d > 50  ? '#BD0026' :\r\n           d > 25  ? '#E31A1C' :\r\n           d > 10  ? '#FC4E2A' :\r\n           d > 5   ? '#FD8D3C' :\r\n           d > 2   ? '#FEB24C' :\r\n           d > 0.5   ? '#FED976' :\r\n                      '#FFEDA0';\r\n  }\r\n\r\n  renderUS() {\r\n    return <Covid19MarkerList markers={this.state.us} />;\r\n  }\r\n\r\n  renderStates() {\r\n    return <Covid19MarkerList markers={this.state.stateMarkers} />;\r\n  }\r\n\r\n  // renderUS() {\r\n  //   let renderUS = this.state.us;\r\n  //   let renderStateCountyMarkers = [];\r\n  //   this.setState({ renderUS, renderStateCountyMarkers });\r\n  // }\r\n\r\n  // renderStatesCounties() {\r\n  //   let renderStateCountyMarkers = this.state.stateMarkers;\r\n  //   let renderUS = [];\r\n  //   this.setState({ renderStateCountyMarkers, renderUS });\r\n  // }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Map\r\n          style={{ height: \"65vh\", width: \"100%\" }}\r\n          zoom={4}\r\n          minZoom={1}\r\n          center={[37.8, -96]}\r\n          ref={(ref) => { this.map = ref; }}\r\n          maxBounds={[\r\n            [90, -Infinity],\r\n            [-90, Infinity]\r\n          ]}\r\n          worldCopyJump={true}\r\n        >\r\n          <TileLayer url=\"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png\" />\r\n          <Covid19MarkerList markers={this.state.markers} />\r\n          {/* <Covid19MarkerList markers={this.state.renderUS} />\r\n          <Covid19MarkerList markers={this.state.renderStateCountyMarkers} /> */}\r\n          <LayersControl position=\"topright\">\r\n            <LayersControl.BaseLayer name=\"Show US Country\">\r\n              <LayerGroup>\r\n                {this.renderUS()}\r\n              </LayerGroup>\r\n            </LayersControl.BaseLayer>\r\n            <LayersControl.BaseLayer checked name=\"Show US State\">\r\n              <LayerGroup>\r\n                {this.renderStates()}\r\n              </LayerGroup>\r\n            </LayersControl.BaseLayer>\r\n          </LayersControl>\r\n        </Map>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Covid19Map;\r\n","import axios from \"axios\";\r\n\r\n// TODO: Update with actual backend URL once backend is up and running.\r\nconst API_BASE_URL = process.env.REACT_APP_BACKEND_BASE_URL;\r\n\r\nclass ModelAPI {\r\n  affected_by(callback) {}\r\n\r\n  areas(callback) {\r\n    const endpoint = `${API_BASE_URL}/areas`;\r\n    axios.get(endpoint).then(res => {\r\n      const allAreas = res.data;\r\n      callback(allAreas);\r\n    });\r\n  }\r\n\r\n  models(callback) {\r\n    const endpoint = `${API_BASE_URL}/models`;\r\n    axios.get(endpoint).then(res => {\r\n      const allModels = res.data;\r\n      callback(allModels);\r\n    });\r\n  }\r\n\r\n  infection_models(callback) {\r\n    const endpoint = `${API_BASE_URL}/infection_models`;\r\n    axios.get(endpoint).then(res => {\r\n      const infectionModels = res.data;\r\n      callback(infectionModels);\r\n    });\r\n  }\r\n\r\n  death_models(callback) {\r\n    const endpoint = `${API_BASE_URL}/death_models`;\r\n    axios.get(endpoint).then(res => {\r\n      const deathModels = res.data;\r\n      callback(deathModels);\r\n    });\r\n  }\r\n\r\n  cumulative_infections(callback) {\r\n    const endpoint = `${API_BASE_URL}/cumulative_infections`;\r\n    axios.get(endpoint).then(res => callback(res.data));\r\n  }\r\n\r\n  /**\r\n   * Params should have 'days', 'model'\r\n   */\r\n  predict_all(params, callback) {\r\n    const endpoint = `${API_BASE_URL}/predict_all`;\r\n    axios.get(endpoint, {\r\n      params: params\r\n    }).then(res => callback(res.data));\r\n  }\r\n\r\n  /**\r\n   * Params should have 'country', 'state', 'days', 'distancingOn,' 'distancingOff'\r\n   */\r\n  predict(params, callback) {\r\n    const endpoint = `${API_BASE_URL}/predict`;\r\n    axios\r\n      .get(endpoint, {\r\n        params: params\r\n      })\r\n      .then(res => {\r\n        callback(res.data);\r\n      });\r\n  }\r\n\r\n  // get the current date of observed data\r\n  getCurrentDate(callback) {\r\n    const endpoint =  `${API_BASE_URL}/current_date`;\r\n    axios.get(endpoint).then(res => {\r\n      const currentDate = res.data;\r\n      callback(currentDate);\r\n    });\r\n  }\r\n\r\n  //check previous data \r\n  checkHistory(params,callback)\r\n  {\r\n    const endpoint = `${API_BASE_URL}/check_history`;\r\n    axios\r\n      .get(endpoint, {\r\n        params: params\r\n      })\r\n      .then(res => {\r\n        callback(res.data);\r\n      });\r\n  }\r\n\r\n  //cumulative for history\r\n  history_cumulative(params, callback) {\r\n    const endpoint = `${API_BASE_URL}/history_cumulative`;\r\n    axios\r\n      .get(endpoint, {\r\n        params: params\r\n      })\r\n      .then(res => {\r\n        callback(res.data);\r\n      });\r\n  }\r\n\r\n  //get all quarantine score at a week, parameter: weeks\r\n  scores_all(params, callback) {\r\n    const endpoint = `${API_BASE_URL}/scores_all`;\r\n    axios\r\n      .get(endpoint, {\r\n        params: params\r\n      })\r\n      .then(res => {\r\n        callback(res.data);\r\n      });\r\n  }\r\n\r\n  //get all, parameter: state, country, weeks\r\n  scores(params, callback) {\r\n    const endpoint = `${API_BASE_URL}/scores`;\r\n    axios\r\n      .get(endpoint, {\r\n        params: params\r\n      })\r\n      .then(res => {\r\n        callback(res.data);\r\n      });\r\n  }\r\n\r\n  //get the latest date which \r\n  latest_score_date(callback) {\r\n    const endpoint =  `${API_BASE_URL}/latest_score_date`;\r\n    axios.get(endpoint).then(res => {\r\n      const latestDate = res.data;\r\n      callback(latestDate);\r\n    });\r\n  }\r\n\r\n  //get the death at latest time\r\n  cumulative_death(params, callback) {\r\n    const endpoint = `${API_BASE_URL}/cumulative_death`;\r\n    axios\r\n      .get(endpoint, {\r\n        params: params\r\n      })\r\n      .then(res => {\r\n        callback(res.data);\r\n      });\r\n  }\r\n\r\n  //get all mfr scores at a week: parameter week\r\n  all_mrf_scores(params, callback) {\r\n    const endpoint = `${API_BASE_URL}/all_mrf_scores`;\r\n    axios\r\n      .get(endpoint, {\r\n        params: params\r\n      })\r\n      .then(res => {\r\n        callback(res.data);\r\n      });\r\n  }\r\n\r\n  //fetch real time data for the whole world\r\n  real_time(callback) {\r\n    const EXTERNAL_API = \"https://api.covid19api.com/summary\";\r\n    axios\r\n      .get(EXTERNAL_API)\r\n      .then(res => {\r\n        const total_confirmed = res.data.Global.TotalConfirmed;\r\n        const total_deaths = res.data.Global.TotalDeaths;\r\n        const global = {\r\n          totalConfirmed: total_confirmed,\r\n          totalDeaths: total_deaths\r\n        }\r\n        callback(global);\r\n      }\r\n    )\r\n  }\r\n}\r\n\r\nexport default ModelAPI;\r\n","export function areaToStr(a) {\r\n  return `${a.country}${a.state ? \" / \" + a.state : \"\"}`;\r\n}\r\n\r\nexport function strToArea(s) {\r\n  const words = s.split(\"/\");\r\n\r\n  return {\r\n    country: words[0].trim(),\r\n    state: words.length === 2 ? words[1].trim() : \"\"\r\n  };\r\n}\r\n\r\nexport function modelToStr(a) {\r\n  return `${a.name}`;\r\n}\r\n","export const test_data = {\r\n  Japan: [\r\n    { date: \"2020-01-22\", value: 2, source: \"observed\" },\r\n    { date: \"2020-01-23\", value: 1, source: \"observed\" },\r\n    { date: \"2020-01-24\", value: 2, source: \"observed\" },\r\n    { date: \"2020-01-25\", value: 2, source: \"observed\" },\r\n    { date: \"2020-01-26\", value: 4, source: \"observed\" },\r\n    { date: \"2020-01-27\", value: 4, source: \"observed\" },\r\n    { date: \"2020-01-28\", value: 7, source: \"observed\" },\r\n    { date: \"2020-01-29\", value: 7, source: \"observed\" },\r\n    { date: \"2020-01-30\", value: 11, source: \"observed\" },\r\n    { date: \"2020-01-31\", value: 15, source: \"observed\" },\r\n    { date: \"2020-02-01\", value: 20, source: \"observed\" },\r\n    { date: \"2020-02-02\", value: 20, source: \"observed\" },\r\n    { date: \"2020-02-03\", value: 20, source: \"observed\" },\r\n    { date: \"2020-02-04\", value: 22, source: \"observed\" },\r\n    { date: \"2020-02-05\", value: 22, source: \"observed\" },\r\n    { date: \"2020-02-06\", value: 45, source: \"observed\" },\r\n    { date: \"2020-02-07\", value: 25, source: \"observed\" },\r\n    { date: \"2020-02-08\", value: 25, source: \"observed\" },\r\n    { date: \"2020-02-09\", value: 26, source: \"observed\" },\r\n    { date: \"2020-02-10\", value: 26, source: \"observed\" },\r\n    { date: \"2020-02-11\", value: 26, source: \"observed\" },\r\n    { date: \"2020-02-12\", value: 28, source: \"observed\" },\r\n    { date: \"2020-02-13\", value: 28, source: \"observed\" },\r\n    { date: \"2020-02-14\", value: 29, source: \"observed\" },\r\n    { date: \"2020-02-15\", value: 43, source: \"observed\" },\r\n    { date: \"2020-02-16\", value: 59, source: \"observed\" },\r\n    { date: \"2020-02-17\", value: 66, source: \"observed\" },\r\n    { date: \"2020-02-18\", value: 74, source: \"observed\" },\r\n    { date: \"2020-02-19\", value: 84, source: \"observed\" },\r\n    { date: \"2020-02-20\", value: 94, source: \"observed\" },\r\n    { date: \"2020-02-21\", value: 105, source: \"observed\" },\r\n    { date: \"2020-02-22\", value: 122, source: \"observed\" },\r\n    { date: \"2020-02-23\", value: 147, source: \"observed\" },\r\n    { date: \"2020-02-24\", value: 159, source: \"observed\" },\r\n    { date: \"2020-02-25\", value: 170, source: \"observed\" },\r\n    { date: \"2020-02-26\", value: 189, source: \"observed\" },\r\n    { date: \"2020-02-27\", value: 214, source: \"observed\" },\r\n    { date: \"2020-02-28\", value: 228, source: \"observed\" },\r\n    { date: \"2020-02-29\", value: 241, source: \"observed\" },\r\n    { date: \"2020-03-01\", value: 256, source: \"observed\" },\r\n    { date: \"2020-03-02\", value: 274, source: \"observed\" },\r\n    { date: \"2020-03-03\", value: 293, source: \"observed\" },\r\n    { date: \"2020-03-04\", value: 331, source: \"observed\" },\r\n    { date: \"2020-03-05\", value: 360, source: \"observed\" },\r\n    { date: \"2020-03-06\", value: 420, source: \"observed\" },\r\n    { date: \"2020-03-07\", value: 461, source: \"observed\" },\r\n    { date: \"2020-03-08\", value: 502, source: \"observed\" },\r\n    { date: \"2020-03-09\", value: 511, source: \"observed\" },\r\n    { date: \"2020-03-10\", value: 581, source: \"observed\" },\r\n    { date: \"2020-03-11\", value: 639, source: \"observed\" },\r\n    { date: \"2020-03-12\", value: 639, source: \"observed\" },\r\n    { date: \"2020-03-13\", value: 701, source: \"observed\" },\r\n    { date: \"2020-03-14\", value: 773, source: \"observed\" },\r\n    { date: \"2020-03-15\", value: 839, source: \"observed\" },\r\n    { date: \"2020-03-16\", value: 825, source: \"observed\" },\r\n    { date: \"2020-03-17\", value: 878, source: \"observed\" },\r\n    { date: \"2020-03-18\", value: 889, source: \"observed\" }\r\n  ],\r\n  \"US / California\": [\r\n    { date: \"2020-01-22\", value: 0, source: \"observed\" },\r\n    { date: \"2020-01-23\", value: 0, source: \"observed\" },\r\n    { date: \"2020-01-24\", value: 0, source: \"observed\" },\r\n    { date: \"2020-01-25\", value: 0, source: \"observed\" },\r\n    { date: \"2020-01-26\", value: 0, source: \"observed\" },\r\n    { date: \"2020-01-27\", value: 0, source: \"observed\" },\r\n    { date: \"2020-01-28\", value: 0, source: \"observed\" },\r\n    { date: \"2020-01-29\", value: 0, source: \"observed\" },\r\n    { date: \"2020-01-30\", value: 0, source: \"observed\" },\r\n    { date: \"2020-01-31\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-01\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-02\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-03\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-04\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-05\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-06\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-07\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-08\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-09\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-10\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-11\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-12\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-13\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-14\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-15\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-16\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-17\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-18\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-19\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-20\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-21\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-22\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-23\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-24\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-25\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-26\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-27\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-28\", value: 0, source: \"observed\" },\r\n    { date: \"2020-02-29\", value: 0, source: \"observed\" },\r\n    { date: \"2020-03-01\", value: 0, source: \"observed\" },\r\n    { date: \"2020-03-02\", value: 0, source: \"observed\" },\r\n    { date: \"2020-03-03\", value: 0, source: \"observed\" },\r\n    { date: \"2020-03-04\", value: 0, source: \"observed\" },\r\n    { date: \"2020-03-05\", value: 0, source: \"observed\" },\r\n    { date: \"2020-03-06\", value: 0, source: \"observed\" },\r\n    { date: \"2020-03-07\", value: 0, source: \"observed\" },\r\n    { date: \"2020-03-08\", value: 0, source: \"observed\" },\r\n    { date: \"2020-03-09\", value: 0, source: \"observed\" },\r\n    { date: \"2020-03-10\", value: 144, source: \"observed\" },\r\n    { date: \"2020-03-11\", value: 177, source: \"observed\" },\r\n    { date: \"2020-03-12\", value: 221, source: \"observed\" },\r\n    { date: \"2020-03-13\", value: 282, source: \"observed\" },\r\n    { date: \"2020-03-14\", value: 340, source: \"observed\" },\r\n    { date: \"2020-03-15\", value: 426, source: \"observed\" },\r\n    { date: \"2020-03-16\", value: 557, source: \"observed\" },\r\n    { date: \"2020-03-17\", value: 698, source: \"observed\" },\r\n    { date: \"2020-03-18\", value: 751, source: \"observed\" }\r\n  ],\r\n  Singapore: [\r\n    { date: \"2020-01-22\", value: 0, source: \"observed\" },\r\n    { date: \"2020-01-23\", value: 1, source: \"observed\" },\r\n    { date: \"2020-01-24\", value: 3, source: \"observed\" },\r\n    { date: \"2020-01-25\", value: 3, source: \"observed\" },\r\n    { date: \"2020-01-26\", value: 4, source: \"observed\" },\r\n    { date: \"2020-01-27\", value: 5, source: \"observed\" },\r\n    { date: \"2020-01-28\", value: 7, source: \"observed\" },\r\n    { date: \"2020-01-29\", value: 7, source: \"observed\" },\r\n    { date: \"2020-01-30\", value: 10, source: \"observed\" },\r\n    { date: \"2020-01-31\", value: 13, source: \"observed\" },\r\n    { date: \"2020-02-01\", value: 16, source: \"observed\" },\r\n    { date: \"2020-02-02\", value: 18, source: \"observed\" },\r\n    { date: \"2020-02-03\", value: 18, source: \"observed\" },\r\n    { date: \"2020-02-04\", value: 24, source: \"observed\" },\r\n    { date: \"2020-02-05\", value: 28, source: \"observed\" },\r\n    { date: \"2020-02-06\", value: 28, source: \"observed\" },\r\n    { date: \"2020-02-07\", value: 30, source: \"observed\" },\r\n    { date: \"2020-02-08\", value: 33, source: \"observed\" },\r\n    { date: \"2020-02-09\", value: 40, source: \"observed\" },\r\n    { date: \"2020-02-10\", value: 45, source: \"observed\" },\r\n    { date: \"2020-02-11\", value: 47, source: \"observed\" },\r\n    { date: \"2020-02-12\", value: 50, source: \"observed\" },\r\n    { date: \"2020-02-13\", value: 58, source: \"observed\" },\r\n    { date: \"2020-02-14\", value: 67, source: \"observed\" },\r\n    { date: \"2020-02-15\", value: 72, source: \"observed\" },\r\n    { date: \"2020-02-16\", value: 75, source: \"observed\" },\r\n    { date: \"2020-02-17\", value: 77, source: \"observed\" },\r\n    { date: \"2020-02-18\", value: 81, source: \"observed\" },\r\n    { date: \"2020-02-19\", value: 84, source: \"observed\" },\r\n    { date: \"2020-02-20\", value: 84, source: \"observed\" },\r\n    { date: \"2020-02-21\", value: 85, source: \"observed\" },\r\n    { date: \"2020-02-22\", value: 85, source: \"observed\" },\r\n    { date: \"2020-02-23\", value: 89, source: \"observed\" },\r\n    { date: \"2020-02-24\", value: 89, source: \"observed\" },\r\n    { date: \"2020-02-25\", value: 91, source: \"observed\" },\r\n    { date: \"2020-02-26\", value: 93, source: \"observed\" },\r\n    { date: \"2020-02-27\", value: 93, source: \"observed\" },\r\n    { date: \"2020-02-28\", value: 93, source: \"observed\" },\r\n    { date: \"2020-02-29\", value: 102, source: \"observed\" },\r\n    { date: \"2020-03-01\", value: 106, source: \"observed\" },\r\n    { date: \"2020-03-02\", value: 108, source: \"observed\" },\r\n    { date: \"2020-03-03\", value: 110, source: \"observed\" },\r\n    { date: \"2020-03-04\", value: 110, source: \"observed\" },\r\n    { date: \"2020-03-05\", value: 117, source: \"observed\" },\r\n    { date: \"2020-03-06\", value: 130, source: \"observed\" },\r\n    { date: \"2020-03-07\", value: 138, source: \"observed\" },\r\n    { date: \"2020-03-08\", value: 150, source: \"observed\" },\r\n    { date: \"2020-03-09\", value: 150, source: \"observed\" },\r\n    { date: \"2020-03-10\", value: 160, source: \"observed\" },\r\n    { date: \"2020-03-11\", value: 178, source: \"observed\" },\r\n    { date: \"2020-03-12\", value: 178, source: \"observed\" },\r\n    { date: \"2020-03-13\", value: 200, source: \"observed\" },\r\n    { date: \"2020-03-14\", value: 212, source: \"observed\" },\r\n    { date: \"2020-03-15\", value: 226, source: \"observed\" },\r\n    { date: \"2020-03-16\", value: 243, source: \"observed\" },\r\n    { date: \"2020-03-17\", value: 266, source: \"observed\" },\r\n    { date: \"2020-03-18\", value: 313, source: \"observed\" }\r\n  ]\r\n};\r\n","import React, { PureComponent, useState, Sonnet } from \"react\";\r\nimport Covid19Graph from \"./covid19graph\";\r\nimport Covid19Map from \"./covid19map\";\r\nimport ModelAPI from \"./modelapi\";\r\nimport { areaToStr, strToArea, modelToStr } from \"./covid19util\";\r\nimport { test_data } from \"./test_data\";\r\nimport \"./covid19predict.css\";\r\n// import Tabs from 'react-bootstrap/Tabs';\r\nimport { Tab, Tabs } from \"react-tabify\";\r\n// import Tab from 'react-bootstrap/Tab';\r\n// import Tabs from \"./tabs/Tabs\";\r\n\r\nimport {\r\n  Form,\r\n  Select,\r\n  InputNumber,\r\n  Button,\r\n  Radio,\r\n  Checkbox,\r\n  Slider,\r\n  Tooltip,\r\n  Switch,\r\n  Popover,\r\n  Alert,\r\n  Row,\r\n  Col,\r\n} from \"antd\";\r\n\r\nimport { InfoCircleOutlined } from \"@ant-design/icons\";\r\nimport { value } from \"numeral\";\r\nimport RadioGroup from \"antd/lib/radio/group\";\r\n\r\nconst { Option } = Select;\r\n\r\nclass Covid19Predict extends PureComponent {\r\n  handleYScaleSelect = e => {\r\n    console.log(e);\r\n    this.setState({\r\n      yScale: e.target.value,\r\n    });\r\n  };\r\n\r\n  handleStatisticSelect = e => {\r\n    this.setState(\r\n      {\r\n        statistic: e.target.value,\r\n      },\r\n      () => {\r\n        this.map.fetchData(this.state.dynamicMapOn);\r\n      }\r\n    );\r\n  };\r\n\r\n  handleDataTypeSelect = e => {\r\n    console.log(e);\r\n\r\n    this.setState({\r\n      dataType: e,\r\n    });\r\n  };\r\n\r\n  handleMapShownSelect = e => {\r\n    this.setState(\r\n      {\r\n        mapShown: e.target.value,\r\n      },\r\n      () => {\r\n        this.map.fetchData(this.state.dynamicMapOn);\r\n      }\r\n    );\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      areas: this.props.areas || [],\r\n      areasList: [],\r\n      models: this.props.models || [\"SI-kJalpha - Default\"],\r\n      modelsList: [],\r\n      currentDate: \"\",\r\n      firstDate: \"\",\r\n      current: true,\r\n      worst_effort: false,\r\n      best_effort: false,\r\n      mainGraphData: {},\r\n      days: 14,\r\n      dynamicMapOn: true,\r\n      dataType: [\"confirmed\"],\r\n      statistic: \"cumulative\",\r\n      mapShown: \"confirmed\",\r\n      yScale: \"linear\",\r\n      noDataError: false,\r\n      errorDescription: \"\",\r\n      showControlInstructions: false,\r\n      showMapInstructions: false,\r\n      totalConfirmed: 0,\r\n      totalDeaths: 0,\r\n      width: 0,\r\n      height: 0,\r\n    };\r\n\r\n    this.addAreaByStr = this.addAreaByStr.bind(this);\r\n    this.removeAreaByStr = this.removeAreaByStr.bind(this);\r\n    this.onValuesChange = this.onValuesChange.bind(this);\r\n    this.onMapClick = this.onMapClick.bind(this);\r\n    this.onDaysToPredictChange = this.onDaysToPredictChange.bind(this);\r\n    this.switchDynamicMap = this.switchDynamicMap.bind(this);\r\n    this.onAlertClose = this.onAlertClose.bind(this);\r\n    this.onNoData = this.onNoData.bind(this);\r\n    this.generateMarks = this.generateMarks.bind(this);\r\n    this.handleDataTypeSelect = this.handleDataTypeSelect.bind(this);\r\n    this.handleStatisticSelect = this.handleStatisticSelect.bind(this);\r\n    this.handleYScaleSelect = this.handleYScaleSelect.bind(this);\r\n    this.toggleControlInstructions = this.toggleControlInstructions.bind(this);\r\n    this.toggleMapInstructions = this.toggleMapInstructions.bind(this);\r\n    this.updateWindowDimensions = this.updateWindowDimensions.bind(this);\r\n  }\r\n\r\n  ////////////////////////////////////\r\n  componentDidMount() {\r\n    this.updateWindowDimensions();\r\n    window.addEventListener(\"resize\", this.updateWindowDimensions);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener(\"resize\", this.updateWindowDimensions);\r\n  }\r\n\r\n  updateWindowDimensions() {\r\n    this.setState({ width: window.innerWidth, height: window.innerHeight });\r\n  }\r\n\r\n  ////////////////////////////////////\r\n  componentWillMount = () => {\r\n    this.addAreaByStr(\"US\");\r\n\r\n    this.formRef = React.createRef();\r\n\r\n    this.modelAPI = new ModelAPI();\r\n\r\n    this.modelAPI.areas(allAreas =>\r\n      this.setState({\r\n        areasList: allAreas,\r\n      })\r\n    );\r\n\r\n    this.modelAPI.infection_models(infectionModels =>\r\n      this.setState(\r\n        {\r\n          modelsList: infectionModels,\r\n        },\r\n        () => {\r\n          this.modelAPI.death_models(deathModels => {\r\n            for (let i = 6; i < deathModels.length; ++i) {\r\n              this.setState(prevState => ({\r\n                modelsList: [...prevState.modelsList, deathModels[i]],\r\n              }));\r\n            }\r\n          });\r\n        }\r\n      )\r\n    );\r\n\r\n    this.modelAPI.getCurrentDate(currentDate =>\r\n      this.setState({\r\n        currentDate: currentDate[0].date,\r\n        firstDate: currentDate[0].firstDate,\r\n      })\r\n    );\r\n\r\n    this.modelAPI.real_time(global => {\r\n      this.setState({\r\n        totalConfirmed: global.totalConfirmed,\r\n        totalDeaths: global.totalDeaths,\r\n      });\r\n    });\r\n  };\r\n\r\n  onMapClick(area) {\r\n    if (!this.areaIsSelected(area)) {\r\n      // this.addAreaByStr(areaToStr(area));\r\n      this.addAreaByStr(area);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Returns true if the area is already selected by the user.\r\n   */\r\n  areaIsSelected(area) {\r\n    if (this.state.areas && area) {\r\n      // const newAreaStr = areaToStr(area);\r\n      // return this.state.areas.includes(newAreaStr);\r\n      return this.state.areas.includes(area);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  addAreaByStr(areaStr) {\r\n    const areaObj = strToArea(areaStr);\r\n\r\n    this.setState(\r\n      prevState => ({\r\n        areas: [...prevState.areas, areaStr],\r\n      }),\r\n      () => {\r\n        // check if days is positive or negative to decide whether check history or predict future\r\n        if (this.state.days >= 0) {\r\n          this.modelAPI.predict(\r\n            {\r\n              state: areaObj.state,\r\n              country: areaObj.country,\r\n              models: this.state.models,\r\n              days: this.state.days,\r\n              current: this.state.current,\r\n              worst_effort: this.state.worst_effort,\r\n              best_effort: this.state.best_effort,\r\n            },\r\n            data => {\r\n              this.setState(prevState => ({\r\n                mainGraphData: {\r\n                  ...prevState.mainGraphData,\r\n                  [areaStr]: data,\r\n                },\r\n              }));\r\n            }\r\n          );\r\n        } else {\r\n          this.modelAPI.checkHistory(\r\n            {\r\n              state: areaObj.state,\r\n              country: areaObj.country,\r\n              days: this.state.days,\r\n            },\r\n            data => {\r\n              this.setState(prevState => ({\r\n                mainGraphData: {\r\n                  ...prevState.mainGraphData,\r\n                  [areaStr]: data,\r\n                },\r\n              }));\r\n            }\r\n          );\r\n        }\r\n        if (this.formRef.current != null) {\r\n          this.formRef.current.setFieldsValue({\r\n            areas: this.state.areas,\r\n          });\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  removeAreaByStr(targetAreaStr) {\r\n    this.setState(prevState => {\r\n      return {\r\n        // Filter out the area / graph data corresponding to the target area\r\n        // string.\r\n        areas: prevState.areas.filter(areaStr => areaStr !== targetAreaStr),\r\n        mainGraphData: Object.keys(prevState.mainGraphData)\r\n          .filter(areaStr => areaStr !== targetAreaStr)\r\n          .reduce((newMainGraphData, areaStr) => {\r\n            return {\r\n              ...newMainGraphData,\r\n              [areaStr]: prevState.mainGraphData[areaStr],\r\n            };\r\n          }, {}),\r\n      };\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Returns true if the model is already selected by the user.\r\n   */\r\n  modelIsSelected(model) {\r\n    if (this.state.models && model) {\r\n      const newModelStr = modelToStr(model);\r\n      return this.state.models.includes(newModelStr);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * onValuesChange is called whenever the values in the form change. Note that\r\n   * days to predict is handled separately by onDaysToPredictChange.\r\n   */\r\n  onValuesChange(changedValues, allValues) {\r\n    const { dataType } = this.state;\r\n    if (\"socialDistancing\" in changedValues) {\r\n      // If either the social distancing or model parameters were changed, we\r\n      // clear our data and do a full reload. We purposely ignore days to\r\n      // predict here (see onDaysToPredictChange).\r\n      this.setState(\r\n        {\r\n          current: allValues.socialDistancing.includes(\"current\"),\r\n          worst_effort: allValues.socialDistancing.includes(\"worst_effort\"),\r\n          best_effort: allValues.socialDistancing.includes(\"best_effort\"),\r\n        },\r\n        () => {\r\n          this.reloadAll();\r\n        }\r\n      );\r\n    }\r\n    if (\"models\" in changedValues) {\r\n      this.setState(\r\n        {\r\n          models: changedValues.models,\r\n        },\r\n        () => {\r\n          this.reloadAll();\r\n        }\r\n      );\r\n    } else {\r\n      // If we're here it means the user either added or deleted an area, so we\r\n      // can do a union / intersection to figure out what to add/remove.\r\n      const prevAreas = this.state.areas;\r\n      const newAreas = allValues.areas;\r\n\r\n      const areasToAdd = newAreas.filter(\r\n        areaStr => !prevAreas.includes(areaStr)\r\n      );\r\n      const areasToRemove = prevAreas.filter(\r\n        areaStr => !newAreas.includes(areaStr)\r\n      );\r\n\r\n      areasToAdd.forEach(this.addAreaByStr);\r\n      areasToRemove.forEach(this.removeAreaByStr);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * onDaysToPredictChange is bound to the 'onAfterChange' prop for the\r\n   * slider component, so this function will only be called on the mouseup\r\n   * event (to reduce database load).\r\n   */\r\n  onDaysToPredictChange(days) {\r\n    const prevAreas = this.state.areas;\r\n    this.setState({ days }, () => {\r\n      this.reloadAll();\r\n    });\r\n  }\r\n\r\n  // Set the reference to the map component as a child-component.\r\n  bindRef = ref => {\r\n    this.map = ref;\r\n  };\r\n\r\n  /**\r\n   * reloadAll refreshes the prediction data for all currently-selected\r\n   * countries.\r\n   */\r\n  reloadAll() {\r\n    const prevAreas = this.state.areas;\r\n    this.setState(\r\n      {\r\n        areas: [],\r\n        mainGraphData: {},\r\n      },\r\n      () => {\r\n        // Add all the areas back.\r\n        prevAreas.forEach(this.addAreaByStr);\r\n\r\n        // TODO: Add code for stuff after reload here!\r\n        // Force reload the heatmap, only refetch data when dynamic map is on\r\n        if (this.state.dynamicMapOn && this.state.models.length !== 0) {\r\n          this.map.fetchData(this.state.dynamicMapOn);\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  switchDynamicMap(checked) {\r\n    this.setState({\r\n      dynamicMapOn: checked,\r\n    });\r\n    this.map.fetchData(checked);\r\n  }\r\n\r\n  //when closing the alert\r\n  onAlertClose = () => {\r\n    this.setState({\r\n      noDataError: false,\r\n    });\r\n  };\r\n\r\n  //when encounter an no data error\r\n  onNoData = name => {\r\n    this.setState({\r\n      noDataError: true,\r\n      errorDescription: `There is currently no data for ${name}`,\r\n    });\r\n  };\r\n\r\n  generateMarks = () => {\r\n    const { currentDate, days, firstDate } = this.state;\r\n    let date = new Date(`${currentDate}T00:00`);\r\n    let beginDate = new Date(`${firstDate}T00:00`);\r\n    //get the date of the selected date on slider\r\n    date.setDate(date.getDate(Date) + days);\r\n    let marks = {};\r\n    marks[days] = `${date.getMonth() + 1}/${date.getDate()}`;\r\n    // marks for future\r\n    let i = days + 7;\r\n    let skip = 1;\r\n    const skip_factor = 1 + Math.floor(2000.0 / this.state.width);\r\n    while (i < days + 50 && i <= 99) {\r\n      date.setDate(date.getDate() + 7);\r\n      if (!(skip % skip_factor)) {\r\n        marks[i] = `${date.getMonth() + 1}/${date.getDate()}`;\r\n      } else {\r\n        marks[i] = ``;\r\n      }\r\n      i += 7;\r\n      skip += 1;\r\n    }\r\n    // marks for history\r\n    date = new Date(`${currentDate}T00:00`);\r\n    date.setDate(date.getDate(Date) + days);\r\n    date.setDate(date.getDate() - 7);\r\n    i = days - 7;\r\n    skip = 1;\r\n    while (date >= beginDate && i > days - 30) {\r\n      if (!(skip % skip_factor)) {\r\n        marks[i] = `${date.getMonth() + 1}/${date.getDate()}`;\r\n      } else {\r\n        marks[i] = ``;\r\n      }\r\n      date.setDate(date.getDate() - 7);\r\n      i -= 7;\r\n      skip += 1;\r\n    }\r\n    return marks;\r\n  };\r\n\r\n  getDaysToFirstDate = () => {\r\n    const { currentDate, firstDate } = this.state;\r\n    let date = new Date(`${currentDate}T00:00`);\r\n    let beginningDate = new Date(`${firstDate}T00:00`);\r\n    return Math.ceil(Math.abs(date - beginningDate) / (1000 * 60 * 60 * 24));\r\n  };\r\n\r\n  toggleControlInstructions = () => {\r\n    const showControlInstructions = this.state.showControlInstructions;\r\n    this.setState({\r\n      showControlInstructions: !showControlInstructions,\r\n    });\r\n  };\r\n\r\n  toggleMapInstructions = () => {\r\n    const showMapInstructions = this.state.showMapInstructions;\r\n    this.setState({\r\n      showMapInstructions: !showMapInstructions,\r\n    });\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      areas,\r\n      areasList,\r\n      models,\r\n      modelsList,\r\n      days,\r\n      mainGraphData,\r\n      dynamicMapOn,\r\n      dataType,\r\n      statistic,\r\n      mapShown,\r\n      yScale,\r\n      noDataError,\r\n      errorDescription,\r\n    } = this.state;\r\n    const marks = this.generateMarks();\r\n    const daysToFirstDate = this.getDaysToFirstDate();\r\n    // Only show options for countries that have not been selected yet.\r\n    const countryOptions = areasList\r\n      .filter(area => !this.areaIsSelected(area))\r\n      .map(areaToStr)\r\n      .sort()\r\n      .map(s => {\r\n        return <Option key={s}> {s} </Option>;\r\n      });\r\n\r\n    const modelOptions = modelsList\r\n      .filter(model => !this.modelIsSelected(model))\r\n      .map(model => {\r\n        return (\r\n          <Option key={model.name} value={model.name}>\r\n            <Tooltip title={model.description} placement=\"right\">\r\n              {model.name}\r\n            </Tooltip>\r\n          </Option>\r\n        );\r\n      });\r\n\r\n    const instructionContentStyle = {\r\n      width: \"60vh\",\r\n    };\r\n\r\n    // Instruction messages for each form items.\r\n    const CONTROL_INSTRUCTIONS = {\r\n      area: (\r\n        <p className=\"instruction\">\r\n          Select the areas by clicking on the map or searching in this input\r\n          box.\r\n        </p>\r\n      ),\r\n\r\n      model: (\r\n        <div className=\"instruction\">\r\n          <p className=\"instruction\">\r\n            \"SI-kJalpha - 20x \" assumes that the true positive cases are 20\r\n            times the current reported cases. \"SI-kJalpha-Default\" is our best\r\n            guess.\r\n          </p>\r\n        </div>\r\n      ),\r\n\r\n      date: (\r\n        <p className=\"instruction\">\r\n          Predictions up to the date selected will be shown.\r\n        </p>\r\n      ),\r\n\r\n      socialDistancing: (\r\n        <p className=\"instruction\">\r\n          Compare different social distancing scenarios.\r\n        </p>\r\n      ),\r\n\r\n      data_type: (\r\n        <p className=\"instruction\">\r\n          Select the forecasts for cumulative infections or/and deaths.\r\n        </p>\r\n      ),\r\n\r\n      statistics: (\r\n        <p className=\"instruction\">\r\n          Switch between cumulative view and incident view.\r\n        </p>\r\n      ),\r\n\r\n      scale: (\r\n        <p className=\"instruction\">\r\n          Switch between linear view and logarithmic view.\r\n        </p>\r\n      ),\r\n    };\r\n\r\n    const MAP_INSTRUCTION = {\r\n      selectMap: (\r\n        <p className=\"instruction vertical\">\r\n          Hover over the bubbles to see case and death data. Select to add to the plot. Button on the top right to toggle between US states and the country.\r\n        </p>\r\n      ),\r\n      dynamicMap: (\r\n        <p className=\"instruction vertical\">\r\n          Enable the map to dynamically change to reflect the data and\r\n          predictions based on the selected options. Turn off if the interface\r\n          seems slow.\r\n        </p>\r\n      ),\r\n\r\n      radioGroup: (\r\n        <p className=\"instruction vertical\">\r\n          Switch between cumulative infection view or death view on the heatmap.\r\n        </p>\r\n      ),\r\n    };\r\n\r\n    const tabTheme = {\r\n      tabs: {\r\n        color: \"black\",\r\n        active: {\r\n          color: \"#990000\",\r\n        },\r\n      },\r\n    };\r\n\r\n    // Generate the global overview paragraph\r\n    let overview = \"\";\r\n\r\n    // In case we cannot fetch data from the external API,\r\n    // the overview will not show up.\r\n    if (this.state.totalConfirmed != 0 && this.state.totalDeaths != 0) {\r\n      const today = new Date();\r\n      const dd = String(today.getDate()).padStart(2, \"0\");\r\n      const mm = String(today.getMonth() + 1).padStart(2, \"0\"); //January is 0!\r\n      const yyyy = today.getFullYear();\r\n\r\n      //today = mm + '/' + dd + '/' + yyyy;\r\n      const totalConfirmed = this.state.totalConfirmed\r\n        .toString()\r\n        .replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n      const totalDeaths = this.state.totalDeaths\r\n        .toString()\r\n        .replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n      overview =\r\n        \"By \" +\r\n        mm +\r\n        \"/\" +\r\n        dd +\r\n        \"/\" +\r\n        yyyy +\r\n        \", \" +\r\n        totalConfirmed +\r\n        \" people around the world have been tested positive, and \" +\r\n        totalDeaths +\r\n        \" people have died of COVID-19.\";\r\n    }\r\n\r\n    let confirmed_model_map = \"\";\r\n    let death_model_map = \"\";\r\n    for (let i = models.length - 1; i >= 0; i--) {\r\n      if (models[i].substring(0, 10) === \"SI-kJalpha\") {\r\n        confirmed_model_map = models[i];\r\n        if (death_model_map.length === 0) {\r\n          death_model_map = models[i] + \" (death prediction)\";\r\n        }\r\n        break;\r\n      } else {\r\n        death_model_map = models[i];\r\n      }\r\n    }\r\n\r\n    const Heading = (\r\n      <div id=\"header\" className=\"text-center\">\r\n        <div id=\"overview\">\r\n          <b>{overview}</b>\r\n        </div>\r\n      </div>\r\n    );\r\n    return (\r\n      <div className=\"covid-19-predict\">\r\n        {Heading}\r\n        <div>\r\n          <Row type=\"flex\" justify=\"center\" id=\"charts\">\r\n            {noDataError ? (\r\n              <Alert\r\n                message={`${errorDescription}`}\r\n                description=\"Please wait for our updates.\"\r\n                type=\"error\"\r\n                closable\r\n                onClose={this.onAlertClose}\r\n              />\r\n            ) : null}\r\n            <div className=\"form-column\">\r\n              <div>\r\n                <div className=\"form-wrapper gray\" id=\"graph_options\">\r\n                  <Form\r\n                    ref={this.formRef}\r\n                    onValuesChange={this.onValuesChange}\r\n                    initialValues={{\r\n                      areas: areas,\r\n                      models: models,\r\n                      days: 14,\r\n                      socialDistancing: [\"current\"],\r\n                    }}\r\n                  >\r\n                    <Popover\r\n                      content={CONTROL_INSTRUCTIONS.area}\r\n                      placement=\"top\"\r\n                      visible={this.state.showControlInstructions}\r\n                    >\r\n                      <Form.Item\r\n                        style={{ marginBottom: \"0px\" }}\r\n                        label=\"Areas\"\r\n                        name=\"areas\"\r\n                        rules={[\r\n                          { required: true, message: \"Please select areas!\" },\r\n                        ]}\r\n                      >\r\n                        <Select\r\n                          mode=\"multiple\"\r\n                          style={{ width: \"100%\" }}\r\n                          placeholder=\"Select Areas\"\r\n                        >\r\n                          {countryOptions}\r\n                        </Select>\r\n                      </Form.Item>\r\n                    </Popover>\r\n                    <Popover\r\n                      content={CONTROL_INSTRUCTIONS.model}\r\n                      placement=\"rightTop\"\r\n                      visible={this.state.showControlInstructions}\r\n                      //content={<div style={instructionContentStyle} />}\r\n                      align={{\r\n                        overflow: { adjustX: false, adjustY: false },\r\n                      }}\r\n                    >\r\n                      <Form.Item\r\n                        style={{ marginBottom: \"0px\" }}\r\n                        label=\"Models:\"\r\n                        name=\"models\"\r\n                        rules={[\r\n                          {\r\n                            required: true,\r\n                            message: \"Please select a prediction model!\",\r\n                          },\r\n                        ]}\r\n                      >\r\n                        <Select\r\n                          mode=\"multiple\"\r\n                          style={{ width: \"100%\" }}\r\n                          placeholder=\"Select Prediction Models\"\r\n                        >\r\n                          {modelOptions}\r\n                        </Select>\r\n                      </Form.Item>\r\n                    </Popover>\r\n                    <Popover\r\n                      placement=\"rightBottom\"\r\n                      content={CONTROL_INSTRUCTIONS.date}\r\n                      visible={this.state.showControlInstructions}\r\n                    >\r\n                      <Form.Item label=\"Date to Predict\" name=\"days\">\r\n                        <Slider\r\n                          marks={marks}\r\n                          min={\r\n                            days - 30 >= -daysToFirstDate\r\n                              ? days - 30\r\n                              : -daysToFirstDate\r\n                          }\r\n                          initialValue={days}\r\n                          max={days + 50 <= 99 ? days + 50 : 99}\r\n                          onAfterChange={this.onDaysToPredictChange}\r\n                          step={null}\r\n                          tooltipVisible={false}\r\n                        />\r\n                      </Form.Item>\r\n                    </Popover>\r\n                    <Popover\r\n                      content={CONTROL_INSTRUCTIONS.socialDistancing}\r\n                      placement=\"right\"\r\n                      visible={this.state.showControlInstructions}\r\n                    >\r\n                      <Form.Item\r\n                        label=\"Social Distancing\"\r\n                        name=\"socialDistancing\"\r\n                        style={{ marginBottom: \"0px\" }}\r\n                      >\r\n                        <Checkbox.Group style={{ width: \"100%\" }}>\r\n                          <Row>\r\n                            <Checkbox defaultChecked value=\"current\">\r\n                              Current Trend\r\n                            </Checkbox>\r\n                            <Checkbox value=\"worst_effort\">\r\n                              Worst Distancing Effort\r\n                            </Checkbox>\r\n                            <Checkbox value=\"best_effort\">\r\n                              Best Distancing Effort\r\n                            </Checkbox>\r\n                          </Row>\r\n                        </Checkbox.Group>\r\n                      </Form.Item>\r\n                    </Popover>\r\n                  </Form>\r\n                  <Form>\r\n                    <Popover\r\n                      content={CONTROL_INSTRUCTIONS.data_type}\r\n                      placement=\"right\"\r\n                      visible={this.state.showControlInstructions}\r\n                    >\r\n                      <Form.Item\r\n                        label=\"Data Types\"\r\n                        style={{ marginBottom: \"0px\" }}\r\n                      >\r\n                        <Checkbox.Group\r\n                          value={dataType}\r\n                          onChange={this.handleDataTypeSelect}\r\n                        >\r\n                          <Checkbox defaultChecked value=\"confirmed\">\r\n                            Confirmed Cases\r\n                          </Checkbox>\r\n                          <Checkbox value=\"death\">Deaths</Checkbox>\r\n                        </Checkbox.Group>\r\n                      </Form.Item>\r\n                    </Popover>\r\n                    <Popover\r\n                      content={CONTROL_INSTRUCTIONS.statistics}\r\n                      placement=\"right\"\r\n                      visible={this.state.showControlInstructions}\r\n                    >\r\n                      <Form.Item\r\n                        label=\"Statistic\"\r\n                        style={{ marginBottom: \"0px\" }}\r\n                      >\r\n                        <Radio.Group\r\n                          value={statistic}\r\n                          onChange={this.handleStatisticSelect}\r\n                        >\r\n                          <Radio value=\"cumulative\">Cumulative Cases</Radio>\r\n                          <Radio value=\"delta\">New Cases</Radio>\r\n                        </Radio.Group>\r\n                      </Form.Item>\r\n                    </Popover>\r\n                    <Popover\r\n                      content={CONTROL_INSTRUCTIONS.scale}\r\n                      placement=\"right\"\r\n                      visible={this.state.showControlInstructions}\r\n                    >\r\n                      <Form.Item label=\"Scale\" style={{ marginBottom: \"0px\" }}>\r\n                        <Radio.Group\r\n                          value={yScale}\r\n                          onChange={this.handleYScaleSelect}\r\n                        >\r\n                          <Radio value=\"linear\">Linear</Radio>\r\n                          <Radio value=\"log\">Logarithmic</Radio>\r\n                        </Radio.Group>\r\n                      </Form.Item>\r\n                    </Popover>\r\n                  </Form>\r\n                </div>\r\n              </div>\r\n              {areas.length ? (\r\n                <div>\r\n                  <div className=\"graph-wrapper\">\r\n                    <Covid19Graph\r\n                      data={mainGraphData}\r\n                      dataType={dataType}\r\n                      onNoData={this.onNoData}\r\n                      statistic={statistic}\r\n                      yScale={yScale}\r\n                    ></Covid19Graph>\r\n                  </div>\r\n                </div>\r\n              ) : null}\r\n            </div>\r\n            <div className=\"map-column\">\r\n              <div className=\"form-wrapper gray\" id=\"graph_options\">\r\n                <div>\r\n                  <span className=\"map-control\">\r\n                    <Popover\r\n                      content={MAP_INSTRUCTION.dynamicMap}\r\n                      placement=\"bottom\"\r\n                      visible={this.state.showMapInstructions}\r\n                    >\r\n                      <Switch defaultChecked onChange={this.switchDynamicMap} />\r\n                      <b>&nbsp;&nbsp;Dynamic Map&nbsp;&nbsp;</b>\r\n                    </Popover>\r\n                  </span>\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <div className=\"map-wrapper\">\r\n                <Popover\r\n                      content={MAP_INSTRUCTION.selectMap}\r\n                      placement=\"leftBottom\"\r\n                      visible={this.state.showMapInstructions}\r\n                    >\r\n                  <Covid19Map\r\n                    className=\"map\"\r\n                    triggerRef={this.bindRef}\r\n                    dynamicMapOn={dynamicMapOn}\r\n                    days={days}\r\n                    confirmed_model={confirmed_model_map}\r\n                    death_model={death_model_map}\r\n                    onMapClick={this.onMapClick}\r\n                    onNoData={this.onNoData}\r\n                    statistic={statistic}\r\n                    dataType={mapShown}\r\n                  />\r\n                  </Popover>\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <div className=\"instruction-buttons-wrapper\">\r\n                  <Button\r\n                    className=\"instruction-button\"\r\n                    onClick={this.toggleControlInstructions}\r\n                  >\r\n                    {this.state.showControlInstructions == false\r\n                      ? \"Help with controls\"\r\n                      : \"Close control instructions\"}\r\n                  </Button>\r\n                  <Button\r\n                    className=\"instruction-button\"\r\n                    onClick={this.toggleMapInstructions}\r\n                  >\r\n                    {this.state.showMapInstructions == false\r\n                      ? \"Help with the map\"\r\n                      : \"Close map instructions\"}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </Row>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Covid19Predict;\r\n","import React, { Component } from \"react\";\r\nimport \"./aboutus.css\";\r\nimport \"./covid19app.css\";\r\n\r\nclass AboutUs extends Component {\r\n    render() {\r\n        return (\r\n            <div className=\"page-wrapper\">\r\n                <div className=\"article\">\r\n                    <h1 className=\"article-title\">ReCOVER: Accurate Predictions and Resource Management for COVID-19 Epidemic Response</h1>\r\n                    <p className=\"article-paragraph\">\r\n                        Accurate forecasts of COVID-19 is central to resource management and building strategies to deal with the epidemic. \r\n                        This is an NSF-funded project on COVID-19 forecasting led by\r\n                        by <a className=\"article-anchor\" href=\"https://sites.usc.edu/prasanna/\"> Viktor K. Prasanna </a> and <a className=\"article-anchor\" href=\"http://www-scf.usc.edu/~ajiteshs/\"> Ajitesh Srivastava </a> \r\n                        from the <a className=\"article-anchor\" href=\"https://dslab.usc.edu/\"> Data Science Lab </a> at the University of Southern California. \r\n                    </p>\r\n                    <h2>Our Approach</h2>\r\n                    <p className=\"article-paragraph\">\r\n                        We use our own epidemic model called <a className=\"article-anchor\" href=\"https://arxiv.org/abs/2007.05180\"> SI-kJalpha</a>, preliminary version of which we have successfully used \r\n                        during <a className=\"article-anchor\" href=\"https://news.usc.edu/83180/usc-engineers-earn-national-recognition-for-predicting-disease-outbreaks/\" target=\"_blank\">\r\n                            DARPA Grand Challenge 2014\r\n                        </a>.   \r\n                        Our forecast appears on the official <a className=\"article-anchor\" href=\"https://www.cdc.gov/coronavirus/2019-ncov/covid-data/forecasting-us.html\"> CDC webpage</a>.\r\n\t\t\t Our model can consider the effect of many complexities of the epidemic process and yet be simplified to a few parameters that are learned using fast linear regressions. Therefore, our approach can learn and generate forecasts extremely quickly. On a 2 core desktop machine, our approach takes only 3.18s to tune hyper-parameters, learn parameters and generate 100 days of forecasts of reported cases and deaths for all the states in the US. The total execution time for 184 countries is 11.83s and for more than 3000 US counties is 101.03s. Despite being fast, the accuracy of our forecasts is on par with the state-of-the-art as demonstrated on the <a className=\"article-anchor\" href=\"https://scc-usc.github.io/ReCOVER-COVID-19/#/leaderboard\"> leaderboard page</a>. Details of modeling and comparisons can be found in <a className=\"article-anchor\" href=\"https://arxiv.org/abs/2007.05180\"> our paper</a>.\r\n                        This work is supported by National Science Foundation Award No. 2027007 (RAPID)\r\n                    </p>\r\n\r\n                    <p className=\"article-paragraph\">\r\n                        The <a className=\"article-anchor\" href=\"https://github.com/scc-usc/ReCOVER-COVID-19\" target=\"_blank\"> Github repository </a> for this project is publicly available.\r\n                    </p>\r\n                    <p className=\"article-paragraph\">\r\n                        The matlab code for forecasting is also made available on <a className=\"article-anchor\" href=\"https://www.mathworks.com/matlabcentral/fileexchange/75281-recover\" target=\"_blank\">File Exchange</a>. For the latest code, please see the Github repo.\r\n                    </p>\r\n\r\n        \t\t\t<p className=\"article-paragraph\"> The code of the prediction model and this web application is contributed by Ajitesh Srivastava, Jamin Chen, Frost Tianjian Xu, and Bob Xiaochen Yang. </p>\r\n                    \r\n        \t\t\t<p className=\"article-paragraph\"> The forecast visualization is further implemented by James Orme-Rogers, James Wolfe, Sung Bin Kim, and Vicky Yu. </p>\r\n\r\n                    <h2>Related Papers</h2>\r\n\r\n                    <ol className=\"article-paragraph\">\r\n\t\t\t<li>\r\n                            Ajitesh Srivastava, Tianjian Xu and Viktor K. Prasanna, \r\n                            <a className=\"article-anchor\" href=\"https://arxiv.org/abs/2007.05180\" target=\"_blank\"> \"Fast and Accurate Forecasting of COVID-19 Deaths using the SIkJalpha Model\"</a> [arXiv].\r\n                        </li>\r\n                        <li>\r\n                            Ajitesh Srivastava and Viktor K. Prasanna, \r\n                            <a className=\"article-anchor\" href=\"https://arxiv.org/abs/2006.02127\" target=\"_blank\"> \"Data-driven Identification of Number of Unreported Cases for COVID-19: Bounds and Limitations\"</a> [arXiv]. Accepted at KDD 2020.\r\n                        </li>\r\n                        <li>\r\n                            Ajitesh Srivastava and Viktor K. Prasanna, \r\n                            <a className=\"article-anchor\" href=\"https://arxiv.org/abs/2004.11372\" target=\"_blank\"> \"Learning to Forecast and Forecasting to Learn from the COVID-19 Pandemic\"</a> [arXiv]. \r\n                        </li>\r\n\r\n                    </ol>\r\n\t\t\t<h2>Other Links</h2>\r\n                    <ol className=\"article-paragraph\">\r\n                    <li>\r\n                        <a className=\"article-anchor\" href=\"https://www.youtube.com/watch?v=dBye3euqlKc\" target=\"_blank\"> Lightning talk </a> presenting the status (October).\r\n                    </li>\r\n                        <li>\r\n                        <a className=\"article-anchor\" href=\"https://www.youtube.com/watch?v=ll6k8wlxOFo\" target=\"_blank\">Webinar </a> describing our intial approach (April).\r\n                    </li></ol>\r\n\r\n\t\t\t\r\n                    <h2>USC Data Science Lab</h2>\r\n                    <p className=\"article-paragraph\">\r\n                        The USC Data Science Lab focuses on applying machine learning, data mining, \r\n                        and network analysis to real-world problems in society and industry. \r\n                        Please find more information and other research projects <a className=\"article-anchor\" href=\"https://sites.usc.edu/dslab/\" target=\"_blank\"> on \r\n                        our website</a>.\r\n                    </p>\r\n\r\n                </div>\r\n            </div>\r\n\r\n        );\r\n    }\r\n}\r\n\r\nexport default AboutUs;","import React, { Component } from \"react\";\r\nimport { ResponsiveLine} from \"@nivo/line\";\r\nimport moment from \"moment\";\r\nimport numeral from \"numeral\";\r\nimport {\r\n  red,\r\n  gold,\r\n  lime,\r\n  cyan,\r\n  geekblue,\r\n  purple,\r\n  magenta\r\n} from \"@ant-design/colors\";\r\n\r\nfunction getLineColor(index) {\r\n  const colors = [\r\n    red,\r\n    gold,\r\n    lime,\r\n    cyan,\r\n    geekblue,\r\n    purple,\r\n    magenta\r\n  ];\r\n\r\n  return colors[index % colors.length];\r\n}\r\n\r\nconst DashedLine = ({ series, lineGenerator, xScale, yScale }) => {\r\n  return series.map(({ id, data, color, predicted, distancing }) => {\r\n    let style = {\r\n      strokeWidth: 5\r\n    };\r\n\r\n    // Add custom style if predicted.\r\n    if (predicted) {\r\n      if (distancing) {\r\n        style.strokeDasharray = \"6, 4\";\r\n      } else {\r\n        // Display a sparser pattern for no social distancing.\r\n        style.strokeDasharray = \"2, 6\";\r\n      }\r\n    }\r\n\r\n    return (\r\n      <path\r\n        key={id}\r\n        d={lineGenerator(\r\n          data.map(d => ({\r\n            x: xScale(d.data.x),\r\n            y: yScale(d.data.y)\r\n          }))\r\n        )}\r\n        fill=\"none\"\r\n        stroke={color}\r\n        style={style}\r\n      />\r\n    );\r\n  });\r\n};\r\n\r\nconst theme = {\r\n  axis: {\r\n    ticks: {\r\n      text: {\r\n        fontSize: 18\r\n      }\r\n    },\r\n    legend: {\r\n      text: {\r\n        fontSize: 18\r\n      }\r\n    }\r\n  },\r\n  legends: {\r\n    text: {\r\n      fontSize: 18\r\n    }\r\n  }\r\n};\r\n\r\nclass ScoreGraph extends Component {\r\n  parseDate(dateStr) {\r\n    let [year, month, day] = dateStr.split(\"-\").map(Number);\r\n    // Month in JS is 0-based.\r\n    month -= 1;\r\n    return new Date(year, month, day);\r\n  }\r\n\r\n  /**\r\n   * Given a time series returned by the predict endpoint, getCumulativeData\r\n   * returns it in Nivo format.\r\n   */\r\n  getCumulativeData(data) {\r\n    return data.map(d => ({\r\n      x: this.parseDate(d.date),\r\n      y: d.value\r\n    }));\r\n  }\r\n\r\n  // processData properly formats the given data, and performs special\r\n  // operations based on parameter values.\r\n  processData(data) {\r\n    console.log(data);\r\n    let retData = this.getCumulativeData(data);\r\n\r\n    return retData;\r\n  }\r\n\r\n  /**\r\n   * getDataMax returns the maximum value present in the data supplied to the\r\n   * graph.\r\n   */\r\n  getDataMax() {\r\n    const { data } = this.props;\r\n\r\n    let max = 0;\r\n\r\n    Object.keys(data).forEach(area => {\r\n      const { observed } = data[area];\r\n      max = Math.max(max, Math.max(...observed.map(({ value }) => value)));\r\n    });\r\n\r\n    return max;\r\n  }\r\n\r\n  /**\r\n   * getYAxisProps returns the corresponding Nivo line props for supporting\r\n   * different Y axis types (linear and log).\r\n   */\r\n  getYAxisProps() {\r\n    const linearAxisLeft = {\r\n      // Format large y numbers as their abbreviations.\r\n      format: y => numeral(y).format(\"0.[0]a\"),\r\n      orient: \"left\",\r\n      tickSize: 5,\r\n      tickPadding: 5,\r\n      tickRotation: 0,\r\n      legend: \"Dynamic Reproduction Number\",\r\n      legendOffset: -60,\r\n      legendPosition: \"middle\"\r\n    };\r\n\r\n    let logTickValues = [];\r\n    for (let i = 0; i <= Math.ceil(Math.log10(this.getDataMax())); i++) {\r\n      logTickValues.push(Math.pow(10, i));\r\n    }\r\n\r\n    // The 'axisLeft' prop for log scale is the same as for linear axis, except\r\n    // that the tick values must be supplied.\r\n    const logAxisLeft = {\r\n      ...linearAxisLeft,\r\n      tickValues: logTickValues\r\n    };\r\n\r\n    return {\r\n      axisLeft: linearAxisLeft,\r\n      yScale: {\r\n        type: \"linear\",\r\n        min: \"auto\",\r\n        max: \"auto\"\r\n      }\r\n    };\r\n  }\r\n\r\n  render() {\r\n    let { data } = this.props;\r\n    // chartData contains the data that we will pass into Nivo line chart.\r\n    let chartData = [];\r\n    // colors holds hex values for each line in the chart.\r\n    let colors = [];\r\n    // Sort the data by area name (so we have a consistent coloring) and then\r\n    // loop over each area.\r\n    Object.keys(data)\r\n      .sort()\r\n      .forEach((area, idx) => {\r\n        const lineColor = getLineColor(idx);\r\n        const observedData = data[area].observed;\r\n        const upperBound = observedData.map(data=>{\r\n           return {\r\n             date: data.date,\r\n             value: data.value + data.conf\r\n           }\r\n        });\r\n        const lowerBound = observedData.map(data=>{\r\n          return {\r\n            date: data.date,\r\n            value: data.value - data.conf\r\n          }\r\n       });\r\n        // Add the mean\r\n        chartData.push({\r\n          id: area,\r\n          data: this.processData(observedData),\r\n          // 'predicted' is a custom prop that we add so later we can tell the\r\n          // difference between observed/predicted data when drawing the lines.\r\n          predicted: false\r\n        });\r\n\r\n        colors.push(lineColor[3]);\r\n\r\n        //add the upperbound\r\n        chartData.push({\r\n          id: `${area} upper bound`,\r\n          data: this.processData(upperBound),\r\n          // 'predicted' is a custom prop that we add so later we can tell the\r\n          // difference between observed/predicted data when drawing the lines.\r\n          predicted: false\r\n        });\r\n        colors.push(lineColor[3]);\r\n\r\n        //add the lowerbound\r\n        chartData.push({\r\n          id: `${area} lower bound`,\r\n          data: this.processData(lowerBound),\r\n          // 'predicted' is a custom prop that we add so later we can tell the\r\n          // difference between observed/predicted data when drawing the lines.\r\n          predicted: false\r\n        });\r\n        colors.push(lineColor[3]);\r\n      });\r\n\r\n    // Determine whether we need to show weeks or months on the X axis.\r\n    let tickValues = \"every week\";\r\n\r\n    if (chartData.length > 0) {\r\n      // Calculate the minimum and maximum dates present in the data.\r\n      let minDate = chartData[0].data[0].x;\r\n      let maxDate = chartData[0].data[0].x;\r\n\r\n      chartData.forEach(({ data }) => {\r\n        data.forEach(({ x }) => {\r\n          minDate = Math.min(minDate, x);\r\n          maxDate = Math.max(maxDate, x);\r\n        });\r\n      });\r\n\r\n      minDate = moment(minDate);\r\n      maxDate = moment(maxDate);\r\n\r\n      // Switch to 'every month' if the date range is over a certain threshold.\r\n      const diffInDays = maxDate.diff(minDate, \"days\");\r\n      if (diffInDays > 150) {\r\n        tickValues = \"every month\";\r\n      }\r\n    }\r\n\r\n    return (\r\n      <ResponsiveLine\r\n        data={chartData}\r\n        colors={colors}\r\n        //50,50,50,80\r\n        margin={{ top: 10, right: 50, bottom: 70, left: 100 }}\r\n        xScale={{\r\n          type: \"time\",\r\n          format: \"native\",\r\n          precision: \"day\"\r\n        }}\r\n        axisBottom={{\r\n          // tickValues determines how often / with what values our 'format'\r\n          // func is called.\r\n          tickValues: tickValues,\r\n          // A custom 'format' func is required since all the x values are\r\n          // javascript Date objects.\r\n          format: date => {\r\n            return moment(date).format(\"M/D\");\r\n          },\r\n          orient: \"bottom\",\r\n          tickSize: 5,\r\n          tickPadding: 5,\r\n          tickRotation: 0,\r\n          legend: \"Date\",\r\n          legendOffset: 36,\r\n          legendPosition: \"middle\"\r\n        }}\r\n        // Set up the Y axis.\r\n        {...this.getYAxisProps()}\r\n        enableSlices=\"x\"\r\n        sliceTooltip={({ slice }) => {\r\n          return (\r\n            <div\r\n              style={{\r\n                background: \"white\",\r\n                padding: \"9px 12px\",\r\n                border: \"1px solid #ccc\"\r\n              }}\r\n            >\r\n              <div>\r\n                {// Grab the date from the first point, this will be the title of\r\n                // the tooltip.\r\n                moment(slice.points[0].data.x).format(\"MMM Do YYYY\")}\r\n              </div>\r\n              {slice.points.map(point => (\r\n                <div\r\n                  key={point.id}\r\n                  style={{\r\n                    color: point.serieColor,\r\n                    padding: \"3px 0\"\r\n                  }}\r\n                >\r\n                  <strong>{point.serieId}</strong>[\r\n                  {numeral(point.data.yFormatted).format(\"0.[0]a\")}]\r\n                </div>\r\n              ))}\r\n            </div>\r\n          );\r\n        }}\r\n        legends={[\r\n          {\r\n            anchor: \"top-left\",\r\n            direction: \"column\",\r\n            justify: false,\r\n            translateX: 0,\r\n            translateY: 0,\r\n            itemsSpacing: 0,\r\n            itemDirection: \"left-to-right\",\r\n            itemWidth: 80,\r\n            itemHeight: 20,\r\n            itemOpacity: 0.75,\r\n            symbolSize: 12,\r\n            symbolShape: \"circle\",\r\n            symbolBorderColor: \"rgba(0, 0, 0, .5)\",\r\n            effects: [\r\n              {\r\n                on: \"hover\",\r\n                style: {\r\n                  itemBackground: \"rgba(0, 0, 0, .03)\",\r\n                  itemOpacity: 1\r\n                }\r\n              }\r\n            ]\r\n          }\r\n        ]}\r\n        layers={[\r\n          \"grid\",\r\n          \"markers\",\r\n          \"areas\",\r\n          \"crosshair\",\r\n          DashedLine,\r\n          \"slices\",\r\n          \"points\",\r\n          \"axes\",\r\n          \"legends\"\r\n        ]}\r\n        theme={theme}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default ScoreGraph;\r\n","import React, { Component } from \"react\";\r\nimport {\r\n    red,\r\n    gold,\r\n    lime,\r\n    cyan,\r\n    geekblue,\r\n    purple,\r\n    magenta\r\n  } from \"@ant-design/colors\";\r\n\r\nimport { \r\n    LineChart, \r\n    Line,\r\n    CartesianGrid,\r\n    XAxis,\r\n    YAxis,\r\n    Tooltip,\r\n    Legend,\r\n    Label,\r\n    ErrorBar,\r\n    ReferenceLine\r\n} from 'recharts';\r\n\r\nfunction getLineColor(index) {\r\n    const colors = [\r\n        red,\r\n        gold,\r\n        lime,\r\n        cyan,\r\n        geekblue,\r\n        purple,\r\n        magenta\r\n    ];\r\n\r\n    return colors[index % colors.length];\r\n}\r\n\r\n\r\n\r\nclass NewScoreGraph extends Component {\r\n    parseData = (data, scoreType) => { \r\n        const firstArea = Object.keys(data)[0];\r\n        if (data[firstArea])\r\n        {\r\n            if (scoreType === \"reproduction\")\r\n            {\r\n                const chartData = data[firstArea].observed_rt.map((value,idx) => {\r\n                    let date = value.date.split(\"-\")[1] + \"/\" + value.date.split(\"-\")[2]\r\n                    let dataSet = {name: date};\r\n                    dataSet[Object.keys(data)[0]] = value.value;\r\n                    dataSet[`error${Object.keys(data)[0]}`] = value.conf;\r\n                    for (let i = 1; i < Object.keys(data).length; ++i)\r\n                    {\r\n                        dataSet[Object.keys(data)[i]] = data[Object.keys(data)[i]].observed_rt[idx].value;\r\n                        dataSet[`error${Object.keys(data)[i]}`] = data[Object.keys(data)[i]].observed_rt[idx].conf;\r\n                    }\r\n                    return dataSet\r\n                });\r\n                return chartData;\r\n            }\r\n            else\r\n            {\r\n                const chartData = data[firstArea].observed_mrf.map((value,idx) => {\r\n                    let date = value.date.split(\"-\")[1] + \"/\" + value.date.split(\"-\")[2]\r\n                    let dataSet = {name: date};\r\n                    dataSet[Object.keys(data)[0]] = value.value;\r\n                    dataSet[`error${Object.keys(data)[0]}`] = value.conf;\r\n                    for (let i = 1; i < Object.keys(data).length; ++i)\r\n                    {\r\n                        dataSet[Object.keys(data)[i]] = data[Object.keys(data)[i]].observed_mrf[idx].value;\r\n                        dataSet[`error${Object.keys(data)[i]}`] = data[Object.keys(data)[i]].observed_mrf[idx].conf;\r\n                    }\r\n                    return dataSet\r\n                });\r\n                return chartData;\r\n            }\r\n        }\r\n    }\r\n    \r\n    render(){\r\n        let {data, date, scoreType} = this.props;\r\n        //map data\r\n        const chartData = this.parseData(data, scoreType);\r\n        //areas and line color\r\n        const areas = Object.keys(data);\r\n        let colors = [];\r\n        areas.map((area, idx)=>{\r\n            let strokeColor = getLineColor(idx);\r\n            colors.push(strokeColor);\r\n            return 0;\r\n        });\r\n        let lines = [];\r\n        for (let i = 0; i < areas.length; ++i)\r\n        {\r\n            lines.push(\r\n                <Line type=\"monotone\" key={i} dataKey={areas[i]} stroke={colors[i][3]} strokeWidth={5}>\r\n                    <ErrorBar dataKey={`error${areas[i]}`} width={15} strokeWidth={2} stroke={colors[i][6]} direction=\"y\" />\r\n                </Line>\r\n            )\r\n        }\r\n        return(\r\n            <LineChart width={1400} height={300} data={chartData}\r\n            margin={{ top: 40, right: 30, left: 40, bottom: 5 }}>\r\n            <CartesianGrid strokeDasharray=\"3 3\" />\r\n            <XAxis dataKey=\"name\" />\r\n            <YAxis>\r\n                {scoreType===\"reproduction\"?\r\n                <Label value=\"Dynamic Reproduction Number\" dy = {90} position=\"insideLeft\" angle={-90} fontSize={15} />\r\n                 :\r\n                <Label value=\"MFR Score\" dy = {45} position=\"insideLeft\" angle={-90} fontSize={15} />\r\n                }\r\n            </YAxis>\r\n            <Tooltip />\r\n            <ReferenceLine x={date} stroke=\"green\" strokeWidth={5} fontSize={20} \r\n                            label={{position: 'top', value: 'selected date', fill: 'green', fontSize: 15}} \r\n            strokeDasharray=\"10 10\"/>\r\n            {scoreType === \"reproduction\"? \r\n            <ReferenceLine y={1} stroke=\"SandyBrown\" strokeWidth={5} strokeDasharray=\"3 3\" \r\n                            label={{position: 'left', value: '', fill: 'red', fontSize: 20}} \r\n            />\r\n            :null}\r\n            <Legend iconSize={40}/>\r\n            {lines}\r\n            </LineChart>\r\n        );\r\n    }\r\n}\r\n\r\nexport default NewScoreGraph;\r\n\r\n  ","import React, { Component } from \"react\";\r\nimport { Circle, Map, Marker, Popup, TileLayer } from \"react-leaflet\";\r\nimport ModelAPI from \"../modelapi\";\r\nimport { areaToStr, strToArea } from \"../covid19util\";\r\n\r\nimport * as am4core from \"@amcharts/amcharts4/core\";\r\nimport * as am4maps from \"@amcharts/amcharts4/maps\";\r\nimport am4geodata_worldLow from \"@amcharts/amcharts4-geodata/worldLow\";\r\nimport am4geodata_usaLow from \"@amcharts/amcharts4-geodata/usaLow\";\r\nimport am4themes_animated from \"@amcharts/amcharts4/themes/animated\";\r\n\r\nconst HEAT_MAP_MIN_COLOR = \"#85DB50\";\r\nconst HEAT_MAP_MAX_COLOR = \"#F33A21\";\r\nconst MAP_HOVER_COLOR = \"#83FE00\";\r\n\r\nam4core.useTheme(am4themes_animated);\r\n\r\nclass ScoreMap extends Component {\r\n    constructor() {\r\n      super();\r\n      this.modelAPI = new ModelAPI();\r\n  \r\n      this.state = {\r\n        areasList : [],\r\n        showState: false,\r\n        worldSeries: {},\r\n        usaSeries: {}\r\n      }\r\n  \r\n      this.modelAPI.areas(allAreas =>\r\n        this.setState({\r\n          areasList: allAreas\r\n        })\r\n      );\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.props.triggerRef(this);\r\n    }\r\n\r\n    onShowState = (value) =>{\r\n        this.setState({\r\n          showState: value\r\n        });\r\n    }\r\n\r\n    fetchData()\r\n    {\r\n        var args = arguments;\r\n        const {scoreType} = this.props;\r\n        if (!args[0]) {\r\n          //without dynamic map,show to latestscore\r\n          if (scoreType === \"reproduction\")\r\n          {\r\n            this.modelAPI.scores_all(\r\n              {\r\n                  weeks: this.props.latestWeek,\r\n              } , scores => {\r\n                let heatmapData = scores.map(d => {\r\n                return {\r\n                  id: d.area.iso_2,\r\n                  value: d.value > 0 ? d.value: 0,\r\n                  area: d.area,\r\n                  conf: d.conf\r\n                };\r\n              });\r\n              this.setState({ heatmapData }, this.initChart);\r\n            });\r\n          }\r\n          else\r\n          {\r\n            this.modelAPI.all_mrf_scores(\r\n              {\r\n                  weeks: this.props.latestWeek,\r\n              } , scores => {\r\n                let heatmapData = scores.map(d => {\r\n                return {\r\n                  id: d.area.iso_2,\r\n                  value: d.value > 0 ? d.value: 0,\r\n                  area: d.area,\r\n                  conf: d.conf\r\n                };\r\n              });\r\n              this.setState({ heatmapData }, this.initChart);\r\n            });\r\n          }  \r\n        } else {\r\n          if (scoreType === \"reproduction\")\r\n          {\r\n            this.modelAPI.scores_all(\r\n              {\r\n                  weeks: this.props.weeks,\r\n              }, scores =>{\r\n              let heatmapData = scores.map(d => {\r\n                  return {\r\n                      id: d.area.iso_2,\r\n                      value: d.value > 0 ? d.value: 0,\r\n                      area: d.area\r\n                  };\r\n                  });\r\n                  if (args[1])\r\n                  {\r\n                    this.setState({ heatmapData }, this.initChart);\r\n                  }\r\n                  else\r\n                  {\r\n                    this.setState({ heatmapData }, this.updateChart);\r\n                  }              \r\n              });\r\n          }\r\n          else\r\n          {\r\n            this.modelAPI.all_mrf_scores(\r\n              {\r\n                  weeks: this.props.weeks,\r\n              }, scores =>{\r\n              let heatmapData = scores.map(d => {\r\n                  return {\r\n                      id: d.area.iso_2,\r\n                      value: d.value > 0 ? d.value: 0,\r\n                      area: d.area\r\n                  };\r\n                  });\r\n                  if (args[1])\r\n                  {\r\n                    this.setState({ heatmapData }, this.initChart);\r\n                  }\r\n                  else\r\n                  {\r\n                    this.setState({ heatmapData }, this.updateChart);\r\n                  }\r\n              });\r\n          }\r\n           \r\n        }\r\n    }\r\n\r\n    initChart() {\r\n        // Create map instance\r\n        this.chart = am4core.create(\"chartdiv\", am4maps.MapChart);\r\n        // Set projection\r\n        this.chart.projection = new am4maps.projections.Mercator();\r\n        let worldSeries = this.chart.series.push(new am4maps.MapPolygonSeries());\r\n        worldSeries = this.createChartSeries(worldSeries, {\r\n          geodata: am4geodata_worldLow,\r\n          exclude: [\"AQ\"],\r\n          data: this.state.heatmapData\r\n        });\r\n        let usaSeries = this.chart.series.push(new am4maps.MapPolygonSeries());\r\n        usaSeries = this.createChartSeries(usaSeries, {\r\n          geodata: am4geodata_usaLow,\r\n          data: this.state.heatmapData,\r\n          disabled: !this.state.showState\r\n        });\r\n        this.stateSeries = [usaSeries];\r\n        this.initChartInterface();\r\n        this.setState({\r\n          worldSeries,\r\n          usaSeries\r\n        });\r\n    }\r\n\r\n    updateChart(){\r\n      let worldSeries = this.state.worldSeries;\r\n      let usaSeries = this.state.usaSeries;\r\n      worldSeries.data = this.state.heatmapData;\r\n      usaSeries.data = this.state.heatmapData;\r\n    }\r\n\r\n    createChartSeries(series, seriesProps) {\r\n        const {scoreType} = this.props;\r\n        series = Object.assign(series, seriesProps);\r\n        let polygonTemplate = series.mapPolygons.template;\r\n        if (scoreType === \"reproduction\")\r\n        {\r\n          series.heatRules.push({\r\n            property: \"fill\",\r\n            target: polygonTemplate,\r\n            min: am4core.color(HEAT_MAP_MIN_COLOR),\r\n            max: am4core.color(HEAT_MAP_MAX_COLOR),\r\n            minValue: 0,\r\n            maxValue: 4\r\n          });\r\n        }\r\n        else\r\n        {\r\n          series.heatRules.push({\r\n            property: \"fill\",\r\n            target: polygonTemplate,\r\n            min: am4core.color(HEAT_MAP_MIN_COLOR),\r\n            max: am4core.color(HEAT_MAP_MAX_COLOR),\r\n            minValue: 0,\r\n            maxValue: 0.4\r\n          });\r\n        }  \r\n        // Configure series tooltip. Display the true value of infections.\r\n        polygonTemplate.tooltipText = \"{name}: {value}\";\r\n        polygonTemplate.nonScalingStroke = true;\r\n        polygonTemplate.strokeWidth = 0.5;\r\n    \r\n        // Create hover state and set alternative fill color.\r\n        let hs = polygonTemplate.states.create(\"hover\");\r\n        hs.properties.fill = am4core.color(MAP_HOVER_COLOR);\r\n    \r\n        // Change mouse cursor to pointer.\r\n        polygonTemplate.cursorOverStyle = am4core.MouseCursorStyle.pointer;\r\n    \r\n        // Create click handler. Apparently ALL the series in the chart must have\r\n        // click handlers activated, so if this function is not running double-check\r\n        // that other series also have click handlers.\r\n        const { onMapClick, onNoData} = this.props;\r\n        polygonTemplate.events.on(\"hit\", e => {\r\n          const { id, value, area, name} = e.target.dataItem.dataContext;\r\n          if (area){\r\n            onMapClick(area);\r\n          }\r\n          else\r\n          {\r\n            onNoData(name);\r\n          }\r\n        });\r\n        return series;\r\n    }\r\n\r\n    initChartInterface() {\r\n        // Create a zoom control.\r\n        const {showState} = this.state;\r\n        this.chart.zoomControl = new am4maps.ZoomControl();\r\n        this.chart.zoomControl.cursorOverStyle = am4core.MouseCursorStyle.pointer;\r\n    \r\n        // Create a toggle button to show/hide states/provinces.\r\n        let button = this.chart.chartContainer.createChild(am4core.Button);\r\n        //button.label.text = \"Show States/Provinces\";\r\n        button.label.text = `${\r\n          showState ? \"Hide\" : \"Show\"\r\n          } States/Provinces`;\r\n        button.togglable = true;\r\n        button.padding(5, 5, 5, 5);\r\n        button.align = \"right\";\r\n        button.marginRight = 15;\r\n        button.cursorOverStyle = am4core.MouseCursorStyle.pointer;\r\n        button.events.on(\"hit\", () => {\r\n          this.onShowState(button.isActive);\r\n          const {showState} = this.state;\r\n          this.stateSeries.forEach(s => (s.disabled = !showState));\r\n          button.label.text = `${\r\n            showState ? \"Hide\" : \"Show\"\r\n            } States/Provinces`;\r\n        });\r\n      }\r\n\r\n      componentWillUnmount() {\r\n        if (this.chart) {\r\n          this.chart.dispose();\r\n        }\r\n      }\r\n\r\n    render() {\r\n        return <div id=\"chartdiv\"></div>;\r\n    }\r\n}\r\n\r\nexport default ScoreMap;","import React, { PureComponent } from \"react\";\r\nimport ModelAPI from \"../modelapi\";\r\nimport { areaToStr, strToArea} from \"../covid19util\";\r\nimport ScoreGraph from \"./scoreGraph\";\r\nimport NewScoreGraph from \"./newScoreGraph\";\r\nimport ScoreMap from './scoreMap';\r\nimport \"./scorePage.css\";\r\n\r\nimport {\r\n    Form,\r\n    Select,\r\n    Slider,\r\n    Switch,\r\n    Alert,\r\n    Row,\r\n    Col,\r\n    Radio\r\n  } from \"antd\";\r\n\r\nconst { Option } = Select;\r\n\r\nclass ScorePage extends PureComponent{\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {\r\n            areas: this.props.areas || [],\r\n            areasList: [],\r\n            latestDate: \"\",\r\n            firstDate: \"\",\r\n            mainGraphData: {},\r\n            weeks: this.props.weeks || 0, // will later be set to be the weeks to the latest date as initial value\r\n            latestWeek: 0, //will change later and remain unchange until database updated\r\n            dynamicMapOn: false,\r\n            noDataError: false,\r\n            errorDescription: \"\",\r\n            scoreType: \"reproduction\"\r\n        }  \r\n        \r\n        this.addAreaByStr = this.addAreaByStr.bind(this);\r\n        this.removeAreaByStr = this.removeAreaByStr.bind(this);\r\n        this.onValuesChange = this.onValuesChange.bind(this);\r\n        this.onMapClick = this.onMapClick.bind(this);\r\n        this.onWeeksChange = this.onWeeksChange.bind(this);\r\n        this.switchDynamicMap = this.switchDynamicMap.bind(this);\r\n        this.onAlertClose = this.onAlertClose.bind(this);\r\n        this.onNoData = this.onNoData.bind(this);\r\n        this.generateMarks = this.generateMarks.bind(this);\r\n        this.handleScoreTypeSelect = this.handleScoreTypeSelect.bind(this);\r\n    }\r\n\r\n    componentDidMount = ()=>{\r\n        this.formRef = React.createRef();\r\n    \r\n        this.modelAPI = new ModelAPI();\r\n\r\n        this.modelAPI.latest_score_date(latestDate => \r\n            this.setState({\r\n                latestDate: latestDate[0].date,\r\n                weeks: latestDate[0].weeks,\r\n                latestWeek: latestDate[0].weeks,\r\n                firstDate: latestDate[0].firstDate\r\n            }, ()=>{\r\n                this.addAreaByStr('US');\r\n                this.formRef.current.setFieldsValue({\r\n                    weeks: this.state.latestWeek,\r\n                });\r\n                this.map.fetchData(this.state.dynamicMapOn);\r\n            })\r\n        );\r\n    \r\n        this.modelAPI.areas(allAreas =>\r\n          this.setState({\r\n            areasList: allAreas\r\n          })\r\n        );\r\n    }\r\n\r\n    onMapClick(area) {\r\n        if (!this.areaIsSelected(area)) {\r\n            this.addAreaByStr(areaToStr(area));\r\n        }\r\n    }\r\n\r\n    areaIsSelected(area) {\r\n        if (this.state.areas && area) {\r\n          const newAreaStr = areaToStr(area);\r\n          return this.state.areas.includes(newAreaStr);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    addAreaByStr(areaStr) {\r\n        const areaObj = strToArea(areaStr);\r\n    \r\n        this.setState(\r\n          prevState => ({\r\n            areas: [...prevState.areas, areaStr]\r\n          }),\r\n          () => {\r\n            this.modelAPI.scores(\r\n            {\r\n                state: areaObj.state,\r\n                country: areaObj.country,\r\n                weeks: this.state.latestWeek,\r\n            },\r\n            data => {\r\n                this.setState(prevState => ({\r\n                mainGraphData: {\r\n                    ...prevState.mainGraphData,\r\n                    [areaStr]: data\r\n                }\r\n                }));\r\n            }\r\n            );\r\n\r\n            this.formRef.current.setFieldsValue({\r\n              areas: this.state.areas\r\n            });\r\n          }\r\n        );\r\n    }\r\n    \r\n    removeAreaByStr(targetAreaStr) {\r\n        this.setState(prevState => {\r\n          return {\r\n            // Filter out the area / graph data corresponding to the target area\r\n            // string.\r\n            areas: prevState.areas.filter(areaStr => areaStr !== targetAreaStr),\r\n            mainGraphData: Object.keys(prevState.mainGraphData)\r\n              .filter(areaStr => areaStr !== targetAreaStr)\r\n              .reduce((newMainGraphData, areaStr) => {\r\n                return {\r\n                  ...newMainGraphData,\r\n                  [areaStr]: prevState.mainGraphData[areaStr]\r\n                };\r\n              }, {})\r\n          };\r\n        });\r\n    }\r\n    \r\n    onValuesChange(changedValues, allValues) {\r\n        // If we're here it means the user either added or deleted an area, so we\r\n        // can do a union / intersection to figure out what to add/remove.\r\n        const prevAreas = this.state.areas;\r\n        const newAreas = allValues.areas;\r\n        if (newAreas && prevAreas)\r\n        {\r\n            const areasToAdd = newAreas.filter(\r\n                areaStr => !prevAreas.includes(areaStr)\r\n                );\r\n                const areasToRemove = prevAreas.filter(\r\n                areaStr => !newAreas.includes(areaStr)\r\n                );\r\n        \r\n                areasToAdd.forEach(this.addAreaByStr);\r\n                areasToRemove.forEach(this.removeAreaByStr);\r\n        }\r\n        \r\n    }\r\n\r\n    onWeeksChange(weeks) {\r\n        this.setState({ weeks }, ()=>{\r\n            if (this.state.dynamicMapOn) {\r\n                this.map.fetchData(this.state.dynamicMapOn);\r\n            }    \r\n        });\r\n    }\r\n\r\n    bindRef = ref => { \r\n        this.map = ref \r\n    }\r\n\r\n\r\n    switchDynamicMap(checked) {\r\n        this.setState({\r\n          dynamicMapOn: checked\r\n        });\r\n        this.map.fetchData(checked);\r\n    }\r\n\r\n    //when closing the alert\r\n    onAlertClose = ()=>{\r\n        this.setState({\r\n        noDataError: false\r\n        });\r\n    }\r\n\r\n    //when encounter an no data error\r\n    onNoData = (name) =>{\r\n        this.setState({\r\n        noDataError: true,\r\n        errorDescription: `There is currently no data for ${name}`\r\n        })\r\n    }\r\n\r\n    generateMarks = ()=>{\r\n        const {weeks, lastDate, latestWeek, firstDate} = this.state;\r\n        let currentDate = new Date(`${firstDate}T00:00`);\r\n        currentDate.setDate(currentDate.getDate(Date) + 7*weeks);\r\n        //get the date of the selected date on slider\r\n        let marks = {};\r\n        let i = 0;\r\n        while ( i <= 5 && weeks + i<=latestWeek)\r\n        {\r\n           marks[weeks+i] = `${currentDate.getMonth()+1}/${currentDate.getDate()}`;\r\n           currentDate.setDate(currentDate.getDate(Date) + 7);\r\n           i++;\r\n        }\r\n        i = 1\r\n        currentDate = new Date(`${firstDate}T00:00`);\r\n        currentDate.setDate(currentDate.getDate(Date) + 7*(weeks-1));\r\n        while (i <= 5 && weeks - i >= 0)\r\n        {\r\n            marks[weeks - i] = `${currentDate.getMonth()+1}/${currentDate.getDate()}`;\r\n            currentDate.setDate(currentDate.getDate(Date) - 7);\r\n            i++;\r\n        }\r\n        currentDate = new Date(`${firstDate}T00:00`);\r\n        currentDate.setDate(currentDate.getDate(Date) + 7*weeks);\r\n        return [currentDate, marks];\r\n      }\r\n\r\n    \r\n    handleScoreTypeSelect = e =>{\r\n        this.setState({\r\n            scoreType: e.target.value\r\n        }, ()=>{\r\n            const resetMap = true;\r\n            this.map.fetchData(this.state.dynamicMapOn, resetMap);\r\n        });\r\n    }\r\n\r\n    render(){\r\n        const {\r\n            areas,\r\n            areasList,\r\n            weeks,\r\n            mainGraphData,\r\n            dynamicMapOn,\r\n            latestWeek,\r\n            noDataError,\r\n            errorDescription,\r\n            scoreType\r\n          } = this.state;\r\n        const countryOptions = areasList\r\n        .filter(area => !this.areaIsSelected(area))\r\n        .map(areaToStr)\r\n        .sort()\r\n        .map(s => {\r\n        return <Option key={s}> {s} </Option>;\r\n        });\r\n\r\n        const [currentDate, marks] = this.generateMarks();\r\n        const month = (currentDate.getMonth() + 1)<10?(`0${currentDate.getMonth() + 1}`):(currentDate.getMonth() + 1);\r\n        const date = (currentDate.getDate()<10)?(`0${currentDate.getDate()}`):currentDate.getDate();\r\n        const formatted_current_date = `${month}/${date}`;\r\n        return(\r\n            <div className=\"score-page\">\r\n                <Row type=\"flex\" justify=\"space-around\">\r\n                <Col span={10}>\r\n                    {noDataError?\r\n                        <Alert\r\n                        message= {`${errorDescription}`}\r\n                        description= \"Please wait for our updates.\"\r\n                        type=\"error\"\r\n                        closable\r\n                        onClose={this.onAlertClose}\r\n                        />: null\r\n                    }\r\n                    <div className=\"form-wrapper\">\r\n                        <Form\r\n                            ref={this.formRef}\r\n                            onValuesChange={this.onValuesChange}\r\n                        >\r\n                            <Form.Item\r\n                                label=\"Areas\"\r\n                                name=\"areas\"\r\n                                rules={[{ required: true, message: \"Please select areas!\" }]}\r\n                            >\r\n                                <Select\r\n                                mode=\"multiple\"\r\n                                style={{ width: \"100%\" }}\r\n                                placeholder=\"Select Areas\"\r\n                                >\r\n                                {countryOptions}\r\n                                </Select>\r\n                            </Form.Item>\r\n\r\n                            <Form.Item\r\n                                label=\"Week to check\"\r\n                                name=\"weeks\"\r\n                                rules={[\r\n                                { required: true, message: \"Please select the week you want to see\" }\r\n                                ]}\r\n                            >\r\n                                <Slider\r\n                                    marks={marks}\r\n                                    initialValue={weeks}\r\n                                    min ={weeks-5>=0?weeks-5: 0}\r\n                                    max={weeks+5<=latestWeek?weeks+5:latestWeek}\r\n                                    onAfterChange={this.onWeeksChange}\r\n                                />\r\n                            </Form.Item>\r\n                        </Form>\r\n                        <div className=\"radio-group\">Data Type:&nbsp;&nbsp;  \r\n                            <Radio.Group\r\n                                value={scoreType}\r\n                                onChange={this.handleScoreTypeSelect}\r\n                            >\r\n                                <Radio value=\"reproduction\">Dynamic Reproduction Number</Radio>\r\n                                <Radio value=\"mfr\">Model-based Fatality Rate</Radio>\r\n                            </Radio.Group>\r\n                        </div>\r\n                        <p>\r\n                        Dynamic Map:&nbsp;&nbsp;  \r\n                        <Switch \r\n                            onChange={this.switchDynamicMap} \r\n                        />\r\n                        </p>\r\n                    </div>\r\n                </Col>\r\n                <Col span={14}>\r\n                <div className=\"map-wrapper\">\r\n                    <ScoreMap className=\"score-map\"\r\n                    triggerRef={this.bindRef}\r\n                    dynamicMapOn={dynamicMapOn}\r\n                    weeks={weeks}\r\n                    latestWeek={latestWeek}\r\n                    onMapClick={this.onMapClick} \r\n                    onNoData = {this.onNoData}\r\n                    scoreType = {scoreType}\r\n                    />\r\n                </div>\r\n                </Col>\r\n                </Row>\r\n                {areas.length?\r\n                <Row>\r\n                <Col span={24}>\r\n                    <div className=\"graph-wrapper\">\r\n                    <NewScoreGraph\r\n                        data={mainGraphData}\r\n                        date={formatted_current_date}\r\n                        scoreType={scoreType}\r\n                    ></NewScoreGraph>\r\n                    </div>\r\n                </Col>\r\n                </Row>\r\n                : null}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default ScorePage;","import React, { Component } from \"react\";\r\n\r\nimport {\r\n    Menu,\r\n    Row,\r\n    Col\r\n} from 'antd';\r\nimport styles from \"./navbar.css\";\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport { Navbar, Nav, NavDropdown } from 'react-bootstrap'\r\n\r\n\r\n// class NavBar extends Component {\r\nconst NavBar = () => {\r\n    return (\r\n        <Navbar collapseOnSelect expand=\"lg\" className=\"navbar-header navbar-light\">\r\n          <Navbar.Brand href=\"#/\"><img\r\n                    className=\"logo\"\r\n                    src=\"https://identity.usc.edu/files/2011/12/combo_gold_white_cardinal.png\"\r\n                    alt=\"USC\"\r\n                /></Navbar.Brand>\r\n          <Navbar.Toggle aria-controls=\"responsive-navbar-nav\"/>\r\n          <Navbar.Collapse id=\"responsive-navbar-nav\">\r\n            <Nav className=\"mr-auto\">\r\n              <Nav.Link className=\"navbar-link\" href=\"#/\">COVID-19 Forecast</Nav.Link>\r\n              <Nav.Link className=\"navbar-link\" href=\"#score\">Reproduction Number</Nav.Link>\r\n              <Nav.Link className=\"navbar-link\" href=\"#highlights\">Highlights</Nav.Link>\r\n              <Nav.Link className=\"navbar-link\" href=\"#leaderboard\">Evaluation</Nav.Link>\r\n              <Nav.Link className=\"navbar-link\" href=\"#about\">About Us</Nav.Link>\r\n            </Nav>\r\n            <Nav>\r\n            </Nav>\r\n          </Navbar.Collapse>\r\n        </Navbar>\r\n    )\r\n}\r\nexport default NavBar;","import React, { Component } from \"react\";\r\nimport { List, Avatar, Row, Col } from 'antd';\r\nimport Iframe from 'react-iframe';\r\nimport \"../covid19app.css\";\r\nimport \"./leaderboard.css\";\r\nimport { Button } from \"antd\";\r\n\r\n\r\nconst GFH = \"https://htmlpreview.github.io/?https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/frontend/src/leaderboard/GFH_compare.html\";\r\nconst USFH = \"https://htmlpreview.github.io/?https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/frontend/src/leaderboard/USFH_compare.html\";\r\nconst blank_html_page = \"<html></html>\";\r\n\r\nclass Leaderboard extends Component {\r\n\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.state = {\r\n\t\t\twhich_hub: USFH,\r\n\t\t\twidth: 0, \r\n\t\t\theight: 0,\r\n\t\t\t};\r\n  \t\t\tthis.updateWindowDimensions = this.updateWindowDimensions.bind(this);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n  \t\tthis.updateWindowDimensions();\r\n  \t\twindow.addEventListener('resize', this.updateWindowDimensions);\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n  \t\twindow.removeEventListener('resize', this.updateWindowDimensions);\r\n\t}\r\n\r\n\tupdateWindowDimensions() {\r\n  \t\tthis.setState({ width: window.innerWidth, height: window.innerHeight });\r\n\t}\r\n\r\n    getAvatar(number) {\r\n        let icon_src = \"\";\r\n        switch (number) {\r\n            case 1:\r\n                icon_src = \"https://img.icons8.com/officel/80/000000/medal2.png\";\r\n                break;\r\n            case 2:\r\n                icon_src = \"https://img.icons8.com/officel/80/000000/medal-second-place.png\";\r\n                break;\r\n            case 3:\r\n                icon_src = \"https://img.icons8.com/officel/80/000000/medal2-third-place.png\";\r\n                break;\r\n            default:\r\n                icon_src = \"https://img.icons8.com/carbon-copy/100/000000/\" + number + \"-circle.png\";\r\n                break;\r\n        }\r\n\r\n        return <Avatar className=\"rank-number\" src={icon_src} alt=\"\" />;\r\n\r\n    };\r\n\r\n\r\n    render() {\r\n\r\n        return (\r\n            <div className=\"page-wrapper\">\r\n                <div className=\"grid\">\r\n                    <Row>\r\n\t                     <div className = \"introduction\"><p>\r\n\t                     We evaluate the submissions that are made publicly on various forecasting hubs and highlight where our submissions stand.\r\n\t                     Note that the following only compares the submissions and not the forecasting methodologies.\r\n\t                     The submissions may have used different methodologies over time and tuned manually. The evaluation \r\n\t                     of different methodologies is a part of our other upcoming project <a href=\"https://github.com/scc-usc/covid19-forecast-bench\">here</a>.\r\n\t                     </p>\r\n\t                     <p>\r\n\t                     We are currently contributing to the following hubs. Please select one to see the evaluations.\r\n\t                     {\"\\n\"}\r\n\t                     </p>\r\n\t                     </div>\r\n\t                     \r\n\t                     <div>\r\n                  \t\t<Button onClick={()=>this.setState({which_hub : USFH})}>\r\n\t\t\t\t\t\tUS Forecast Hub                  \r\n                  \t\t</Button>\r\n                  \t\t<Button onClick={()=>this.setState({which_hub : GFH})}>\r\n\t\t\t\t\t\tGermany/Poland Forecast Hub                  \r\n                  \t\t</Button>\r\n                \t\t</div>\r\n                    </Row> \r\n                    <Row>\r\n                    \t<Iframe url={this.state.which_hub}\r\n                    \twidth=\"100%\"\r\n        \t\t\t\theight={(0.7*this.state.height).toString()}\r\n        \t\t\t\t/>\r\n                    </Row>\r\n\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Leaderboard;","import React, { Component } from \"react\";\r\nimport { List, Avatar, Row, Col } from 'antd';\r\nimport Iframe from 'react-iframe';\r\nimport \"../covid19app.css\";\r\nimport \"./highlights.css\";\r\nimport { Button } from \"antd\";\r\n\r\n\r\nconst url_page = \"https://htmlpreview.github.io/?https://raw.githubusercontent.com/scc-usc/ReCOVER-COVID-19/master/frontend/src/highlights/highlights.html\";\r\n\r\nclass Highlights extends Component {\r\n\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.state = {\r\n\t\t\twidth: 0, \r\n\t\t\theight: 0,\r\n\t\t\t};\r\n  \t\t\tthis.updateWindowDimensions = this.updateWindowDimensions.bind(this);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n  \t\tthis.updateWindowDimensions();\r\n  \t\twindow.addEventListener('resize', this.updateWindowDimensions);\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n  \t\twindow.removeEventListener('resize', this.updateWindowDimensions);\r\n\t}\r\n\r\n\tupdateWindowDimensions() {\r\n  \t\tthis.setState({ width: window.innerWidth, height: window.innerHeight });\r\n\t}\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"page-wrapper\">\r\n            <div className=\"grid\">\r\n                    <Row>\r\n                    \t<Iframe url={url_page}\r\n                    \twidth=\"100%\"\r\n        \t\t\t\theight={(0.9*this.state.height).toString()}\r\n        \t\t\t\t/>\r\n                </Row>\r\n            </div></div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Highlights;","import React, { Component } from \"react\";\r\nimport Covid19Predict from \"./covid19predict\";\r\nimport AboutUS from \"./aboutus\";\r\nimport ScorePage from './scorePage/scorePage';\r\nimport {HashRouter, Route, Redirect, Switch} from 'react-router-dom'; \r\nimport Navbar from \"./navbar/navbar\";\r\nimport 'semantic-ui-css/semantic.min.css';\r\nimport \"./covid19app.css\";\r\nimport Leaderboard from \"./leaderboard/leaderboard\";\r\nimport Highlights from \"./highlights/highlights\";\r\n\r\n//import pdf from \"./highlights.pdf\";\r\n\r\nclass Covid19App extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      redirectForecast: false,\r\n      redirectAbout: false,\r\n      redirectScore: false,\r\n      redirectLeaderboard: false,\r\n      redirectHighlights: false\r\n    }\r\n  }\r\n\r\n  redirectForecast = ()=>{\r\n    this.setState({\r\n      redirectForecast:true,\r\n      redirectAbout: false,\r\n      redirectScore: false,\r\n      redirectLeaderboard: false,\r\n      redirectHighlights: false\r\n    });\r\n  }\r\n\r\n  redirectAbout = ()=>{\r\n    this.setState({\r\n      redirectForecast: false,\r\n      redirectAbout:true,\r\n      redirectScore: false,\r\n      redirectLeaderboard: false,\r\n      redirectHighlights: false\r\n    });\r\n  }\r\n\r\n  redirectScore = ()=>{\r\n    this.setState({\r\n      redirectForecast: false,\r\n      redirectAbout:false,\r\n      redirectScore: true,\r\n      redirectHighlights: false,\r\n      redirectLeaderboard: false\r\n    });\r\n  }\r\n\r\n  redirectLeaderboard = ()=>{\r\n    this.setState({\r\n      redirectForecast: false,\r\n      redirectAbout: false,\r\n      redirectScore: false,\r\n      redirectLeaderboard: true,\r\n      redirectHighlights: false\r\n    });\r\n  }\r\n\r\n  redirectHighlights = ()=>{\r\n    this.setState({\r\n      redirectForecast: false,\r\n      redirectAbout: false,\r\n      redirectScore: false,\r\n      redirectLeaderboard: false,\r\n      redirectHighlights: true\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const {redirectForecast, redirectAbout, redirectScore, redirectLeaderboard, redirectHighlights} = this.state;\r\n    return (\r\n      <HashRouter basename=\"/\">\r\n        {redirectForecast?<Redirect to=\"/\"/>:null}\r\n        {redirectHighlights?<Redirect to=\"/highlights\"/>:null}\r\n        {redirectScore?<Redirect to=\"/score\"/>:null}\r\n        {redirectAbout?<Redirect to=\"/about\"/>:null}\r\n        {redirectLeaderboard?<Redirect to=\"/leaderboard\"/>:null}\r\n        <Navbar redirectForecast = {this.redirectForecast}\r\n        \t\tredirectHighlights = {this.redirectHighlights}\r\n                redirectScore = {this.redirectScore}\r\n                redirectAbout = {this.redirectAbout}\r\n                redirectLeaderboard = {this.redirectLeaderboard}\r\n        />\r\n        <Switch>\r\n          <Route exact path='/' \r\n            render={(props) => <Covid19Predict {...props} />}/>\r\n          <Route exact path='/score' \r\n            render={(props) => <ScorePage {...props}/>}\r\n          />\r\n          <Route exact path='/about'\r\n            render={(props) => <AboutUS {...props} />} />\r\n          <Route exact path='/leaderboard' \r\n            render={(props) => <Leaderboard {...props} />}/>\r\n          <Route exact path='/highlights'\r\n            render={(props) => <Highlights {...props} />}/>\r\n        </Switch>\r\n      </HashRouter>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Covid19App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport Covid19App from \"./covid19app\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\n\r\nReactDOM.render(<Covid19App />, document.getElementById(\"root\"));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}